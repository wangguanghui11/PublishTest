(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b00b89c2"],{"0ad7":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",[a("Row",{staticStyle:{"margin-top":"5px"}},[a("page-filter",{ref:"pageFilter",attrs:{loading:t.mainTableLoading},on:{"on-filter-apply":t.mainOnFilterApply}})],1),a("Row",{staticStyle:{"margin-top":"5px"}},[a("Card",{attrs:{shadow:""}},[a("table-data",{ref:"table",attrs:{data:t.mainTableData,"table-loading":t.mainTableLoading,"page-reset":t.mainPageReset,"page-data":t.mainPageData,"field-formaters":t.field_formaters,"known-fields":t.developer_relation,dimensions:t.mainKnownDimensions,metrics:t.mainKnownMetrics,"default-dimensions":t.mainKnownDimensions,"all-dimensions":t.mainAllDimensions,"all-metrics":t.mainAllMetrics,"have-index":!0,"have-dimension":!1,"have-total":!1},on:{"on-sort-change":t.mainHandleSortChange,"on-page-change":t.mainPageChange,"on-page-size-change":t.mainPageSizeChange,"on-page-reset-true":t.mainPageResetFalse,"on-click-cell":t.onClickCell}})],1)],1)],1),a("Modal",{staticClass:"relation-modal",attrs:{"footer-hide":!0,width:1040,"mask-closable":!1},model:{value:t.showRelationState,callback:function(e){t.showRelationState=e},expression:"showRelationState"}},[a("h3",[t._v(t._s(t.curDeveloper)+">>"+t._s(t.curAppStore)+">>网络关系")]),t.showRelationState?a("graph-chart",{attrs:{"graph-loading":t.graphLoading,"chart-data":t.chartData,"main-node-name":t.chartMainNodeName}}):t._e(),a("div",{staticStyle:{height:"40px"}},[a("span",{staticStyle:{float:"left"}},[t._v("1.鼠标滚轮可以控制图像的缩放，拖动可以改变位置；"),a("br"),t._v("2.点击节点可以复制开发者账号名称。")])])],1),a("Modal",{attrs:{"footer-hide":!0,width:1e3,"mask-closable":!1},model:{value:t.showAppCountState,callback:function(e){t.showAppCountState=e},expression:"showAppCountState"}},[a("h3",[t._v(t._s(t.curDeveloper)+">>"+t._s(t.curAppStore)+">>Apps")]),t.showAppCountState?a("app-count",{attrs:{"table-data":t.appCountData,"table-loading":t.appCountLoading}}):t._e()],1),a("Modal",{attrs:{"footer-hide":!0,width:880,"mask-closable":!1},model:{value:t.showAppLogState,callback:function(e){t.showAppLogState=e},expression:"showAppLogState"}},[a("h3",[t._v(t._s(t.curDeveloper)+">>"+t._s(t.curAppStore)+">>最近"+t._s(this.mainCurrFilterApply.period?this.mainCurrFilterApply.period:7)+"天Apps转移记录")]),t.showAppLogState?a("app-log",{attrs:{"table-data":t.appLogData,"table-loading":t.appLogLoading}}):t._e()],1),a("Modal",{attrs:{width:360,"mask-closable":!1},on:{"on-ok":t.handleEditNoteOk},model:{value:t.showEditState,callback:function(e){t.showEditState=e},expression:"showEditState"}},[a("h3",[t._v("编辑备注")]),a("div",[a("span",[t._v("输入内容:")]),a("Input",{staticStyle:{width:"260px","margin-left":"5px"},attrs:{type:"textarea",rows:4,placeholder:"输入内容"},model:{value:t.noteEdit,callback:function(e){t.noteEdit=e},expression:"noteEdit"}})],1)])],1)},r=[],i=(a("8e6e"),a("ac6a"),a("456d"),a("ade3")),o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Card",{ref:"filter",staticClass:"filter-selection"},[a("div",[a("a-select",{staticClass:"inline-width",staticStyle:{"font-size":"12px"},attrs:{mode:"multiple",allowClear:"",filterable:"",showArrow:"",autoClearSearchValue:!1,"max-tag-count":this.maxTagArr[0],"max-tag-text-length":this.maxTagTextArr[0],placeholder:"所属公司-全部",optionFilterProp:"children"},on:{focus:function(e){return t.focusFun(0)},blur:function(e){return t.blurFun()},mouseenter:function(e){return t.mouseenterFun(0)},mouseleave:function(e){return t.mouseleaveFun()}},scopedSlots:t._u([{key:"dropdownRender",fn:function(e){return a("div",{},[a("v-nodes",{attrs:{vnodes:e}}),a("a-divider",{staticClass:"select-all-divider"}),a("div",{staticClass:"select-all-div",on:{mousedown:function(t){return t.preventDefault()}}},[a("span",{staticClass:"select-all-span"},[t._v(t._s(t.companys.length)+"/"+t._s(t.allCompanys.length))]),a("Button",{attrs:{type:"primary"},on:{click:function(e){t.companys=t.allCompanys.map((function(t){return t.id}))}}},[t._v("全选")])],1)],1)}}]),model:{value:t.companys,callback:function(e){t.companys=e},expression:"companys"}},t._l(t.allCompanys,(function(e){return a("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.name))])})),1),a("a-select",{staticClass:"inline-width",staticStyle:{"font-size":"12px"},attrs:{mode:"multiple",allowClear:"",filterable:"",showArrow:"",autoClearSearchValue:!1,"max-tag-count":this.maxTagArr[1],"max-tag-text-length":this.maxTagTextArr[1],placeholder:"AppStore-全部",optionFilterProp:"children"},on:{focus:function(e){return t.focusFun(1)},blur:function(e){return t.blurFun()},mouseenter:function(e){return t.mouseenterFun(1)},mouseleave:function(e){return t.mouseleaveFun()}},scopedSlots:t._u([{key:"dropdownRender",fn:function(e){return a("div",{},[a("v-nodes",{attrs:{vnodes:e}}),a("a-divider",{staticClass:"select-all-divider"}),a("div",{staticClass:"select-all-div",on:{mousedown:function(t){return t.preventDefault()}}},[a("span",{staticClass:"select-all-span"},[t._v(t._s(t.appstores.length)+"/"+t._s(t.allAppstores.length))]),a("Button",{attrs:{type:"primary"},on:{click:function(e){t.appstores=t.allAppstores}}},[t._v("全选")])],1)],1)}}]),model:{value:t.appstores,callback:function(e){t.appstores=e},expression:"appstores"}},t._l(t.allAppstores,(function(e){return a("Option",{key:e,attrs:{value:e}},[t._v(t._s(e)+"\n      ")])})),1),a("a-select",{staticClass:"inline-width",staticStyle:{"font-size":"12px"},attrs:{mode:"multiple",allowClear:"",filterable:"",showArrow:"",autoClearSearchValue:!1,"max-tag-count":this.maxTagArr[2],"max-tag-text-length":this.maxTagTextArr[2],placeholder:"开发者账号-全部",optionFilterProp:"children"},on:{focus:function(e){return t.focusFun(2)},blur:function(e){return t.blurFun()},mouseenter:function(e){return t.mouseenterFun(2)},mouseleave:function(e){return t.mouseleaveFun()}},scopedSlots:t._u([{key:"dropdownRender",fn:function(e){return a("div",{},[a("v-nodes",{attrs:{vnodes:e}}),a("a-divider",{staticClass:"select-all-divider"}),a("div",{staticClass:"select-all-div",on:{mousedown:function(t){return t.preventDefault()}}},[a("span",{staticClass:"select-all-span"},[t._v(t._s(t.developers.length)+"/"+t._s(t.allDevelopers.length))]),a("Button",{attrs:{type:"primary"},on:{click:function(e){t.developers=t.allDevelopers.map((function(t){return t.name}))}}},[t._v("全选")])],1)],1)}}]),model:{value:t.developers,callback:function(e){t.developers=e},expression:"developers"}},t._l(t.allDevelopers,(function(e,n){return a("Option",{key:n,attrs:{value:e.name}},[t._v(t._s(e.name)+"\n      ")])})),1),a("a-select",{staticClass:"inline-width",staticStyle:{"font-size":"12px"},attrs:{mode:"multiple",allowClear:"",filterable:"",showArrow:"",autoClearSearchValue:!1,"max-tag-count":this.maxTagArr[3],"max-tag-text-length":this.maxTagTextArr[3],placeholder:"网络图-全部",optionFilterProp:"children"},on:{focus:function(e){return t.focusFun(3)},blur:function(e){return t.blurFun()},mouseenter:function(e){return t.mouseenterFun(3)},mouseleave:function(e){return t.mouseleaveFun()}},scopedSlots:t._u([{key:"dropdownRender",fn:function(e){return a("div",{},[a("v-nodes",{attrs:{vnodes:e}}),a("a-divider",{staticClass:"select-all-divider"}),a("div",{staticClass:"select-all-div",on:{mousedown:function(t){return t.preventDefault()}}},[a("span",{staticClass:"select-all-span"},[t._v(t._s(t.relations.length)+"/"+t._s(t.allRelationState.length))]),a("Button",{attrs:{type:"primary"},on:{click:function(e){t.relations=t.allRelationState.map((function(t){return t.id}))}}},[t._v("全选")])],1)],1)}}]),model:{value:t.relations,callback:function(e){t.relations=e},expression:"relations"}},t._l(t.allRelationState,(function(e){return a("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.name)+"\n      ")])})),1),a("a-select",{staticClass:"inline-width",staticStyle:{"font-size":"12px"},attrs:{mode:"multiple",allowClear:"",filterable:"",showArrow:"",autoClearSearchValue:!1,"max-tag-count":this.maxTagArr[4],"max-tag-text-length":this.maxTagTextArr[4],placeholder:"apps转移记录-全部",optionFilterProp:"children"},on:{focus:function(e){return t.focusFun(4)},blur:function(e){return t.blurFun()},mouseenter:function(e){return t.mouseenterFun(4)},mouseleave:function(e){return t.mouseleaveFun()}},scopedSlots:t._u([{key:"dropdownRender",fn:function(e){return a("div",{},[a("v-nodes",{attrs:{vnodes:e}}),a("a-divider",{staticClass:"select-all-divider"}),a("div",{staticClass:"select-all-div",on:{mousedown:function(t){return t.preventDefault()}}},[a("span",{staticClass:"select-all-span"},[t._v(t._s(t.appLogs.length)+"/"+t._s(t.allAppLogState.length))]),a("Button",{attrs:{type:"primary"},on:{click:function(e){t.appLogs=t.allAppLogState.map((function(t){return t.id}))}}},[t._v("全选")])],1)],1)}}]),model:{value:t.appLogs,callback:function(e){t.appLogs=e},expression:"appLogs"}},t._l(t.allAppLogState,(function(e){return a("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.name)+"\n      ")])})),1),a("span",{staticStyle:{"margin-left":"5px","margin-right":"5px"}},[t._v("查看：最近\n    "),a("a-select",{staticClass:"inline-width",staticStyle:{width:"50px","font-size":"12px"},attrs:{filterable:"",showArrow:"",autoClearSearchValue:!1,"max-tag-count":this.maxTagArr[3],"max-tag-text-length":this.maxTagTextArr[3],placeholder:"周期"},model:{value:t.period,callback:function(e){t.period=e},expression:"period"}},t._l(t.allPeriods,(function(e){return a("Option",{key:e,attrs:{value:e}},[t._v(t._s(e)+"\n      ")])})),1),t._v("\n    天转移记录")],1),a("Button",{staticStyle:{"margin-bottom":"3px"},attrs:{type:"primary",disabled:t.loading},on:{click:t.handleSubmit}},[t._v("Apply Filter")])],1),a("div",{staticClass:"optionsContents",attrs:{id:"optionsContent"}},t._l(t.tmpOptions,(function(e,n){return a("li",{key:n},[t._v(t._s(e))])})),0)])},s=[],l=(a("5df3"),a("7f7f"),a("20d6"),a("2f62")),u=a("9839"),c=a("4b65"),p=(a("1ef0"),a("1157")),d=a.n(p);function h(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function f(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?h(Object(a),!0).forEach((function(e){Object(i["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):h(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var m={name:"page-filter",components:{ASelect:u["d"],Option:u["d"].Option,VNodes:{functional:!0,render:function(t,e){return e.props.vnodes}}},data:function(){return{companys:[],appstores:[],developers:[],relations:[],appLogs:[],allCompanys:[],allAppstores:["google-play","ios"],allDevelopers:[],allRelationState:[{id:"1",name:"有"},{id:"0",name:"无"}],allAppLogState:[{id:"1",name:"有"},{id:"0",name:"无"}],period:7,allPeriods:[1,3,5,7],maxTagArr:[1,1,1,1,1],maxTagTextArr:[20,20,20,20,20],tmpAllOptions:[],tmpOptions:[],mark:0}},props:{loading:{type:Boolean,default:function(){return!1}}},methods:f(f({},Object(l["b"])(["getAllCompany","getAllDeveloper"])),{},{handleSubmit:function(t){var e={companys:this.companys,appstores:this.appstores,developers:this.developers,relations:this.relations,appLogs:this.appLogs,period:this.period};this.$emit("on-filter-apply",e)},maxTagCountfun:function(t){return this.maxTagCountObj&&this.maxTagCountObj[t]?this.maxTagCountObj[t]:1},focusFun:function(t){this.mark=1,d()("#optionsContent").length&&d()("#optionsContent").css({display:"none"}),this.maxTagArr=[1,1,1,1,1],this.maxTagTextArr=[20,20,20,20,20];var e=this;setTimeout((function(){e.maxTagArr.splice(t,0,10),e.maxTagTextArr.splice(t,0,100)}),500)},blurFun:function(){this.mark=0,this.maxTagArr.findIndex((function(t){return 10===t}))>=0&&(this.maxTagArr=[1,1,1,1,1],this.maxTagTextArr=[20,20,20,20,20]),this.setItemValues()},mouseenterFun:function(t){if(1!==this.mark){this.tmpOptions=this.tmpAllOptions[t];var e=Object(c["g"])(this.$refs["filter"].$el.clientWidth,t),a=document.getElementById("optionsContent");d()("#optionsContent").length&&this.tmpOptions&&this.tmpOptions.length>0&&a&&(d()("#optionsContent").css({display:"block",left:e.left+"px"}),a.style.setProperty("top",e.top+"px","important"))}},mouseleaveFun:function(){this.hideContentItem(),this.setItemValues()},setItemValues:function(){var t=this,e=[];this.companys&&this.companys.map((function(a,n){t.allCompanys&&t.allCompanys.map((function(t,n){a===t.id&&e.push(t.name)}))})),this.tmpAllOptions[0]=e,this.tmpAllOptions[1]=this.appstores,this.tmpAllOptions[2]=this.developers;var a=[];this.relations&&this.relations.map((function(e,n){t.allRelationState&&t.allRelationState.map((function(t,n){e===t.id&&a.push(t.name)}))})),this.tmpAllOptions[3]=a;var n=[];this.appLogs&&this.appLogs.map((function(e,a){t.allAppLogState&&t.allAppLogState.map((function(t,a){e===t.id&&n.push(t.name)}))})),this.tmpAllOptions[4]=n},getFilter:function(){return{companys:this.companys,appstores:this.appstores,developers:this.developers,relations:this.relations,appLogs:this.appLogs,period:this.period}},setFilter:function(t){this.companys=t.companys,this.appstores=t.appstores,this.developers=t.developers,this.relations=t.relations,this.appLogs=t.appLogs,this.period=t.period},hideContentItem:function(){var t=document.getElementById("optionsContent");t&&(t.style.display="none")}}),mounted:function(){var t=this;Promise.all([this.getAllCompany(),this.getAllDeveloper()]).then((function(e){t.allCompanys=e[0],t.allDevelopers=e[1]}))}},g=m,v=(a("e064"),a("2877")),b=Object(v["a"])(g,o,s,!1,null,"49678968",null),y=b.exports,w=a("f0e6"),_=a("bdcb"),x=a("4481"),O=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{ref:"dom",style:{width:"auto"}}),t.graphLoading?a("Spin",{attrs:{fix:"",size:"large"}}):t._e(),a("input",{staticStyle:{width:"10px",height:"1px",border:"0"},attrs:{id:"copy_select"}})],1)},C=[],S=a("313e"),D=a.n(S),A=a("90de"),k={name:"funnel-chart",props:{chartData:{type:Object,default:function(){return{data:[],links:[]}}},mainNodeName:{type:String,default:function(){return""}},graphLoading:{type:Boolean,default:function(){return!0}}},data:function(){return{dom:null}},methods:{resize:function(){this.dom.resize()},wrapOption:function(){var t=this;if(null==this.chartData.data)return{};var e=this.chartData.data.map((function(e){return e.name===t.mainNodeName?(e.category=0,e.symbolSize=100):(e.category=1,e.symbolSize=50),e})),a={tooltip:{position:function(t,e,a,n,r){return"edge"===e.dataType&&e.data.apps.length>30?[0,0]:null},formatter:function(t){var e=15;if("edge"===t.dataType&&t.data.apps.length>30&&(e=30),"edge"===t.dataType){var a='<h4 style="color:white">app:</h4>',n=0;a+='<div style="float:left">';for(var r=0;r<t.data.apps.length;++r)a+=t.data.apps[r],n++,n>=e?(a+='</div><div style="float:left;margin-left:10px">',n=0):a+="<br/>";return a+="</div>",a}t.dataType}},toolbox:{show:!0,feature:{mark:{show:!0},saveAsImage:{show:!0}}},series:[{force:{repulsion:[500,5e3],edgeLength:200,layoutAnimation:!1},type:"graph",layout:"force",animation:!1,roam:!0,zoom:.9,edgeSymbol:["circle","arrow"],emphasis:{lineStyle:{width:5}},lineStyle:{normal:{width:2,color:"source",curveness:.2}},label:{normal:{show:!0,color:"#000000",formatter:function(t){var e=t.data.name;return e}}},edgeLabel:{normal:{show:!0,formatter:function(t){var e=t.data.size;return e}}},data:e,links:this.chartData.links,categories:[{name:"主开发者",itemStyle:{color:"#1e96fc"}},{name:"从开发者",itemStyle:{color:"#ffc600"}}]}]};return a},renderChart:function(){var t=this;this.dom=D.a.init(this.$refs.dom);var e=this.wrapOption();this.$nextTick((function(){t.dom.setOption(e,!0),t.dom.resize({height:650,width:1e3}),Object(A["m"])(window,"resize",t.resize)}))}},watch:{chartData:{handler:function(t,e){this.renderChart()}}},mounted:function(){if(this.renderChart(),null!=this.dom){var t=this;this.dom.on("click",(function(e){if("node"===e.dataType){var a=document.getElementById("copy_select");a.setAttribute("value",e.name),a.select(),document.execCommand("copy"),t.$Message.success("名字已经复制到剪贴板")}}))}},beforeDestroy:function(){Object(A["l"])(window,"resize",this.resize)}},L=k,T=Object(v["a"])(L,O,C,!1,null,null,null),P=T.exports,j=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Row",{staticStyle:{"margin-top":"5px"}},[a("Card",{attrs:{shadow:""}},[a("local-table",{attrs:{data:t.tableData,"table-loading":t.tableLoading,"known-fields":t.developer_relation,noSummery:!0,noPage:!0,"have-index":!0,formater:t.field_formaters,metrics:t.currMetrics},on:{"on-click-cell":t.handleClickCell}})],1)],1)],1)},F=[],I=a("ae3e");function R(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function E(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?R(Object(a),!0).forEach((function(e){Object(i["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):R(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var z={name:"app-count",components:{localTable:I["a"]},data:function(){return{currMetrics:["apps_name","package_name","max_installs","installs_change","installs_change_rate","shop_page","app_annie_page"]}},props:{tableData:{type:Array,default:function(){return[]}},tableLoading:{type:Boolean,default:function(){return!0}}},computed:E(E({},Object(l["d"])({field_formaters:function(t){return t.dashboard_field.field_formaters},developer_relation:function(t){return t.dashboard_field.developer_relation},mainTableData:function(t){if(!0===this.mainInited)return t.developer_relation.developerRelationTableData.data}})),{},{mainAllMetrics:function(){return simpleToLabelFields(this.developer_relation,this.mainKnownMetrics)}}),methods:{handleClickCell:function(t,e){var a="";"shop_page"===e?a=t.row.shop_url:"app_annie_page"===e&&(a=t.row.app_annie_url),a&&""!==a&&window.open(a,"_blank")}},mounted:function(){}},N=z,$=(a("d99f"),Object(v["a"])(N,j,F,!1,null,"f6430210",null)),B=$.exports,M=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Row",{staticStyle:{"margin-top":"5px"}},[a("Card",{attrs:{shadow:""}},[a("local-table",{attrs:{data:t.tableData,"table-loading":t.tableLoading,"known-fields":t.developer_relation,noSummery:!0,noPage:!0,"have-index":!0,formater:t.field_formaters,metrics:t.currMetrics}})],1)],1)],1)},H=[];function J(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function K(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?J(Object(a),!0).forEach((function(e){Object(i["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):J(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var V={name:"app-log",components:{localTable:I["a"]},data:function(){return{currMetrics:["change_date","apps_name","package_name","source_company","target_company"]}},props:{tableData:{type:Array,default:function(){return[]}},tableLoading:{type:Boolean,default:function(){return!0}}},computed:K(K({},Object(l["d"])({field_formaters:function(t){return t.dashboard_field.field_formaters},developer_relation:function(t){return t.dashboard_field.developer_relation},mainTableData:function(t){if(!0===this.mainInited)return t.developer_relation.developerRelationTableData.data}})),{},{mainAllMetrics:function(){return simpleToLabelFields(this.developer_relation,this.mainKnownMetrics)}}),mounted:function(){}},U=V,W=(a("85cb"),Object(v["a"])(U,M,H,!1,null,"019c1305",null)),G=W.exports;a("ca62");function q(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function Z(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?q(Object(a),!0).forEach((function(e){Object(i["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):q(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var Q={name:"developer-relation",components:{PageFilter:y,TabsList:w["a"],TableData:_["a"],appCount:B,graphChart:P,appLog:G},data:function(){return{mainInited:!1,mainKnownDimensions:[],mainKnownMetrics:["company","appstore","developer","app_count","relation","app_log","note","handle"],mainInFields:[["companys","company_id"],["appstores","appstore"],["developers","developer"],["relations","relation"],["appLogs","app_log"]],mainCurrFilterApply:{},mainCurrSortField:{},mainCurrPageIndex:1,mainCurrPageSize:100,mainPageReset:!1,mainTableLoading:!0,curAppStore:"",curDeveloper:"",showAppCountState:!1,appCountLoading:!0,appCountData:[],showAppLogState:!1,appLogLoading:!0,appLogData:[],showEditState:!1,noteEdit:"",editId:"",showRelationState:!1,chartData:{},graphLoading:!0,chartMainNodeName:""}},computed:Z(Z({},Object(l["d"])({field_formaters:function(t){return t.dashboard_field.field_formaters},developer_relation:function(t){return t.dashboard_field.developer_relation},mainTableData:function(t){if(!0===this.mainInited)return t.developer_relation.developerRelationTableData.data},mainPageData:function(t){if(!0===this.mainInited){var e=t.developer_relation.developerRelationTableData,a={page_size:e.page_size,has_next:e.has_next,has_prev:e.has_prev,total_num:e.total_num};return a}}})),{},{mainAllDimensions:function(){return Object(c["j"])(this.developer_relation,this.mainKnownDimensions)},mainAllMetrics:function(){return Object(c["j"])(this.developer_relation,this.mainKnownMetrics)}}),methods:Z(Z({},Object(l["b"])(["getDeveloperRelationTableData","setLabel","getRelation","getAppCount","getAppLog","putNote"])),{},{onClickCell:function(t,e){"relation"===e?this.onClickRelation(t):"app_count"===e?this.onClickAppCount(t):"app_log"===e?this.onClickAppLog(t):"handle"===e&&this.onClickEdit(t)},onClickRelation:function(t){var e=this;this.showRelationState=!0,this.chartData={},this.graphLoading=!0,this.curAppStore=t.row.appstore,this.curDeveloper=t.row.developer,this.chartMainNodeName=t.row.developer,this.getRelation(t.row.id).then((function(t){e.chartData=t,e.graphLoading=!1})).catch((function(t){e.showError(t),e.graphLoading=!1}))},onClickAppCount:function(t){var e=this;this.showAppCountState=!0,this.appCountData=[],this.appCountLoading=!0,this.curAppStore=t.row.appstore,this.curDeveloper=t.row.developer,this.getAppCount(t.row.id).then((function(t){e.appCountData=t,e.appCountLoading=!1})).catch((function(t){e.appCountLoading=!1,e.showError(t)}))},onClickAppLog:function(t){var e=this;this.showAppLogState=!0,this.appLogData=[],this.appLogLoading=!0,this.curAppStore=t.row.appstore,this.curDeveloper=t.row.developer,this.getAppLog({id:t.row.id,period:this.mainCurrFilterApply.period?this.mainCurrFilterApply.period:7}).then((function(t){e.appLogData=t,e.appLogLoading=!1})).catch((function(t){e.appLogLoading=!1,e.showError(t)}))},onClickEdit:function(t){if(this.showEditState=!0,this.noteEdit="",null!=t.row.note&&""!==t.row.note){var e=t.row.note.lastIndexOf("("),a=t.row.note.substring(0,e);this.noteEdit=a}this.editId=t.row.id},handleEditNoteOk:function(){var t=this;this.putNote({id:this.editId,note:this.noteEdit}).then((function(e){t.$Message.success("编辑成功!")})).catch((function(e){t.showError(e)}))},mainOnFilterApply:function(t){this.mainCurrPageIndex=1,this.mainPageReset=!0,this.mainCurrFilterApply=JSON.parse(JSON.stringify(t)),this.mainCurrSortField={},this.mainKnownDimensions=JSON.parse(JSON.stringify(this.mainKnownDimensions)),this.setLabel({name:"developer_relation",value:"app_log",label:"最近"+this.mainCurrFilterApply.period+"天Apps转移记录"}),this.mainUpdateTableData()},mainHandleSortChange:function(t,e,a){this.mainCurrPageIndex=1,this.mainCurrSortField={key:t.key,order:t.order},this.mainPageReset=!0,this.mainUpdateTableData(1)},mainPageChange:function(t){this.mainCurrPageIndex=t,this.mainUpdateTableData()},mainPageSizeChange:function(t){this.mainCurrPageSize=t,this.mainPageReset=!0,this.mainUpdateTableData(1)},mainUpdateTableData:function(t){var e=this;this.mainTableLoading=!0;var a=this.mainWrapTableReqParams(t);this.getDeveloperRelationTableData(a).then((function(t){e.mainInited=!0,e.mainTableLoading=!1})).catch((function(t){e.mainTableLoading=!1,e.showError(t)}))},mainWrapTableReqParams:function(t){var e={page:JSON.stringify({count:t?1:this.mainCurrPageIndex,size:this.mainCurrPageSize}),filtering:Object(c["m"])(this.mainCurrFilterApply,this.mainInFields,this.mainLikeFields),period:this.mainCurrFilterApply.period,sort:Object(c["p"])(this.mainCurrSortField)};return e},showError:function(t){this.$Modal.error({title:"Error",content:t})},mainPageResetFalse:function(){this.mainPageReset=!1},onSelectPageInfo:function(t){var e=JSON.parse(t);this.$refs.pageFilter.setFilter(e.filter),this.mainOnFilterApply(e.filter)},onGetPageInfo:function(t){var e=this.$refs.pageFilter.getFilter(),a=JSON.stringify({filter:e});x["a"].$emit("setPageInfo",t,a)}}),mounted:function(){this.mainUpdateTableData();var t=this;x["a"].$on("selectPageInfo",(function(e){t.onSelectPageInfo(e)})),x["a"].$on("getPageInfo",(function(e){t.onGetPageInfo(e)}))},beforeDestroy:function(){x["a"].$off("selectPageInfo"),x["a"].$off("getPageInfo")}},X=Q,Y=(a("be19"),Object(v["a"])(X,n,r,!1,null,"2fbcffb8",null));e["default"]=Y.exports},"4aee":function(t,e,a){},"584d":function(t,e,a){},"64c1":function(t,e,a){"use strict";a("88d4")},"85cb":function(t,e,a){"use strict";a("4aee")},"88d4":function(t,e,a){},"88e6":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"dom",style:{width:t.previewStatus?t.client_width:"auto"}})},r=[],i=(a("7f7f"),a("28a5"),a("20d6"),a("ac6a"),a("313e")),o=a.n(i),s=a("90de"),l=a("6612"),u=a.n(l),c=a("4b65"),p={name:"group-line-chart",props:{chartData:{type:Object,default:function(){return{legendData:[],xAxisData:[],values:[]}}},knownFields:{type:Array,default:function(){return[]}},fieldFormaters:{type:Object,default:function(){return{}}},defaultFormater:{type:String,default:function(){return""}},xAxisType:{type:String,default:function(){return"日期"}},status:{type:Boolean,default:function(){return!1}},previewStatus:{type:Boolean,default:function(){return!1}},moneyType:{type:String,default:function(){return null}},events:{type:Array,default:function(){return[]}},inverseStatus:{type:Boolean,default:function(){return!1}}},data:function(){return{dom:null,client_width:1400,client_height:500}},methods:{resize:function(){this.dom.resize()},wrapOption:function(t){var e=this,a=[],n=this.fieldFormaters[this.chartData.chartField];null==n&&(n=this.defaultFormater);var r="数值";null!=this.chartData.chartField&&(r=this.knownFields.filter((function(t){return t.val===e.chartData.chartField}))[0].label);for(var i=parseInt(this.chartData.xAxisData.length/15),o=0;o<this.chartData.values.length;o++)a.push({name:this.chartData.legendData[o],type:"line",showAllSymbol:!0,data:this.chartData.values[o],itemStyle:{normal:{label:{show:this.status,formatter:function(e){if(e.dataIndex%(i+1)!==0)return"";var a=u()(e.value).format(n);return t&&a&&a.indexOf("$")>-1&&(a="¥"+a.substring(a.indexOf("$")+1,a.length)),a}}}}});var s=0===this.chartData.legendData.length,l=[];this.chartData.groups&&(l=this.chartData.groups.findIndex((function(t){return"total"===t}))>=0?[{label:"Total",val:"total"}]:Object(c["j"])(this.knownFields,this.chartData.groups));var p=this.xAxisType,d=this.events,h=this.chartData.xAxisData,f=Object.hasOwnProperty.call(this.chartData,"grid")?this.chartData.grid.left:"1.2%";return{title:{show:s,text:"暂无数据",left:"center",top:"center",textStyle:{color:"#464c5b",fontSize:16,fontWeight:400}},animation:!1,tooltip:{trigger:"item",axisPointer:{type:"cross",label:{formatter:function(e){if("y"===e.axisDimension){var a=u()(e.value).format(n);return t&&a&&a.indexOf("$")>-1&&(a="¥"+a.substring(a.indexOf("$")+1,a.length)),a}var r=e.value;if(d.length>0){r="转化率 ";var i=h.findIndex((function(t){return t===e.value}));r+=i+1+": ",r+=d[i]+"  "+(i+2)+": ",r+=d[i+1]}return r},backgroundColor:"#6a7985"}},formatter:function(e){var a=e.seriesName.split("/"),i=u()(e.value).format(n);t&&i&&i.indexOf("$")>-1&&(i="¥"+i.substring(i.indexOf("$")+1,i.length));for(var o=p+(""!==p?": ":"")+e.name,s=0;s<l.length;s++)o+="<br/>",o+=l[s].label,o+=": ",o+=a[s];return o+="<br/>",o+=r,o+=": ",o+=i,o}},legend:{formatter:function(t){return t?(t.length>32&&(t=t.slice(0,32)+"..."),t):""},tooltip:{show:!0},orient:"vertical",type:"scroll",right:10,icon:"circle",data:this.chartData.legendData},grid:{top:"10%",left:f||"1.2%",right:"260px",bottom:"3%",height:"80%",width:"auto",containLabel:!0},xAxis:[{type:"category",boundaryGap:!1,axisLabel:{rotate:15,interval:i},axisLine:{onZero:!this.inverseStatus},data:this.chartData.xAxisData}],yAxis:[{inverse:!!this.inverseStatus,type:"value",axisLabel:{formatter:function(e){var a=u()(e).format(n);return t&&a&&a.indexOf("$")>-1&&(a="¥"+a.substring(a.indexOf("$")+1,a.length)),a}}}],series:a}},renderChart:function(){var t=this,e=this.wrapOption(this.moneyType);this.$nextTick((function(){t.dom=o.a.init(t.$refs.dom),t.dom.setOption(e,!0),t.autoHeight=t.previewStatus?500:350,t.dom.resize({height:t.autoHeight}),Object(s["m"])(window,"resize",t.resize)}))},reRenderChartSeries:function(){var t=this,e=this.wrapOption(this.moneyType),a=this.dom.getOption();null!=a&&(a.series=e.series),this.$nextTick((function(){t.dom=o.a.init(t.$refs.dom),t.dom.setOption(a,!0),t.autoHeight=t.previewStatus?500:350,t.dom.resize({height:t.autoHeight}),Object(s["m"])(window,"resize",t.resize)}))},callMethod:function(t){},_expandable:function(){this.client_width=document.body.clientWidth,this.client_height=document.body.clientHeight}},watch:{chartData:{deep:!0,handler:function(t,e){this.renderChart()}},status:function(t){this.reRenderChartSeries()},previewStatus:function(t){this.reRenderChartSeries()}},mounted:function(){this.renderChart(),this._expandable();var t=this;window.onresize=function(){t._expandable()}},beforeDestroy:function(){Object(s["l"])(window,"resize",this.resize)}},d=p,h=a("2877"),f=Object(h["a"])(d,n,r,!1,null,null,null);e["a"]=f.exports},ae3e:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{directives:[{name:"show",rawName:"v-show",value:t.tableData.length>0||t.tableLoading,expression:"tableData.length > 0 || tableLoading"}],staticClass:"localTableDiv"},[a("Row",[a("Table",{staticClass:"topTable",attrs:{data:t.tableData,columns:t.tableColumns,loading:t.tableLoading,border:"",height:t.height},on:{"on-sort-change":t.handleSortChange}}),t.noSummery?t._e():a("Table",{staticClass:"summeryTable",attrs:{data:t.tableDataFun(),columns:t.tableColumns,loading:t.tableLoading,border:"","show-header":!1,height:"58"},on:{"on-sort-change":t.handleSortChange}})],1),t.noPage?t._e():a("Row",{staticStyle:{"text-align":"center"}},[a("Page",{ref:"tablePages",attrs:{"page-size":50,total:t.data.length,current:1,"page-size-opts":t.pageSizeOpts,"show-sizer":"","show-total":"","show-elevator":""}})],1)],1),a("div",{directives:[{name:"show",rawName:"v-show",value:t.tableData.length<=0&&!t.tableLoading,expression:"tableData.length <= 0 && !tableLoading"}],staticStyle:{"text-align":"center"}},[a("span",{staticStyle:{"font-size":"15px"}},[t._v("暂无数据")])])])},r=[],i=(a("ac6a"),a("55dd"),a("c5f6"),a("4b65")),o=(a("8dc2"),a("1157")),s=a.n(o),l={name:"LocalTable",props:{data:{type:Array,default:function(){return[]}},footerData:{type:Object,default:function(){return{}}},pageData:{type:Object,default:function(){return{page_size:20,has_next:!1,has_prev:!1,total_num:20}}},knownFields:{type:Array,default:function(){return[]}},tableLoading:{type:Boolean,default:function(){return!1}},dimensions:{type:Array,default:function(){return[]}},metrics:{type:Array,default:function(){return[]}},haveIndex:{type:Boolean,default:function(){return!1}},defaultFormater:{type:String,default:function(){return"0,0"}},formater:{type:Object,default:function(){return{}}},events:{type:Array,default:function(){return[]}},noSummery:{type:Boolean,default:function(){return!1}},noPage:{type:Boolean,default:function(){return!1}},tableIndex:{type:Number,default:function(){return 0}},tableHeight:{type:Number,default:function(){return 550}},dynamicHeight:{type:Boolean,default:function(){return!1}}},data:function(){return{pageSizeOpts:[10,20,30,50]}},computed:{tableColumns:function(){return Object(i["b"])(this,this.knownFields,this.dimensions,this.metrics,this.formater,this.events,this.defaultFormater,this.haveIndex,this.onClickCell)},tableData:function(){var t=this.$refs["tablePages"];if(t){var e=this.$refs["tablePages"].currentPageSize,a=this.$refs["tablePages"].total,n=this.$refs["tablePages"].currentPage,r=(n-1)*e,i=r+e-1;i>a-1&&(i=a-1);var o=this.data.slice(r,i+1);return o.length>0&&o.push({test_id:"1"}),o}var s=this.data;return s.length>0&&s.push({test_id:"1"}),s},height:function(){return this.dynamicHeight?this.data.length<=1?120:this.data.length<=3?220:this.data.length<=5?315:this.data.length<=7?415:this.tableHeight:this.tableHeight}},methods:{handleSortChange:function(t,e,a){"asc"===t.order?this.data.sort((function(e,a){var n=e[t.key],r=a[t.key];return null!=n&&isNaN(n)||null!=r&&isNaN(r)?(null==n&&(n="0"),null==r&&(r="0"),n>r?1:-1):(null==n&&(n=-1e7),null==r&&(r=-1e7),n-r)})):this.data.sort((function(e,a){var n=e[t.key],r=a[t.key];return null!=n&&isNaN(n)||null!=r&&isNaN(r)?(null==n&&(n="0"),null==r&&(r="0"),r>n?1:-1):(null==n&&(n=-1e7),null==r&&(r=-1e7),r-n)}))},getData:function(){var t=JSON.parse(JSON.stringify(this.footerData)),e={};for(var a in this.tableColumns.forEach((function(a,n){var r=a.key;0===n?e[r]={key:r,value:"合计"}:isNaN(Number(t[r]))?e[r]={key:r,value:"-"}:e[r]={key:r,value:t[r]}})),t)null==e[a]&&(e[a]={key:a,value:t[a]});return e},tableDataFun:function(){var t=this.getData(),e=[],a={};for(var n in t){var r=t[n],i=r.key,o=r.value;a[i]=o}return e.push(a),e},onClickCell:function(t,e){this.$emit("on-click-cell",t,e)}},beforeMount:function(){this.tmpTag=this.searchTag},mounted:function(){var t=this;history.pushState(null,null,document.URL),window.addEventListener("popstate",(function(){history.pushState(null,null,document.URL)}));var e=0;document.getElementsByClassName("ivu-table-body")[2*this.tableIndex].addEventListener("scroll",(function(a){var n=a.target.scrollLeft;e=a.target.scrollTop,s()(".ivu-table-body")[2*t.tableIndex+1].scrollLeft=n})),document.getElementsByClassName("ivu-table-body")[2*this.tableIndex+1].addEventListener("scroll",(function(a){var n=a.target.scrollLeft;s()(".ivu-table-body")[2*t.tableIndex].scrollLeft=n,s()(".ivu-table-body")[2*t.tableIndex].scrollTop=e})),s()((function(){s()(".topTable").addClass("hiddenTopTable")}))},watch:{tableLoading:function(t){var e=this.$refs["tablePages"];e&&!1===t&&(this.$refs["tablePages"].currentPage=1)}}},u=l,c=(a("d236"),a("2877")),p=Object(c["a"])(u,n,r,!1,null,null,null);e["a"]=p.exports},b81b:function(t,e,a){},be19:function(t,e,a){"use strict";a("edd8")},c9f9:function(t,e,a){},d236:function(t,e,a){"use strict";a("584d")},d99f:function(t,e,a){"use strict";a("c9f9")},e064:function(t,e,a){"use strict";a("b81b")},edd8:function(t,e,a){},f0e6:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",["profitLoss"===t.pageRooter?a("RadioGroup",{staticClass:"radioWapper",model:{value:t.tabItem,callback:function(e){t.tabItem=e},expression:"tabItem"}},t._l(t.tabPaneData,(function(e,n){return a("Radio",{key:n,staticStyle:{"margin-top":"10px","margin-bottom":"10px"},attrs:{label:e.label}},[t._v(t._s(e.value))])})),1):t._e(),"profitLoss"===t.pageRooter?a("Divider"):t._e(),t._t("refresh"),a("Tabs",{class:["profitLoss"===t.pageRooter?"hideTabItem":"tabItems"],attrs:{animated:!1},model:{value:t.tabItem,callback:function(e){t.tabItem=e},expression:"tabItem"}},t._l(t.tabPaneData,(function(e,n){return a("TabPane",{key:n,attrs:{label:e.value,name:e.label}},[e.label===t.tabItem?a("group-line-chart",{ref:"child",refInFor:!0,attrs:{"field-formaters":t.fieldFormaters,"known-fields":t.knownFields,"chart-data":t.lineChartData[n],status:t.checkStatus,previewStatus:t.previewStatus,"money-type":t.moneyType}}):t._e()],1)})),1)],2)},r=[],i=a("88e6"),o={name:"tabs-list",components:{GroupLineChart:i["a"]},props:{tabValue:{type:String,default:function(){return"name1"}},pageRooter:{type:String,default:function(){return""}},fieldFormaters:{type:Object,default:function(){return{}}},knownFields:{type:Array,default:function(){return[]}},lineChartData:{type:Array,default:function(){return[]}},tabPaneData:{type:Array,default:function(){return[]}},checkStatus:{type:Boolean,default:function(){return!1}},previewStatus:{type:Boolean,default:function(){return!1}},moneyType:{type:String,default:function(){return null}}},data:function(){return{tabItem:"name1"}},methods:{}},s=o,l=(a("64c1"),a("2877")),u=Object(l["a"])(s,n,r,!1,null,null,null);e["a"]=u.exports}}]);