(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-793fc75c"],{"64c1":function(t,e,a){"use strict";a("88d4")},"743f6":function(t,e,a){"use strict";a("b46f")},"88d4":function(t,e,a){},"88e6":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"dom",style:{width:t.previewStatus?t.client_width:"auto"}})},n=[],r=(a("7f7f"),a("28a5"),a("20d6"),a("ac6a"),a("313e")),s=a.n(r),o=a("90de"),l=a("6612"),c=a.n(l),u=a("4b65"),h={name:"group-line-chart",props:{chartData:{type:Object,default:function(){return{legendData:[],xAxisData:[],values:[]}}},knownFields:{type:Array,default:function(){return[]}},fieldFormaters:{type:Object,default:function(){return{}}},defaultFormater:{type:String,default:function(){return""}},xAxisType:{type:String,default:function(){return"日期"}},status:{type:Boolean,default:function(){return!1}},previewStatus:{type:Boolean,default:function(){return!1}},moneyType:{type:String,default:function(){return null}},events:{type:Array,default:function(){return[]}},inverseStatus:{type:Boolean,default:function(){return!1}}},data:function(){return{dom:null,client_width:1400,client_height:500}},methods:{resize:function(){this.dom.resize()},wrapOption:function(t){var e=this,a=[],i=this.fieldFormaters[this.chartData.chartField];null==i&&(i=this.defaultFormater);var n="数值";null!=this.chartData.chartField&&(n=this.knownFields.filter((function(t){return t.val===e.chartData.chartField}))[0].label);for(var r=parseInt(this.chartData.xAxisData.length/15),s=0;s<this.chartData.values.length;s++)a.push({name:this.chartData.legendData[s],type:"line",showAllSymbol:!0,data:this.chartData.values[s],itemStyle:{normal:{label:{show:this.status,formatter:function(e){if(e.dataIndex%(r+1)!==0)return"";var a=c()(e.value).format(i);return t&&a&&a.indexOf("$")>-1&&(a="¥"+a.substring(a.indexOf("$")+1,a.length)),a}}}}});var o=0===this.chartData.legendData.length,l=[];this.chartData.groups&&(l=this.chartData.groups.findIndex((function(t){return"total"===t}))>=0?[{label:"Total",val:"total"}]:Object(u["j"])(this.knownFields,this.chartData.groups));var h=this.xAxisType,f=this.events,d=this.chartData.xAxisData,p=Object.hasOwnProperty.call(this.chartData,"grid")?this.chartData.grid.left:"1.2%";return{title:{show:o,text:"暂无数据",left:"center",top:"center",textStyle:{color:"#464c5b",fontSize:16,fontWeight:400}},animation:!1,tooltip:{trigger:"item",axisPointer:{type:"cross",label:{formatter:function(e){if("y"===e.axisDimension){var a=c()(e.value).format(i);return t&&a&&a.indexOf("$")>-1&&(a="¥"+a.substring(a.indexOf("$")+1,a.length)),a}var n=e.value;if(f.length>0){n="转化率 ";var r=d.findIndex((function(t){return t===e.value}));n+=r+1+": ",n+=f[r]+"  "+(r+2)+": ",n+=f[r+1]}return n},backgroundColor:"#6a7985"}},formatter:function(e){var a=e.seriesName.split("/"),r=c()(e.value).format(i);t&&r&&r.indexOf("$")>-1&&(r="¥"+r.substring(r.indexOf("$")+1,r.length));for(var s=h+(""!==h?": ":"")+e.name,o=0;o<l.length;o++)s+="<br/>",s+=l[o].label,s+=": ",s+=a[o];return s+="<br/>",s+=n,s+=": ",s+=r,s}},legend:{formatter:function(t){return t?(t.length>32&&(t=t.slice(0,32)+"..."),t):""},tooltip:{show:!0},orient:"vertical",type:"scroll",right:10,icon:"circle",data:this.chartData.legendData},grid:{top:"10%",left:p||"1.2%",right:"260px",bottom:"3%",height:"80%",width:"auto",containLabel:!0},xAxis:[{type:"category",boundaryGap:!1,axisLabel:{rotate:15,interval:r},axisLine:{onZero:!this.inverseStatus},data:this.chartData.xAxisData}],yAxis:[{inverse:!!this.inverseStatus,type:"value",axisLabel:{formatter:function(e){var a=c()(e).format(i);return t&&a&&a.indexOf("$")>-1&&(a="¥"+a.substring(a.indexOf("$")+1,a.length)),a}}}],series:a}},renderChart:function(){var t=this,e=this.wrapOption(this.moneyType);this.$nextTick((function(){t.dom=s.a.init(t.$refs.dom),t.dom.setOption(e,!0),t.autoHeight=t.previewStatus?500:350,t.dom.resize({height:t.autoHeight}),Object(o["m"])(window,"resize",t.resize)}))},reRenderChartSeries:function(){var t=this,e=this.wrapOption(this.moneyType),a=this.dom.getOption();null!=a&&(a.series=e.series),this.$nextTick((function(){t.dom=s.a.init(t.$refs.dom),t.dom.setOption(a,!0),t.autoHeight=t.previewStatus?500:350,t.dom.resize({height:t.autoHeight}),Object(o["m"])(window,"resize",t.resize)}))},callMethod:function(t){},_expandable:function(){this.client_width=document.body.clientWidth,this.client_height=document.body.clientHeight}},watch:{chartData:{deep:!0,handler:function(t,e){this.renderChart()}},status:function(t){this.reRenderChartSeries()},previewStatus:function(t){this.reRenderChartSeries()}},mounted:function(){this.renderChart(),this._expandable();var t=this;window.onresize=function(){t._expandable()}},beforeDestroy:function(){Object(o["l"])(window,"resize",this.resize)}},f=h,d=a("2877"),p=Object(d["a"])(f,i,n,!1,null,null,null);e["a"]=p.exports},a43d:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Row",[a("page-filter",{ref:"pageFilter",attrs:{chinaCumulate:!0,loading:t.tableLoading,"page-rooter":"chinaCumulate"},on:{"on-filter-apply":t.onFilterApply}})],1),a("div",{attrs:{id:"mainItem"}},[a("Row",{staticClass:"contentsItem"},[a("Card",{attrs:{shadow:""}},[a("div",{staticStyle:{width:"100%",height:"auto",overflow:"hidden"}},[a("div",{staticClass:"checkBoxItemRight"},[a("Checkbox",{staticStyle:{"font-size":"14px","margin-right":"40px"},on:{"on-change":t.changeCheckbox},model:{value:t.checkStatus,callback:function(e){t.checkStatus=e},expression:"checkStatus"}},[t._v("显示数字标签")]),t.visible?a("a",{on:{click:t.previewFun}},[t._v("点击预览")]):t._e(),a("Tooltip",{attrs:{content:"关闭预览"}},[a("Button",{attrs:{id:"closeBtn"},on:{click:t.closeFun}},[t._v("X")])],1)],1)]),a("tabs-list",{ref:"tabsList",attrs:{"field-formaters":t.field_formaters,"known-fields":t.profit_fields,"line-chart-data":t.lineChartData,"check-status":t.checkStatus,"preview-status":t.previewStatus,"tab-pane-data":t.tabPaneData,"money-type":t.moneyType}})],1),t.chartLoading?a("Spin",{attrs:{size:"large",fix:""}}):t._e()],1)],1),a("Row",{staticStyle:{"margin-top":"5px"}},[a("Card",{attrs:{shadow:""}},[a("table-data",{ref:"table",attrs:{data:t.tableData,"table-loading":t.tableLoading,days:t.days,"all-app":t.allApp,"footer-data":t.totalData,"page-reset":t.pageReset,"page-data":t.pageData,"field-formaters":t.field_formaters,"known-fields":t.profit_fields,dimensions:t.currDimensions,metrics:t.metrics,"default-dimensions":t.defaultDimensions,"all-dimensions":t.allDimensions,"all-metrics":t.allMetrics,"sync-dimensions":t.syncDimensions,"sync-metrics":t.syncMetrics,"money-type":t.moneyType,"page-rooter":"chinaCumulate"},on:{"on-sort-change":t.handleSortChange,"metrics-ok":t.metricsOk,"on-table-refresh":t.handleTableRefresh,"on-download":t.download,"on-page-change":t.pageChange,"on-page-size-change":t.pageSizeChange,"on-page-reset-true":t.pageResetFalse,"on-dimensions-change":t.handleDimensionsChange}})],1),t.downloadLoading?a("Spin",{attrs:{size:"large",fix:""}}):t._e()],1)],1)},n=[],r=(a("8e6e"),a("456d"),a("ac6a"),a("5df3"),a("ade3")),s=a("45a2"),o=a("8b2b"),l=a("f0e6"),c=a("bdcb"),u=a("90de"),h=a("4481"),f=a("2f62"),d=(a("ca62"),a("1157")),p=a.n(d),m=a("4b65");function g(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function b(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?g(Object(a),!0).forEach((function(e){Object(r["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):g(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var y={name:"china-cumulate",components:{PageFilter:s["a"],LineChart:o["a"],TabsList:l["a"],TableData:c["a"]},data:function(){return{inited:!1,rowGutter:20,filteredCountry:!1,chartFields:["sum_revenue","sum_cost","roi","ecpm","avimpression","ads_arpu","media_cpi","um_retention"],defaultDimensions:["date"],knownDimensions:["year","quarterly","month","date","project","app_name"],knownMetrics:["sum_revenue","sum_cost","profit_loss","roi","ecpm","avimpression","ads_arpu","media_cpi","um_dau","af_dnu","dnu_dau_ratio","af_organic","organic_dnu_ratio","um_retention"],inFields:[["projects","project"],["apps","app_id"],["countries","country"],["appTypes","app_type"]],metrics:[],currFilterApply:{},currSortField:{},currDimensions:[],currMetrics:[],currDownloadParams:{},currPageIndex:1,currPageSize:100,pageReset:!1,tableLoading:!0,chartLoading:!0,downloadLoading:!1,syncDimensions:[],syncMetrics:[],checkStatus:!1,previewStatus:!1,visible:!0,tabPaneData:[{label:"name1",value:"总收入"},{label:"name2",value:"总花费"},{label:"name3",value:"ROAS"},{label:"name4",value:"ECPM"},{label:"name5",value:"人均展示次数"},{label:"name6",value:"广告ARPU"},{label:"name7",value:"买量CPI"},{label:"name8",value:"UM-次留"}],moneyType:"¥"}},computed:b(b({},Object(f["d"])({field_formaters:function(t){return t.dashboard_field.field_formaters},profit_fields:function(t){return t.dashboard_field.profit_fields},allApp:function(t){return t.app_reporting.allApp},lineChartData:function(t){var e=[];if(!0===this.inited&&(e=Object(m["t"])(t.profit_loss.profitLossChartData.data,this.chartFields,["app_name"])),!e||e.length<=0){e=[];for(var a=0;a<this.chartFields.length;a++)e.push({legendData:[],xAxisData:[],values:[]})}return e},tableData:function(t){if(!0===this.inited)return t.profit_loss.profitLossTableData.data},totalData:function(t){if(!0===this.inited){var e=t.profit_loss.profitLossTotalData.data;if(e&&e.length>0)return e[0]}},pageData:function(t){if(!0===this.inited){var e=t.profit_loss.profitLossTableData,a={page_size:e.page_size,has_next:e.has_next,has_prev:e.has_prev,total_num:e.total_num};return a}}})),{},{allDimensions:function(){return Object(m["j"])(this.profit_fields,this.knownDimensions)},allMetrics:function(){return Object(m["j"])(this.profit_fields,this.knownMetrics)},days:function(){var t=Object(m["h"])(this.currFilterApply);return t}}),methods:b(b({},Object(f["b"])(["getProfitLossChartData","getProfitLossTableData","getProfitLossTotalData","getDownloadUrl"])),{},{onFilterApply:function(t){this.currFilterApply=JSON.parse(JSON.stringify(t)),this.currSortField={},this.currDimensions=JSON.parse(JSON.stringify(this.currDimensions)),this.currFilterApply.countries&&this.currFilterApply.countries.length>0?this.filteredCountry=!0:this.filteredCountry=!1,this.currPageIndex=1,this.pageReset=!0,this.updatePageData()},handleSortChange:function(t,e,a){this.currPageIndex=1,this.currSortField={key:t.key,order:t.order},this.pageReset=!0,this.updateTableData(1)},handleTableRefresh:function(t,e){if(this.currDimensions=JSON.parse(JSON.stringify(t)),0===this.currDimensions.length){var a=JSON.stringify(this.knownDimensions);this.currDimensions=JSON.parse(a)}if(this.currMetrics=e,this.currSortField={},this.currMetrics=e,this.metrics=e,0===this.currMetrics.length){var i=JSON.stringify(this.knownMetrics);this.currMetrics=JSON.parse(i),this.metrics=JSON.parse(i)}this.currPageIndex=1,this.updateTableData(),this.updateTotalData(),this.pageReset=!0},handleDimensionsChange:function(t){this.syncDimensions=JSON.parse(JSON.stringify(t))},metricsOk:function(t){this.currMetrics=t,this.metrics=t,this.syncMetrics=JSON.parse(JSON.stringify(t)),this.metrics.length<=0&&(this.metrics=JSON.parse(JSON.stringify(this.knownMetrics)),this.syncMetrics=JSON.parse(JSON.stringify(this.knownMetrics)))},download:function(t){this.currDownloadParams=JSON.parse(JSON.stringify(t)),this.downloadFile()},pageChange:function(t){this.currPageIndex=t,this.updateTableData()},pageSizeChange:function(t){this.currPageSize=t,this.pageReset=!0,this.updateTableData(1)},setDefaultDimensionsAndMetrics:function(){var t=JSON.stringify(this.defaultDimensions);this.currDimensions=JSON.parse(t),this.syncDimensions=JSON.parse(t),t=JSON.stringify(this.knownMetrics),this.metrics=JSON.parse(t),this.currMetrics=JSON.parse(t),this.syncMetrics=JSON.parse(t)},updateChartData:function(){var t=this;this.chartLoading=!0;var e=this.wrapChartReqParams();this.getProfitLossChartData(e).then((function(e){t.chartLoading=!1})).catch((function(e){t.chartLoading=!1,t.showError(e)}))},updateTableData:function(t){var e=this;this.tableLoading=!0;var a=this.wrapTableReqParams(t);this.getProfitLossTableData(a).then((function(t){e.tableLoading=!1})).catch((function(t){e.tableLoading=!1,e.showError(t)}))},updateTotalData:function(){var t=this,e=this.wrapTotalReqParams();e.group_by&&this.getProfitLossTotalData(e).then((function(t){})).catch((function(e){return t.showError(e)}))},updatePageData:function(){var t=this;this.tableLoading=!0,this.chartLoading=!0,Promise.all([this.getProfitLossChartData(this.wrapChartReqParams()),this.getProfitLossTableData(this.wrapTableReqParams()),this.getProfitLossTotalData(this.wrapTotalReqParams())]).then((function(e){t.inited=!0,t.tableLoading=!1,t.chartLoading=!1})).catch((function(e){t.tableLoading=!1,t.chartLoading=!1,t.showError(e)}))},downloadFile:function(){var t=this;this.downloadLoading=!0;var e=this.wrapDownloadReqParams();this.getDownloadUrl(e).then((function(e){t.downloadLoading=!1;var a=document.createElement("a");a.href=e.url,a.click()})).catch((function(e){t.downloadLoading=!1,t.showError(e)}))},wrapChartReqParams:function(){var t=JSON.stringify(["app_name","date"]),e={time_range:Object(m["r"])(this.currFilterApply),group_by:t,filtering:Object(m["m"])(this.currFilterApply,this.inFields),pageRooter:"chinaCumulate"};return e},wrapTableReqParams:function(t){var e={time_range:Object(m["r"])(this.currFilterApply),page:JSON.stringify({count:t?1:this.currPageIndex,size:this.currPageSize}),filtering:Object(m["m"])(this.currFilterApply,this.inFields),group_by:Object(m["n"])(this.currDimensions),fields:Object(m["l"])(this.knownMetrics),sort:Object(m["p"])(this.currSortField),pageRooter:"chinaCumulate"};return e},wrapTotalReqParams:function(){var t={time_range:Object(m["r"])(this.currFilterApply),filtering:Object(m["m"])(this.currFilterApply,this.inFields),fields:Object(m["l"])(this.knownMetrics),pageRooter:"chinaCumulate"};return t},wrapDownloadReqParams:function(){var t={time_range:Object(m["r"])(this.currFilterApply),filtering:Object(m["m"])(this.currFilterApply,this.inFields),group_by:Object(m["n"])(this.currDownloadParams.dimensions,!0),fields:Object(m["l"])(this.currDownloadParams.metrics),file_format:this.currDownloadParams.fileFormat,pageRooter:"chinaCumulate"};return t},showError:function(t){this.$Modal.error({title:"Error",content:t})},pageResetFalse:function(){this.pageReset=!1},changeCheckbox:function(t){this.checkStatus=t,this.lineChartData.status=t},onSelectPageInfo:function(t){var e=JSON.parse(t);this.$refs.pageFilter.setFilter(e.filter),this.$refs.tabsList.tabItem=e.cur_chart,this.checkStatus=e.checkStatus,this.$refs.table.$refs.childTableDimensions.setData(e.dimensions),this.currDimensions=JSON.parse(JSON.stringify(e.dimensions.dimensions.length>0?e.dimensions.dimensions:this.knownDimensions)),this.metrics=JSON.parse(JSON.stringify(e.dimensions.metrics.length>0?e.dimensions.metrics:this.knownMetrics)),e.filter.time_type&&(e.filter.rangeDates=Object(u["f"])(e.filter.time_type)),this.onFilterApply(e.filter)},onGetPageInfo:function(t){var e=this.$refs.pageFilter.getFilter(),a=this.$refs.tabsList.tabItem,i=this.$refs.table.$refs.childTableDimensions.getData(),n=JSON.stringify({filter:e,cur_chart:a,checkStatus:this.checkStatus,dimensions:i});h["a"].$emit("setPageInfo",t,n)},previewFun:function(){this.visible=!1,this.previewStatus=!0;var t=document.getElementsByClassName("contentsItem");if(p()("#mainItem").length&&p()("#closeBtn").length&&t){var e=document.body.clientWidth;p()("#mainItem").css({width:e+"px",height:"100vh",background:"rgba(0,0,0,.8)",position:"fixed",top:"0",left:"0",zIndex:"1000"}),p()("#closeBtn").css({position:"fixed",top:"10%",right:"0",zIndex:"1000",marginTop:"12px",marginRight:"12px",display:"block"}),t[0].style.top="8%"}},closeFun:function(){this.visible=!0,this.previewStatus=!1,p()("#mainItem").length&&p()("#closeBtn").length&&(p()("#mainItem").css({width:"auto",height:"auto",position:"static",background:"#ffffff"}),p()("#closeBtn").css({display:"none"}))}}),mounted:function(){this.setDefaultDimensionsAndMetrics(),this.updatePageData();var t=this;h["a"].$on("selectPageInfo",(function(e){t.onSelectPageInfo(e)})),h["a"].$on("getPageInfo",(function(e){t.onGetPageInfo(e)}))},beforeDestroy:function(){h["a"].$off("selectPageInfo"),h["a"].$off("getPageInfo")}},v=y,D=(a("743f6"),a("2877")),w=Object(D["a"])(v,i,n,!1,null,"6708d170",null);e["default"]=w.exports},b46f:function(t,e,a){},f0e6:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",["profitLoss"===t.pageRooter?a("RadioGroup",{staticClass:"radioWapper",model:{value:t.tabItem,callback:function(e){t.tabItem=e},expression:"tabItem"}},t._l(t.tabPaneData,(function(e,i){return a("Radio",{key:i,staticStyle:{"margin-top":"10px","margin-bottom":"10px"},attrs:{label:e.label}},[t._v(t._s(e.value))])})),1):t._e(),"profitLoss"===t.pageRooter?a("Divider"):t._e(),t._t("refresh"),a("Tabs",{class:["profitLoss"===t.pageRooter?"hideTabItem":"tabItems"],attrs:{animated:!1},model:{value:t.tabItem,callback:function(e){t.tabItem=e},expression:"tabItem"}},t._l(t.tabPaneData,(function(e,i){return a("TabPane",{key:i,attrs:{label:e.value,name:e.label}},[e.label===t.tabItem?a("group-line-chart",{ref:"child",refInFor:!0,attrs:{"field-formaters":t.fieldFormaters,"known-fields":t.knownFields,"chart-data":t.lineChartData[i],status:t.checkStatus,previewStatus:t.previewStatus,"money-type":t.moneyType}}):t._e()],1)})),1)],2)},n=[],r=a("88e6"),s={name:"tabs-list",components:{GroupLineChart:r["a"]},props:{tabValue:{type:String,default:function(){return"name1"}},pageRooter:{type:String,default:function(){return""}},fieldFormaters:{type:Object,default:function(){return{}}},knownFields:{type:Array,default:function(){return[]}},lineChartData:{type:Array,default:function(){return[]}},tabPaneData:{type:Array,default:function(){return[]}},checkStatus:{type:Boolean,default:function(){return!1}},previewStatus:{type:Boolean,default:function(){return!1}},moneyType:{type:String,default:function(){return null}}},data:function(){return{tabItem:"name1"}},methods:{}},o=s,l=(a("64c1"),a("2877")),c=Object(l["a"])(o,i,n,!1,null,null,null);e["a"]=c.exports}}]);