(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5080ca36"],{"82eb2":function(e,t,n){},"8f11":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"event_wapper event_info_wapper"},[e.loading?n("div",{staticStyle:{height:"100vh",position:"relative"}},[n("Spin",{attrs:{fix:"",size:"large"}})],1):e._e(),n("div",{staticStyle:{"margin-bottom":"12px",display:"inline-block","border-width":"5px"}},[n("Button",{attrs:{type:"primary"},on:{click:e.handleBack}},[e._v("返回")])],1),n("Card",[n("a-form-model",{ref:"ruleForm",attrs:{model:e.form,rules:e.rules,"label-col":e.labelCol,"wrapper-col":e.wrapperCol,hideRequiredMark:!0}},[n("a-form-model-item",{attrs:{label:"Select App",prop:"selectApp"}},[n("a-select",{staticStyle:{width:"240px","margin-right":"10px","margin-left":"10px"},attrs:{allowClear:"",showSearch:"",filterable:"",showArrow:"",autoClearSearchValue:!1,"max-tag-count":this.maxTagArr[0],"max-tag-text-length":this.maxTagTextArr[0],placeholder:"请选择",dropdownClassName:"inline-width-special",optionFilterProp:"children"},on:{change:e.handleSelectApp,blur:e.onOpenChangeApps},model:{value:e.form.selectApp,callback:function(t){e.$set(e.form,"selectApp",t)},expression:"form.selectApp"}},e._l(e.allApps,(function(t,a){return n("a-option",{key:a,attrs:{value:t.app_id}},[e._v(e._s(t.app_name)+"\n          ")])})),1)],1),n("Row",[n("a-form-model-item",{staticStyle:{float:"left"},attrs:{label:"Select Events",prop:"events"}}),n("a-form-model-item",{staticClass:"event_info_form_item",attrs:{label:"","label-col":e.labelCol,"wrapper-col":e.wrapperCol4}},[n("div",{staticStyle:{"margin-left":"10px","margin-top":"0px"}},[e._l(e.selectedEvents,(function(t,a){return n("span",{key:a},[n("span",{directives:[{name:"show",rawName:"v-show",value:a!==e.editSelectedEventIndex,expression:"i!==editSelectedEventIndex"}]},[n("span",[e._v(e._s(a+1)+" ")]),n("a",{on:{click:function(n){return e.handleEditEvent(a,t)}}},[e._v(e._s(t))]),n("Poptip",{attrs:{trigger:"hover",placement:"bottom",width:"400"},on:{"on-popper-show":function(n){return e.onPopperShow(a,t)}}},[n("a",{staticStyle:{"padding-bottom":"7px","padding-top":"0px","margin-left":"8px",color:"rgba(0,0,0,.65)"},on:{click:function(n){return e.handleEventParams(a,t)}}},[e._v("\n                选择参数"+e._s(e.getParamsLength(t+"_"+a)>0?"("+e.getParamsLength(t+"_"+a)+")":"")+"\n              ")]),n("div",{staticClass:"poptip_wapper",staticStyle:{"white-space":"break-spaces",overflow:"hidden","text-overflow":"clip",height:"auto","min-height":"80px","max-height":"35vh","overflow-y":"auto"},attrs:{slot:"content",id:"poptip_wapper"},slot:"content"},[e.currentEventValue.length<1?n("div",{staticClass:"no_data"},[e._v("请选择参数")]):n("div",e._l(e.currentEventValue,(function(t,a){return n("div",{key:a,staticClass:"data_wapper"},[t.field?n("li",[e._v("第"+e._s(a+1)+"组参数:")]):e._e(),t.field?n("li",[e._v("参数名:"+e._s(t.field))]):e._e(),t.field?n("li",[e._v("参数值:"+e._s(t.value?t.value.join(","):""))]):e._e()])})),0)])]),n("Button",{staticStyle:{"padding-bottom":"7px","padding-top":"0px"},attrs:{type:"text",size:"small"},on:{click:function(n){return e.handleCloseEvent(a,t)}}},[e._v("x")])],1),n("Select",{directives:[{name:"show",rawName:"v-show",value:a===e.editSelectedEventIndex,expression:"i===editSelectedEventIndex"}],staticStyle:{width:"240px","margin-right":"10px","margin-left":"0px"},attrs:{filterable:!0,placeholder:"请选择","not-found-text":"No Data"},on:{"on-select":e.handleEditSelectEvent,"on-change":function(t){return e.handleModuleChange(a)},"on-open-change":e.onOpenChangeEvent},model:{value:e.selectedEvents[a],callback:function(t){e.$set(e.selectedEvents,a,t)},expression:"selectedEvents[i]"}},e._l(e.allEvents,(function(t,a){return n("Option",{key:a,attrs:{value:t}},[e._v(e._s(t))])})),1)],1)})),e.showSelectEvent?n("Select",{staticStyle:{width:"240px","margin-right":"10px","margin-left":"0px"},attrs:{filterable:!0,placeholder:"请选择","not-found-text":"No Data"},on:{"on-select":e.handleSelectEvent,"on-open-change":e.onOpenChangeEvent},model:{value:e.selectEvent,callback:function(t){e.selectEvent=t},expression:"selectEvent"}},e._l(e.allEvents,(function(t,a){return n("Option",{key:a,attrs:{value:t}},[e._v(e._s(t)+"\n              ")])})),1):e._e(),!1===e.showSelectEvent?n("Button",{staticStyle:{"padding-bottom":"7px","padding-top":"0px"},attrs:{type:"text",size:"large"},on:{click:e.handleAddEvent}},[e._v("+\n            ")]):e._e()],2)])],1),n("Row",[n("a-form-model-item",{staticStyle:{"margin-bottom":"0"},attrs:{label:"Breakdown by:",prop:"generalInfo","label-col":e.labelCol2,"wrapper-col":e.labelCol2}}),n("a-form-model-item",{staticStyle:{"margin-left":"120px"},attrs:{label:"General Info:",prop:"generalInfo","label-col":e.labelCol,"wrapper-col":e.labelCol2}},[n("a-select",{staticStyle:{width:"240px","margin-right":"10px","margin-left":"10px"},attrs:{mode:"multiple",allowClear:"",filterable:"",showArrow:"",placeholder:"请选择",autoClearSearchValue:!1,"max-tag-count":this.maxTagArr[2],"max-tag-text-length":this.maxTagTextArr[2],optionFilterProp:"children"},on:{focus:function(t){return e.focusFun(2)},blur:function(t){return e.blurFun()}},model:{value:e.form.generalInfo,callback:function(t){e.$set(e.form,"generalInfo",t)},expression:"form.generalInfo"}},e._l(e.allGeneralInfo,(function(t){return n("a-option",{key:t.key,attrs:{value:t.key}},[e._v(e._s(t.value)+"\n            ")])})),1)],1)],1),n("a-form-model-item",{staticStyle:{"margin-left":"120px"},attrs:{label:"Custom Key:",prop:"customInfo","label-col":e.labelCol,"wrapper-col":e.labelCol2}},[n("a-select",{staticStyle:{width:"240px","margin-right":"10px","margin-left":"10px"},attrs:{mode:"multiple",allowClear:"",filterable:"",showArrow:"",placeholder:"请选择",autoClearSearchValue:!1,"max-tag-count":this.maxTagArr[3],"max-tag-text-length":this.maxTagTextArr[3],optionFilterProp:"children"},on:{focus:function(t){return e.focusFun(3)},blur:function(t){return e.blurFun()}},model:{value:e.form.customInfo,callback:function(t){e.$set(e.form,"customInfo",t)},expression:"form.customInfo"}},[e.customOptionStatus?n("a-spin",{attrs:{slot:"notFoundContent",size:"small"},slot:"notFoundContent"}):e._e(),e._l(e.allCustomInfo,(function(t){return n("a-option",{key:t,attrs:{value:t}},[e._v(e._s(t)+"\n          ")])}))],2)],1),n("a-form-model-item",{attrs:{label:"Select Date:",prop:"rangeDates"}},[n("DatePicker",{staticStyle:{width:"240px","margin-right":"10px","margin-left":"10px"},attrs:{type:"daterange",options:e.daterangeoption,clearable:!1,placement:"bottom-start",placeholder:"选择日期范围"},model:{value:e.form.rangeDates,callback:function(t){e.$set(e.form,"rangeDates",t)},expression:"form.rangeDates"}})],1),n("Row",[n("a-form-model-item",{staticStyle:{float:"left"},attrs:{label:"Filters",prop:"events"}}),n("a-form-model-item",{staticClass:"event_info_form_item",attrs:{label:"","label-col":e.labelCol,"wrapper-col":e.wrapperCol4}},[n("div",{staticClass:"search_wapper"},[e._l(e.filters,(function(t,a){return n("div",{key:a},[n("p",[t["editStatus"]&&"condition"===t["editField"]?n("select-of-dynamic-search",{attrs:{"select-type":"single","current-search-index":a,status:!1,"field-name":"condition","sing-selected-val":t.condition,"all-options":e.currentOptions},on:{"select-change":e.selectChange,"deal-filters-data":e.dealFiltersData}}):n("a",{directives:[{name:"show",rawName:"v-show",value:t["condition"],expression:"val['condition']"}],on:{click:function(t){return e.handleClickField("condition",a)}}},[e._v(e._s(t.condition))]),t.condition||a<1?n("span",[e._v(e._s(a+1)+"-select people who")]):e._e(),t["editStatus"]&&"performed"===t["editField"]?n("select-of-dynamic-search",{attrs:{"select-type":"single","current-search-index":a,status:!1,"field-name":"performed","sing-selected-val":t.performed,"all-options":e.currentOptions},on:{"select-change":e.selectChange,"deal-filters-data":e.dealFiltersData}}):n("a",{directives:[{name:"show",rawName:"v-show",value:t.performed,expression:"val.performed"}],on:{click:function(t){return e.handleClickField("performed",a)}}},[e._v(e._s(t.performed)+":")]),"meet a general condition"!==t.performed?n("span",[t["editStatus"]&&"eventName"===t["editField"]?n("select-of-dynamic-search",{attrs:{"select-type":"single","current-search-index":a,status:!1,"field-name":"eventName","sing-selected-val":t.eventName,"all-options":e.currentOptions},on:{"select-change":e.selectChange,"deal-filters-data":e.dealFiltersData}}):n("a",{directives:[{name:"show",rawName:"v-show",value:t.eventName,expression:"val.eventName"}],on:{click:function(t){return e.handleClickField("eventName",a)}}},[e._v(e._s(t.eventName))]),t.eventName&&!t.fieldName&&"fieldName"!==t["editField"]?n("Button",{on:{click:function(t){e.addCondition(a)}}},[n("Icon",{attrs:{type:"ios-add-circle"}}),e._v("where条件")],1):e._e(),t.fieldName||"fieldName"===t["editField"]?n("span",[e._v("where")]):e._e(),t["editStatus"]&&"fieldName"===t["editField"]?n("select-of-dynamic-search",{attrs:{"select-type":"single","current-search-index":a,status:!1,"field-name":"fieldName","sing-selected-val":t.fieldName,loading:e.loaddingOfOption,"all-options":e.currentOptions},on:{"select-change":e.selectChange,"deal-filters-data":e.dealFiltersData}}):n("a",{directives:[{name:"show",rawName:"v-show",value:t.fieldName,expression:"val.fieldName"}],on:{click:function(t){return e.handleClickField("fieldName",a)}}},[e._v(e._s(t.fieldName))])],1):n("span",[t["editStatus"]&&"fieldName"===t["editField"]?n("select-of-dynamic-search",{attrs:{"select-type":"single","current-search-index":a,status:!1,"field-name":"fieldName","sing-selected-val":t.fieldName,"all-options":e.currentOptions},on:{"select-change":e.selectChangeGenaral,"deal-filters-data":e.dealFiltersData}}):n("a",{directives:[{name:"show",rawName:"v-show",value:t.fieldName,expression:"val.fieldName"}],on:{click:function(t){return e.handleClickGereralField("fieldName",a)}}},[e._v(e._s(t.fieldName))])],1),t["editStatus"]&&"operator"===t["editField"]?n("select-of-dynamic-search",{attrs:{"select-type":"single","current-search-index":a,status:!1,"field-name":"operator","sing-selected-val":t.operator,loading:e.loaddingOfOption,"all-options":e.currentOptions},on:{"select-change":e.selectChange,"deal-filters-data":e.dealFiltersData}}):n("a",{directives:[{name:"show",rawName:"v-show",value:t.operator,expression:"val.operator"}],on:{click:function(t){return e.handleClickField("operator",a)}}},[e._v(e._s(t.operator))]),t["editStatus"]&&"value"===t["editField"]&&t["valueType"]&&"select"===t["valueType"]?n("select-of-dynamic-search",{ref:"getMultipleData",refInFor:!0,attrs:{"select-type":"multiple","current-search-index":a,status:!1,"field-name":"value","mult-selected-val":t.value,loading:e.loaddingOfOption,"all-options":e.currentOptions},on:{"select-change":e.selectChange,"deal-filters-data":e.dealFiltersData}}):t["editStatus"]&&"value"===t["editField"]&&t["valueType"]&&"input"===t["valueType"]?n("select-of-dynamic-search",{ref:"getInputData",refInFor:!0,attrs:{"select-type":"input","current-search-index":a,status:!1,"field-name":"value","input-val":t.value,"all-options":e.currentOptions},on:{"select-change":e.selectChange,"deal-filters-data":e.dealFiltersData}}):n("a",{on:{click:function(t){return e.handleClickField("value",a)}}},[e._v(e._s(t.value?"string"===typeof t.value?t.value:t["value"].join(","):""))]),t["editStatus"]&&t["performed"]?n("Button",{staticClass:"closeItem",attrs:{type:"text",size:"small"},on:{click:function(t){return e.saveCondition(a)}}},[n("Icon",{attrs:{type:"md-checkmark-circle"}})],1):e._e(),n("Button",{staticClass:"closeItem",attrs:{type:"text",size:"small"},on:{click:function(t){return e.delSearch(a)}}},[e._v("x")])],1)])})),n("a",{on:{click:e.addSearch}},[n("Icon",{attrs:{type:"md-add"}}),e._v("添加筛选条件")],1)],2)])],1),n("a-form-model-item",{attrs:{label:"Table Name:",prop:"tableName"}},[n("a-input",{staticStyle:{display:"inline-block",width:"240px","margin-right":"10px","margin-left":"10px"},model:{value:e.form.tableName,callback:function(t){e.$set(e.form,"tableName",t)},expression:"form.tableName"}})],1),n("a-form-model-item",{attrs:{"wrapper-col":{span:14,offset:0}}},[n("a-button",{attrs:{type:"primary",disabled:e.tableLoading},on:{click:e.onSubmit}},[e._v(" 开始分析")]),n("a-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",disabled:e.btnStatus},on:{click:function(t){return e.handleSave(!1)}}},[e._v("保存\n        ")]),e.saveStatus?n("a-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",disabled:e.btnStatus},on:{click:function(t){return e.handleSave(!0)}}},[e._v("另存为\n        ")]):e._e()],1)],1)],1),n("Modal",{attrs:{width:"880px",closable:!1,"mask-closable":!1,title:e.title,"footer-hide":""},model:{value:e.paramsVisible,callback:function(t){e.paramsVisible=t},expression:"paramsVisible"}},[n("div",{attrs:{slot:"header"},slot:"header"},[n("font",{attrs:{size:"4"}},[n("b",[e._v("Event Name: "+e._s(e.title))])])],1),n("div",[n("Form",{ref:"formDynamic",attrs:{model:e.formDynamic,"label-width":80}},[e._l(e.formDynamic.items,(function(t,a){return[n("Row",{key:a},[n("Col",{attrs:{span:"8"}},[n("FormItem",{key:a,attrs:{label:"参数名",prop:"items."+a+".name",rules:{required:!0,message:"参数名不能为空",trigger:"change"}}},[n("Row",[n("Col",{attrs:{span:"24"}},[n("a-select",{staticStyle:{width:"200px","margin-right":"10px","margin-left":"10px"},attrs:{"show-search":"",filterable:"",showArrow:"",autoClearSearchValue:!1,placeholder:"请选择参数",dropdownClassName:"inline-width-special",optionFilterProp:"children"},on:{change:function(t){return e.changeParamsName(a)}},model:{value:t.name,callback:function(n){e.$set(t,"name",n)},expression:"item.name"}},e._l(e.allParams,(function(t){return n("a-option",{key:t,attrs:{value:t}},[e._v(e._s(t)+"\n                      ")])})),1)],1)],1)],1)],1),n("Col",{attrs:{span:"16"}},[n("FormItem",{key:a,staticClass:"form_item",attrs:{label:"value",prop:"items."+a+".value"}},[n("Row",[n("Col",{attrs:{span:"18"}},[n("a-select",{staticStyle:{width:"85%","margin-right":"10px","margin-left":"10px"},attrs:{mode:"multiple",allowClear:"","show-search":"",showArrow:"",autoClearSearchValue:!1,dropdownClassName:"inline-width-special",placeholder:"请选择value值",optionFilterProp:"children","max-tag-count":e.maxTagCountfun(a),"max-tag-text-length":e.maxTagTextfun(a)},on:{focus:function(t){return e.paramsFocusFun(a)},blur:function(t){return e.paramsBlurFun()}},model:{value:t.value,callback:function(n){e.$set(t,"value",n)},expression:"item.value"}},e._l(e.getAllParamsValue(t.name),(function(t){return n("a-option",{key:t,attrs:{value:t}},[e._v(e._s(t)+"\n                      ")])})),1)],1),n("Col",{attrs:{span:"2",offset:"1"}},[e.formDynamic.items.length>1?n("a",{staticClass:"ad_btn",on:{click:function(t){return e.handleRemove(a)}}},[n("Icon",{attrs:{type:"md-close"}})],1):e._e()]),n("Col",{attrs:{span:"2",offset:"1"}},[(1===e.formDynamic.items||a===e.formDynamic.items.length-1)&&e.formDynamic.items.length<10?n("a",{staticClass:"ad_btn",on:{click:e.handleAdd}},[n("Icon",{attrs:{type:"md-add"}})],1):e._e()])],1)],1)],1)],1)]}))],2)],1),n("Row",[n("Button",{staticStyle:{float:"right","margin-left":"10px"},attrs:{type:"primary"},on:{click:e.handleAddDimesion}},[e._v("确定")]),n("Button",{staticStyle:{"margin-left":"8px",float:"right"},on:{click:function(t){return e.handleCancel(1)}}},[e._v("取消")])],1)],1),e.status?n("Card",{staticStyle:{"margin-top":"12px","min-height":"240px"}},[n("Tabs",{staticClass:"event-funnel-tabs",attrs:{"capture-focus":!0},on:{"on-click":e.handleUserTypeChange},model:{value:e.currUserType,callback:function(t){e.currUserType=t},expression:"currUserType"}},[n("TabPane",{attrs:{label:"所有用户",name:"all_user",disabled:e.tableLoading}}),n("TabPane",{attrs:{label:"新用户",name:"new_user",disabled:e.tableLoading}}),n("TabPane",{attrs:{label:"老用户",name:"old_user",disabled:e.tableLoading}})],1),n("div",{staticStyle:{"margin-bottom":"12px"}},[n("span",[e._v("选择指标")]),n("a-select",{staticStyle:{width:"240px","margin-right":"10px","margin-left":"10px"},attrs:{mode:"multiple",allowClear:"",filterable:"",showArrow:"",autoClearSearchValue:!1,"max-tag-count":this.maxTagArr[7],"max-tag-text-length":this.maxTagTextArr[7],placeholder:"请选择",optionFilterProp:"children"},on:{focus:function(t){return e.focusFun(7)},blur:function(t){return e.blurFun()}},scopedSlots:e._u([{key:"dropdownRender",fn:function(t){return n("div",{},[n("v-nodes",{attrs:{vnodes:t}}),n("a-divider",{staticClass:"select-all-divider"}),n("div",{staticClass:"select-all-div",on:{mousedown:function(e){return e.preventDefault()}}},[n("span",{staticClass:"select-all-span"},[e._v(e._s(e.targetVal.length)+"/"+e._s(e.allTargetOptions.length))]),n("Button",{attrs:{type:"primary"},on:{click:function(t){e.targetVal=e.allTargetOptions.map((function(e){return e.label}))}}},[e._v("全选")])],1)],1)}}],null,!1,546394497),model:{value:e.targetVal,callback:function(t){e.targetVal=t},expression:"targetVal"}},e._l(e.allTargetOptions,(function(t){return n("a-option",{key:t.label,attrs:{value:t.label}},[e._v(e._s(t.value)+"\n        ")])})),1),n("Button",{attrs:{type:"primary",disabled:e.tableLoading},on:{click:e.refreshData}},[e._v(" 刷新")]),n("Button",{staticStyle:{float:"right"},attrs:{type:"primary",disabled:e.tableLoading||e.downloadLoading},on:{click:e.downloadData}},[e._v("\n        下载\n      ")])],1),n("div",[n("table-data",{ref:"table",attrs:{data:e.info,"table-col":e.col,"total-table-col":e.colOfTotal,"table-loading":e.tableLoading,"footer-data":e.totalData,"page-reset":e.pageReset,"have-dimension":!1,"page-data":e.pageData,"page-size-opts":e.pageSizeOpts,"page-rooter":"eventInfoDetail"},on:{"on-sort-change":e.handleSortChange,"on-page-change":e.pageChange,"on-page-size-change":e.pageSizeChange,"on-page-reset-true":e.pageResetFalse}})],1)],1):e._e()],1)},i=[],r=(n("ac4d"),n("8a81"),n("6b54"),n("8e6e"),n("456d"),n("7f7f"),n("4f7f"),n("1c4c"),n("ac6a"),n("5df3"),n("20d6"),n("55dd"),n("ade3")),l=n("2f62"),s=n("90de"),o=n("9839"),c=n("4b65"),u=n("bdcb"),d=n("4481"),f=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",["single"===e.selectType?n("span",[n("a-select",{staticStyle:{width:"240px","margin-right":"10px","margin-left":"0px"},attrs:{allowClear:"",showSearch:"",filterable:"",showArrow:"",autoClearSearchValue:!1,placeholder:"请选择",dropdownClassName:"inline-width-special",optionFilterProp:"children"},on:{change:function(t){return e.handleChange("single")},blur:function(t){return e.handleBlur("single")}},model:{value:e.singModal,callback:function(t){e.singModal=t},expression:"singModal"}},[e.loading?n("a-spin",{attrs:{slot:"notFoundContent",size:"small"},slot:"notFoundContent"}):e._e(),e._l(e.allOptions,(function(t,a){return n("a-option",{key:a,attrs:{value:t}},[e._v(e._s(t)+"\n      ")])}))],2)],1):"multiple"===e.selectType?n("span",[n("a-select",{staticStyle:{width:"240px","margin-right":"10px","margin-left":"0px"},attrs:{allowClear:"",showSearch:"",mode:"multiple",filterable:"",showArrow:"",autoClearSearchValue:!1,placeholder:"请选择",dropdownClassName:"inline-width-special",optionFilterProp:"children"},on:{change:function(t){return e.handleChange("multiple")},blur:function(t){return e.handleBlur("multiple")}},model:{value:e.mulModal,callback:function(t){e.mulModal=t},expression:"mulModal"}},[e.loading?n("a-spin",{attrs:{slot:"notFoundContent",size:"small"},slot:"notFoundContent"}):e._e(),e._l(e.allOptions,(function(t,a){return n("a-option",{key:a,attrs:{value:t}},[e._v(e._s(t)+"\n      ")])}))],2)],1):n("span",[n("a-input",{staticClass:"valueItem",attrs:{placeholder:"请输入"},model:{value:e.inputModal,callback:function(t){e.inputModal=t},expression:"inputModal"}})],1)])},p=[],h=(n("c5f6"),{name:"select-of-dynamic-search",components:{ASelect:o["d"],AOption:o["d"].Option},data:function(){return{singModal:"",mulModal:[],inputModal:"",options:[],changeStatus:!1}},props:{allOptions:{type:Array,default:function(){return[]}},selectType:{type:String,default:""},fieldName:{type:String,default:""},currentSearchIndex:{type:Number,default:0},singSelectedVal:{type:String,default:""},multSelectedVal:{type:Array,default:function(){return[]}},inputVal:{type:String,default:""},loading:{type:Boolean,default:function(){return!1}},status:{type:Boolean,default:function(){return!1}}},methods:{handleChange:function(e){if(this.changeStatus=!0,"single"===e&&this.changeStatus){var t="multiple"===e?this.mulModal:this.singModal;(this.singModal||t&&t.length>0&&"multiple"===e)&&this.$emit("select-change",this.currentSearchIndex,t,this.fieldName)}},handleBlur:function(e){if(this.changeStatus){var t="multiple"===e?this.mulModal:this.singModal;(this.singModal||t&&t.length>0&&"multiple"===e)&&this.$emit("select-change",this.currentSearchIndex,t,this.fieldName)}}},destroyed:function(){this.changeStatus=!1},watch:{singSelectedVal:{immediate:!0,handler:function(e){this.singModal=e}},multSelectedVal:{immediate:!0,handler:function(e){this.mulModal=e}},inputVal:{immediate:!0,handler:function(e){this.inputModal=e}},status:{immediate:!0,handler:function(e){this.changeStatus=e}},allOptions:function(e){this.options=e},currentSearchIndex:{immediate:!0,handler:function(e){this.$emit("deal-filters-data",e)}}}}),m=h,v=(n("a93b"),n("2877")),g=Object(v["a"])(m,f,p,!1,null,null,null),y=g.exports,_=n("9c6c0"),b=n("6612"),O=n.n(b),S=n("1157"),w=n.n(S);n("82eb2");function x(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=C(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,i=function(){};return{s:i,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,l=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){s=!0,r=e},f:function(){try{l||null==n.return||n.return()}finally{if(s)throw r}}}}function C(e,t){if(e){if("string"===typeof e)return k(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?k(e,t):void 0}}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function A(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?A(Object(n),!0).forEach((function(t){Object(r["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):A(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var N={name:"event-info-detail",components:{ASelect:o["d"],AOption:o["d"].Option,TableData:u["a"],VNodes:{functional:!0,render:function(e,t){return t.props.vnodes}},SelectOfDynamicSearch:y},data:function(){return{selectApp:"",events:[],allEvents:[],maxTagArr:[1,1,1,1,1,1,1,1],maxTagTextArr:[10,10,10,10,10,10,10,10],tmpAllOptions:[],tmpOptions:[],allCountries:[],allMediaSources:[],allAppVersion:[],width_:1360,mark:0,pageSizeOpts:[50,100,200],tableLoading:!1,downloadLoading:!1,btnStatus:!1,pageReset:!1,status:!1,generalInfo:[],allGeneralInfo:[],customInfo:[],allCustomInfo:[],saveStatus:!1,daterangeoption:{},funnel_id:"",labelCol:{span:2},wrapperCol:{span:14},labelCol2:{span:3},wrapperCol2:{span:14},labelCol3:{span:12},wrapperCol4:{span:24},eventOptionStatus:!1,customOptionStatus:!1,versionOptionStatus:!1,inited:!1,currUserType:"all_user",targetVal:[],currFieldDatas:{},currentAppId:"",inFields:[["media_source","media_source"],["country","country"],["app_version","app_version"]],allTargetOptions:[{label:"counts",value:"counts"},{label:"uniq_users",value:"unqiue users"},{label:"avg_counts_per_user",value:"avg counts per user"},{label:"counts_rate",value:"counts%"}],selectEvent:"",form:{selectApp:void 0,events:[],generalInfo:[],customInfo:[],media_source:[],country:[],app_version:[],rangeDates:[],tableName:""},rules:{selectApp:[{required:!0,message:"请选择App",trigger:"change"}],rangeDates:[{required:!0,message:"请选择日期",trigger:"change"}]},currPageIndex:1,currPageSize:100,currSortField:{},col:[],info:[],totalData:{},colOfTotal:[],selectedEvents:[],editSelectedEventIndex:-1,showSelectEvent:!0,currentEventValue:[],event_value:{},title:"Event Name",index:1,paramsVisible:!1,formDynamic:{items:[{value:[],name:"",index:0}]},allParams:[],allParamsOfEvent:[],currentEventName:{},maxTagCountObj:{},maxTaglengthObj:{},loading:!1,currentOptions:[],filters:[],currentFilters:[],allPerformed:_["c"],allOperator:_["b"],alCondition:["and","or"],allListOfGeneralCondition:_["a"],valueOfEachEvent:[],loaddingOfOption:!1,allOsVersion:[],mediabuyType:[]}},computed:E({},Object(l["d"])({allApps:function(e){return e.event_info_list.allApp},fieldFormaters:function(e){return e.dashboard_field.field_formaters},pageData:function(e){if(!0===this.inited){var t=e.event_info_list.allAnalyseTableDataOfEventInfo,n={page_size:t.page_size,has_next:t.has_next,has_prev:t.has_prev,total_num:t.total_num};return n}}})),methods:E(E({},Object(l["b"])(["getAllAppOfEventInfo","getEventGeneralInfo","getAllEventsOfApp","getEventCustomInfo","getAllCountry","getAllMediaSourceOfApi","getAllMediabuyTypeOfEventInfo","getAllAppversionOfEventInfo","getOSVersionByApp","saveEventInfoData","getEventInfoDetailById","getAnalyseColumnOfEventInfo","getAnalyseDataOfEventInfo","getAnalyseTotalDataOfEventInfo","getEventInfoDownloadUrl","getkeysOfEventInfo","getValueByAppAndEventAndKey"])),{},{handleBack:function(){this.$router.push({name:"event_info_list",params:{}})},handleUserTypeChange:function(){this.onSubmit()},handleSelectApp:function(){this.tmpAllOptions=[],this.event_value={},this.filters=[],this.form.customInfo=[],this.allEvents=[],this.allCustomInfo=[],this.form.app_version=[],this.allAppVersion=[],this.selectEvent="",this.selectedEvents=[],this.editSelectedEventIndex=-1,this.showSelectEvent=!0},onOpenChangeApps:function(){this.getEventName(),this.getAppversion(),this.getAllOSVersion()},getEventName:function(){var e=this;if(this.form.selectApp){var t={app_id:this.form.selectApp};this.eventOptionStatus=!0,this.getAllEventsOfApp(t).then((function(t){var n=t.filter((function(e){return""!==e&&null!==e&&"null"!==e}));n=n.sort((function(e,t){return e.localeCompare(t,"zh-CN")})),e.allEvents=n,e.eventOptionStatus=!1})).catch((function(t){e.eventOptionStatus=!1,e.showError(t)}))}},getAppversion:function(){var e=this;if(this.form.selectApp){var t={app_id:this.form.selectApp};this.versionOptionStatus=!0,this.getAllAppversionOfEventInfo(t).then((function(t){var n=t.filter((function(e){return""!==e&&null!==e&&"null"!==e}));n=n.sort((function(e,t){return e.localeCompare(t,"zh-CN")})),e.allAppVersion=n,e.versionOptionStatus=!1})).catch((function(t){e.versionOptionStatus=!1,e.showError(t)}))}},getAllAppsAndGeneralInfo:function(){var e=this;this.getAllAppOfEventInfo().then((function(e){})).catch((function(t){e.showError(t)})),this.getEventGeneralInfo().then((function(t){var n=t.sort((function(e,t){return e.key.localeCompare(t.key,"zh-CN")}));e.allGeneralInfo=n})).catch((function(t){e.showError(t)}))},showError:function(e){this.$Modal.error({title:"Error",content:e})},getEventAllCustomInfo:function(){var e=this;if(this.form.selectApp&&this.selectedEvents.length>0){var t={app_id:this.form.selectApp,events:this.selectedEvents};this.customOptionStatus=!0,this.getEventCustomInfo(t).then((function(t){var n=t.filter((function(e){return""!==e&&null!==e&&"null"!==e}));n=n.sort((function(e,t){return e.localeCompare(t,"zh-CN")})),e.allCustomInfo=n,e.customOptionStatus=!1})).catch((function(t){e.customOptionStatus=!1,e.showError(t)}))}},focusFun:function(e){1===e?this.getEventName():3===e?this.getEventAllCustomInfo():6===e&&this.getAppversion(),this.mark=1,this.maxTagArr=[1,1,1,1,1,1,1,1],this.maxTagTextArr=[10,10,10,10,10,10,10,10];var t=this;setTimeout((function(){t.maxTagArr.splice(e,0,10),t.maxTagTextArr.splice(e,0,100)}),500)},blurFun:function(){this.mark=0,this.maxTagArr.findIndex((function(e){return 10===e}))>=0&&(this.maxTagArr=[1,1,1,1,1,1,1,1],this.maxTagTextArr=[10,10,10,10,10,10,10,10])},orderTargetData:function(e,t){var n,a=[],i=x(t);try{for(i.s();!(n=i.n()).done;){var r,l=n.value,s=x(e);try{for(s.s();!(r=s.n()).done;){var o=r.value;l===o&&a.push(o)}}catch(c){s.e(c)}finally{s.f()}}}catch(c){i.e(c)}finally{i.f()}return a},onSubmit:function(e){var t=this;delete this.rules["tableName"],this.$refs.ruleForm.validate((function(n){if(!n)return!1;if(t.selectedEvents.length<1)return t.$Message.error("请添加Event!"),!1;if(t.form.generalInfo.length<1&&t.form.customInfo.length<1)return t.$Message.error("Breakdown by的内容至少选择一项"),!1;t.dealAllFiltersData();var a=[];t.allTargetOptions&&t.allTargetOptions.map((function(e,t){a.push(e.label)}));var i={app_id:t.form.selectApp,events:t.dealEvents(t.selectedEvents,2),general_info:t.form.generalInfo,custom_key:t.form.customInfo,target:t.targetVal&&t.targetVal.length>0?t.orderTargetData(t.targetVal,a):a,event_value:t.delEmptyeventValue(t.event_value),filters_new:t.filters};if(t.currFieldDatas=i,1===e)return t.downloadData(1),!1;t.currSortField={},t.currPageIndex=1,t.pageReset=!0,t.status=!0,t.tableLoading=!0,t.getAnalyseColumnOfEventInfo(i).then((function(e){e&&t.getAnalyseData(i);var n=t.getDealCol(e);t.col=t.dealTotalCol(n);var a=JSON.parse(JSON.stringify(e));t.colOfTotal=t.dealTotalCol(t.getDealCol(a)),t.colOfTotal&&t.colOfTotal.map((function(e,t){0===t&&(!e.children||e.children.length<1)&&(e.render=function(e,t){return e("span","合计")})}))})).catch((function(e){t.showError(e)}))}))},dealEvents:function(e,t,n){var a=[];return 1===t?n?e&&e.map((function(e,t){var n=e.lastIndexOf("_");if(n>-1){var i=e.substring(0,n);a.push(i)}})):a=e:2===t&&e&&e.map((function(e,t){var n=e+"_"+t;a.push(n)})),a},getAnalyseData:function(e,t){var n=this,a={rangeDates:this.form.rangeDates},i=E(E({},e),{},{select_date:JSON.parse(Object(c["r"])(a)),user_type:this.currUserType,page:{count:t&&1===t?1:this.currPageIndex,size:this.currPageSize}});Object(c["p"])(this.currSortField)&&(i.sort=Object(c["p"])(this.currSortField)?JSON.parse(Object(c["p"])(this.currSortField)):{});var r=E(E({},i),{},{query_type:"summary"});this.tableLoading=!0,Promise.all([this.getAnalyseDataOfEventInfo(i),this.getAnalyseTotalDataOfEventInfo(r)]).then((function(e){n.info=e[0].data,n.totalData=e[1],n.tableLoading=!1,n.inited=!0})).catch((function(e){n.tableLoading=!1,n.$Modal.error({title:"Error",content:e})}))},getDealCol:function(e,t){var n=this;return e.length>0&&e.map((function(e,a){var i=e.title;if(i="counts"===i?"counts":"uniq_users"===i?"unqiue users":"avg_counts_per_user"===i?"avg counts per user":"counts_rate"===i?"counts%":i,e.children&&e.children.length>0)e.width=180,e.align="center",e.title=i,e.children=n.getDealCol(e.children,1);else{var r=e.key;e.width="app_version"===r||"device_brand"===r||"os_version"===r||"media_source"===r?140:"country"===r||"date"===r?120:"device_model"===r?230:"device_category"===r?160:180,e.title=i,e.sortable="custom";var l=e.key.indexOf("~");if(l>-1){e.width=r.indexOf("avg_counts_per_user")>-1?180:r.indexOf("uniq_users")>-1?150:r.indexOf("counts_rate")>-1?130:100;var s=e.key.substring(l+1,e.key.length),o=n.fieldFormaters[s];o&&(e.render=function(t,n){var a=n.row[e.key]||0===n.row[e.key]?O()(n.row[e.key]).format(o):"-";return t("span",a)})}1!==t&&(e.fixed="left")}})),e},dealTotalCol:function(e){var t=e.filter((function(e){return!e.children>0}));return t.length<1&&e.unshift({fixed:"left",key:"heji",title:"合计",width:180}),e},refreshData:function(){this.onSubmit()},downloadData:function(e){var t=this;if(1===e){this.downloadLoading=!0;var n={rangeDates:this.form.rangeDates},a=E(E({},this.currFieldDatas),{},{select_date:JSON.parse(Object(c["r"])(n)),user_type:this.currUserType});this.getEventInfoDownloadUrl(a).then((function(e){t.downloadLoading=!1;var n=document.createElement("a");n.href=e.url,n.click()})).catch((function(e){t.downloadLoading=!1,t.showError(e)}))}else this.onSubmit(1)},handleSave:function(e){var t=this;this.rules["tableName"]=[{required:!0,message:"Table Name不可以为空",trigger:"blur"}],this.$refs.ruleForm.validate((function(n){if(!n)return!1;if(t.selectedEvents.length<1)return t.$Message.error("请添加Event!"),!1;if(t.form.generalInfo.length<1&&t.form.customInfo.length<1)return t.$Message.error("Breakdown by的内容至少选择一项"),!1;t.dealAllFiltersData();var a={rangeDates:t.form.rangeDates},i={app_id:t.form.selectApp,app_name:t.form.selectApp,events:t.dealEvents(t.selectedEvents,2),general_info:t.form.generalInfo,custom_key:t.form.customInfo,select_date:JSON.parse(Object(c["r"])(a)),table_name:t.form.tableName,filters_new:t.filters,time_type:Object(c["i"])(t.form.rangeDates),event_value:t.delEmptyeventValue(t.event_value),events_new:!0};!e&&t.currentAppId&&(i.id=t.currentAppId),t.btnStatus=!0,t.saveEventInfoData(i).then((function(n){if(n){!e&&n.id&&(t.currentAppId=n.id);var a=i.id?"修改成功!":"保存成功!";t.$Message.success(a),t.saveStatus=!0,t.btnStatus=!1}})).catch((function(e){t.btnStatus=!1,t.$Modal.error({title:"Error",content:e})}))}))},dealAllFilters:function(){var e=this,t=JSON.parse(JSON.stringify(this.filters));this.currentFilters=JSON.parse(JSON.stringify(this.filters)),t&&t.map((function(t,n){e.dealDataByValue(n,1)}))},dealAllFiltersData:function(){var e=this;this.currentFilters=JSON.parse(JSON.stringify(this.filters));var t=JSON.parse(JSON.stringify(this.filters));t&&t.map((function(t,n){t.editStatus&&e.dealDataByValue(n)}))},delEmptyeventValue:function(e){var t={};for(var n in e)e[n]&&"[]"!==e[n]&&(t[n]=e[n]);return t},getdetailOfData:function(e){var t=this;this.loading=!0,this.getEventInfoDetailById(e).then((function(e){setTimeout((function(){t.loading=!1}),100),e&&(t.form.selectApp=e.app_id,t.selectedEvents=t.dealEvents(e.events,1,e.events_new),t.showSelectEvent=!1,t.form.generalInfo=e.general_info,t.form.customInfo=e.custom_key,t.form.customInfo=e.custom_key,t.form.tableName=e.table_name,t.event_value=e.event_value?e.event_value:{},t.filters=e.filters_new?e.filters_new:[],t.form.rangeDates=Object(c["k"])(JSON.stringify(e.select_date)),e.time_type&&(t.form.rangeDates=Object(s["f"])(e.time_type)),e.filters&&e.filters.map((function(e,n){"media_source"===e.field?t.form.media_source=e.value:"country"===e.field?t.form.country=e.value:"app_version"===e.field&&(t.form.app_version=e.value)})),t.getEventName(),t.getAppversion(),t.getAllOSVersion())})).catch((function(e){t.loading=!1,t.showError(e)}))},handleSortChange:function(e,t,n){this.currSortField={key:e.key,order:e.order},this.currPageIndex=1,this.pageReset=!0,this.getAnalyseData(this.currFieldDatas,1)},pageChange:function(e){this.currPageIndex=e,this.getAnalyseData(this.currFieldDatas)},pageSizeChange:function(e){this.pageReset=!0,this.currPageSize=e,this.getAnalyseData(this.currFieldDatas,1)},pageResetFalse:function(){this.pageReset=!1},handleSpan:function(e){e.row,e.column,e.rowIndex;var t=e.columnIndex,n=this.colOfTotal.filter((function(e){return!e.children>0})),a=n.length;if(a>1){if(0===t)return[1,a];if(t>0&&t<a)return[1,0]}},getcountryAndMeida:function(){var e=this;Promise.all([this.getAllCountry(),this.getAllMediaSourceOfApi(),this.getAllMediabuyTypeOfEventInfo()]).then((function(t){var n=[];t[0]&&t[0].map((function(e,t){var a=e.country_name+"("+e.country_id+")";n.push(a)})),e.allCountries=n;var a=t[1];a=a.sort((function(e,t){return e.localeCompare(t,"zh-CN")})),a=a&&a.filter((function(e){return""!==e})),e.allMediaSources=a;var i=t[2];i=i.sort((function(e,t){return e.localeCompare(t,"zh-CN")})),i=i&&i.filter((function(e){return""!==e})),e.mediabuyType=i}))},getAllOSVersion:function(){var e=this;if(this.form.selectApp){var t={app_id:this.form.selectApp};this.getOSVersionByApp(t).then((function(t){var n=t.filter((function(e){return""!==e&&null!==e&&"null"!==e}));n=n.sort((function(e,t){return e.localeCompare(t,"zh-CN")})),e.allOsVersion=n})).catch((function(t){e.showError(t)}))}},handleEditEvent:function(e){this.getEventName(),this.editSelectedEventIndex=e,this.showSelectEvent=!1},handleEditSelectEvent:function(e){this.editSelectedEventIndex=-1},handleCloseEvent:function(e,t){this.selectedEvents=this.selectedEvents.filter((function(t,n,a){return n!==e})),this.form.customInfo=[],this.selectedEvents.length<1&&(this.allCustomInfo=[]);var n=t+"_"+e;delete this.event_value[n];var a={};for(var i in this.event_value)if(i){var r=i.lastIndexOf("_"),l=parseInt(i.substring(r+1,i.length));if(l>e){l-=1;var s=i.substring(0,r)+"_"+l;a[s]=this.event_value[i]}else a[i]=this.event_value[i]}this.event_value=a},handleModuleChange:function(e){for(var t in this.form.customInfo=[],this.event_value){var n=t.lastIndexOf("_"),a=t.substring(n+1,t.length);e===parseInt(a)&&delete this.event_value[t]}},onOpenChangeEvent:function(e){this.getEventName()},handleSelectEvent:function(e){this.selectedEvents.push(e.value),this.selectEvent="",this.showSelectEvent=!1},handleAddEvent:function(){this.editSelectedEventIndex=-1,this.showSelectEvent=!0},onPopperShow:function(e,t){var n=t+"_"+e,a=this.event_value[n];this.currentEventValue=a?JSON.parse(a):[],w()("#poptip_wapper")&&w()("#poptip_wapper").scrollTop(0)},handleEventParams:function(e,t){var n=this;this.editSelectedEventIndex=-1,this.showSelectEvent=!1;var a={app_id:this.form.selectApp,event_name:t},i=this;this.formDynamic.items=[],this.getkeysOfEventInfo(a).then((function(a){if(n.allParamsOfEvent=a,a.length>0){i.title=t,i.currentEventName={event_name:t,key:e},n.allParams=n.getAllKeys(a,t),n.allParams.length>0?i.paramsVisible=!0:i.$Message.error("".concat(t,"没有任何参数"));var r=t+"_"+e;if(i.getParamsLength(r)>0){i.formDynamic.items=[];var l=i.event_value[r]?JSON.parse(i.event_value[r]):[];l&&l.map((function(e,t){i.formDynamic.items.push({value:e.value,name:e.field,index:t})}))}else i.clearForm()}else i.$Message.error("".concat(t,"没有任何参数"))})).catch((function(e){n.showError(e)}))},getAllKeys:function(e,t){var n=[];e&&e.map((function(e,t){e.event_value_key&&"null"!==e.event_value_key&&n.push(e.event_value_key)}));var a=Array.from(new Set(n));return a=a.sort((function(e,t){return e.localeCompare(t,"zh-CN")})),a},getParamsLength:function(e){var t=this.event_value[e]?JSON.parse(this.event_value[e]):[];return t.length>0?t.length:0},clearForm:function(){this.formDynamic.items=[],this.formDynamic.items.push({value:[],name:"",index:0})},changeParamsName:function(e){this.formDynamic.items[e].value=[]},getAllParamsValue:function(e){var t=this,n=this.allParamsOfEvent.filter((function(n){return n.app_id===t.form.selectApp&&n.event_name===t.currentEventName.event_name&&n.event_value_key===e})),a=[];n&&n.map((function(e,t){e.event_value_content&&a.push(e.event_value_content)}));var i=Array.from(new Set(a));return i=_["k"].indexOf(e)>-1?i.sort((function(e,t){return e-t})):i.sort((function(e,t){return e.localeCompare(t,"zh-CN")})),i},maxTagCountfun:function(e){return this.maxTagCountObj&&this.maxTagCountObj[e]?this.maxTagCountObj[e]:1},maxTagTextfun:function(e,t){return this.maxTaglengthObj&&this.maxTaglengthObj[e]?this.maxTaglengthObj[e]:15},paramsFocusFun:function(e){this.mark=1;var t=this;setTimeout((function(){t.maxTagCountObj={},t.maxTagCountObj[e]=100,t.maxTaglengthObj={},t.maxTaglengthObj[e]=100}),500)},paramsBlurFun:function(){for(var e in this.mark=0,this.maxTagCountObj={},this.maxTaglengthObj)this.maxTaglengthObj[e]=15},handleRemove:function(e){this.formDynamic.items=this.formDynamic.items.filter((function(t){return t.index!==e})),this.formDynamic.items&&this.formDynamic.items.map((function(e,t){e.index=t}))},handleAdd:function(){this.index++,this.formDynamic.items.push({value:[],name:"",index:this.formDynamic.items&&this.formDynamic.items.length})},handleAddDimesion:function(){var e=this;this.$refs["formDynamic"].validate((function(t){if(t){var n=e.dealOperateData(e.formDynamic),a=e.currentEventName.event_name+"_"+e.currentEventName.key;e.event_value[a]=n;var i=e;e.setStyleNone(),setTimeout((function(){i.paramsVisible=!1,i.allParamsOfEvent=[]}),0)}}))},dealOperateData:function(e){var t=[];return e.items&&e.items.map((function(e,n){if(e.value&&e.value.length>0){var a={field:e.name,value:e.value,operator:"in"};t.push(a)}})),t?JSON.stringify(t):""},handleCancel:function(e){this.setStyleNone();var t=this;setTimeout((function(){t.paramsVisible=!1,t.allParamsOfEvent=[],t.clearForm()}),0)},setStyleNone:function(){var e=document.getElementsByClassName("ant-select-dropdown");if(e)for(var t=0;t<e.length;t++)e[t].style.display="none";var n=document.getElementsByClassName("ant-select-dropdown");if(n)for(var a=0;a<n.length;a++)n[a].style.display="none"},_expandable:function(){this.width_=document.body.clientWidth},addSearch:function(){var e=this;this.form.selectApp?(this.dealAllFiltersData(),this.filters.length<1?setTimeout((function(){e.filters.push({performed:"",editStatus:!0,editField:"performed"}),e.currentOptions=e.allPerformed}),100):(this.filters.push({condition:"",editStatus:!0,editField:"condition"}),this.currentOptions=this.alCondition)):this.$Message.error("请选选择app")},selectChange:function(e,t,n){var a=this,i=this;if(this.$set(this.filters[e],n,t),"performed"===n)"meet a general condition"===t?(this.currentOptions=this.allListOfGeneralCondition,setTimeout((function(){i.filters[e]["fieldName"]="",i.filters[e]["editField"]="fieldName";var t=["operator","value","valueType"];a.delItemFun(a.filters[e],t)}),100)):(this.currentOptions=this.allEvents,setTimeout((function(){i.filters[e]["eventName"]="",i.filters[e]["editField"]="eventName";var t=["fieldName","operator","value","valueType"];a.delItemFun(a.filters[e],t)}),100));else if("eventName"===n){var r=["fieldName","operator","value","valueType"];this.delItemFun(this.filters[e],r),setTimeout((function(){delete a.filters[e]["editField"]}),100),this.$set(this.filters[e],"editStatus",!1)}else if("condition"===n)if(this.filters[e]["performed"]){var l=["editField","editStatus"];this.delItemFun(this.filters[e],l)}else this.currentOptions=this.allPerformed,setTimeout((function(){i.filters[e]["performed"]="",i.filters[e]["editField"]="performed"}),100);else if("fieldName"===n){if("meet a general condition"===this.filters[e]["performed"])return void this.selectChangeGenaral(e,t,n);this.dealOperator(e),setTimeout((function(){i.filters[e]["operator"]="",i.filters[e]["value"]="",delete i.filters[e]["valueType"],i.filters[e]["editField"]="operator"}),100)}else if("operator"===n){if("meet a general condition"===this.filters[e]["performed"])return void this.selectChangeGenaral(e,t,n);this.getValuesOfevent(e,1)}else"value"===n&&(setTimeout((function(){delete a.filters[e]["editField"]}),100),this.$set(this.filters[e],"editStatus",!1))},dealFiltersData:function(e){var t=this;this.filters&&this.filters.map((function(n,a){if(a!==e){var i=["editField","editStatus"];t.delItemFun(n,i)}}))},dealOperator:function(e){var t=this,n={app_id:this.form.selectApp,event_name:this.filters[e]["eventName"],event_key:this.filters[e]["fieldName"]};this.loaddingOfOption=!0,this.currentOptions=[],this.getValueByAppAndEventAndKey(n).then((function(e){e.flag?t.currentOptions=t.allOperator:t.currentOptions=t.allOperator.filter((function(e){return"contains"===e||"does not contain"===e})),t.loaddingOfOption=!1})).catch((function(e){t.showError(e)}))},getValuesOfevent:function(e,t){var n=this,a=this;this.loaddingOfOption=!0;var i={app_id:this.form.selectApp,event_name:this.filters[e]["eventName"],event_key:this.filters[e]["fieldName"]};this.currentOptions=[],this.getValueByAppAndEventAndKey(i).then((function(i){var r=Array.from(new Set(i.data));if(r=_["k"].indexOf(n.filters[e]["fieldName"])>-1?r.sort((function(e,t){return e-t})):r.sort((function(e,t){return e.localeCompare(t,"zh-CN")})),n.currentOptions=r,n.loaddingOfOption=!1,1===t){var l=n.filters[e]["operator"];setTimeout((function(){"is"===l||"is not"===l?(a.filters[e]["value"]=[],a.filters[e]["valueType"]="select"):(n.$set(a.filters[e],"value",""),a.filters[e]["valueType"]="input"),a.filters[e]["editField"]="value"}),100)}})).catch((function(e){n.loaddingOfOption=!1,n.showError(e)}))},selectChangeGenaral:function(e,t,n){var a=this,i=this;if(this.$set(this.filters[e],n,t),"fieldName"===n)this.currentOptions="device brand"===t||"device model"===t?this.allOperator.filter((function(e){return"contains"===e||"does not contain"===e})):this.allOperator.filter((function(e){return"contains"!==e&&"does not contain"!==e})),setTimeout((function(){i.filters[e]["operator"]="",i.filters[e]["value"]="",delete i.filters[e]["valueType"],i.filters[e]["editField"]="operator"}),100);else if("operator"===n){var r=this.filters[e]["fieldName"];"app version"===r?this.currentOptions=this.allAppVersion:"country"===r?this.currentOptions=this.allCountries:"media source"===r?this.currentOptions=this.allMediaSources:"os version"===r?this.currentOptions=this.allOsVersion:"投放类型"===r&&(this.currentOptions=this.mediabuyType),setTimeout((function(){"is"===t||"is not"===t?(i.filters[e]["value"]=[],i.filters[e]["valueType"]="select"):(a.$set(i.filters[e],"value",""),i.filters[e]["valueType"]="input"),i.filters[e]["editField"]="value"}),100)}},dealDataByValue:function(e,t){if(this.filters[e]["valueType"]&&"input"===this.filters[e]["valueType"])if(this.filters[e]["value"]=this.filters[e]["editStatus"]&&this.$refs.getInputData&&this.$refs.getInputData[0]?this.$refs.getInputData[0].inputModal:this.filters[e]["value"],this.filters[e]["value"]){this.$set(this.filters[e],"editStatus",!1);var n=["editStatus","editField"];this.delItemFun(this.filters[e],n)}else{var a=["editStatus","editField","fieldName","operator","value","valueType"];"meet a general condition"===this.filters[e]["performed"]?this.delSearch(e,t):(this.filters[e]["eventName"]||this.delSearch(e,t),this.delItemFun(this.filters[e],a))}else if(this.filters[e]["value"]=this.filters[e]["editStatus"]&&this.$refs.getMultipleData&&this.$refs.getMultipleData[0]?this.$refs.getMultipleData[0].mulModal:this.filters[e]["value"],!this.filters[e]["value"]||this.filters[e]["value"].length<1)if("meet a general condition"===this.filters[e]["performed"])this.delSearch(e,t);else if(this.filters[e]["eventName"]){var i=["editStatus","editField","fieldName","operator","value","valueType"];this.delItemFun(this.filters[e],i)}else this.delSearch(e,t);else{this.$set(this.filters[e],"editStatus",!1);var r=["editStatus","editField"];this.delItemFun(this.filters[e],r)}},handleClickField:function(e,t){var n=this;if(this.filters&&this.filters.map((function(e,a){var i=["editStatus","editField"];n.delItemFun(n.filters[a],i),a!==t&&n.dealDataByValue(a)})),this.filters[t]["performed"]&&"meet a general condition"===this.filters[t]["performed"])this.handleClickGereralField(e,t);else if(this.$set(this.filters[t],"editStatus",!0),this.$set(this.filters[t],"editField",e),"eventName"===e)this.currentOptions=this.allEvents;else if("performed"===e)this.currentOptions=this.allPerformed;else if("operator"===e)"meet a general condition"!==this.filters[t]["performed"]?this.dealOperator(t):this.currentOptions=this.allOperator;else if("condition"===e)this.currentOptions=this.alCondition;else if("fieldName"===e){this.currentOptions=[];var a={app_id:this.form.selectApp,event_name:this.filters[t]["eventName"]};this.loaddingOfOption=!0,this.getkeysOfEventInfo(a).then((function(e){n.currentOptions=n.getAllKeys(e,"event_value_key"),n.loaddingOfOption=!1})).catch((function(e){n.loaddingOfOption=!1,n.showError(e)}))}else"value"===e&&(this.currentOptions=[],this.filters[t]["valueType"]&&"select"===this.filters[t]["valueType"]&&this.getValuesOfevent(t))},handleClickGereralField:function(e,t){var n=this;if(this.filters&&this.filters.map((function(e,a){var i=["editStatus","editField"];n.delItemFun(n.filters[a],i),a!==t&&n.dealDataByValue(a)})),this.$set(this.filters[t],"editStatus",!0),this.$set(this.filters[t],"editField",e),"condition"===e)this.currentOptions=this.alCondition;else if("performed"===e)this.currentOptions=this.allPerformed;else if("fieldName"===e)this.currentOptions=this.allListOfGeneralCondition;else if("operator"===e){var a=this.filters[t]["fieldName"];this.currentOptions="device brand"===a||"device model"===a?this.allOperator.filter((function(e){return"contains"===e||"does not contain"===e})):this.allOperator.filter((function(e){return"contains"!==e&&"does not contain"!==e}))}else if("value"===e&&this.filters[t]["valueType"]&&"select"===this.filters[t]["valueType"]){this.currentOptions=[];var i=this.filters[t]["fieldName"];"app version"===i?this.currentOptions=this.allAppVersion:"country"===i?this.currentOptions=this.allCountries:"media source"===i?this.currentOptions=this.allMediaSources:"os version"===i?this.currentOptions=this.allOsVersion:"投放类型"===i&&(this.currentOptions=this.mediabuyType)}},saveCondition:function(e){this.dealDataByValue(e)},delItemFun:function(e,t){var n=this;return t&&t.map((function(t,a){"valueType"!==t&&n.$set(e,t,""),t in e&&delete e[t]})),e},addCondition:function(e){var t=this;this.dealAllFilters();var n={app_id:this.form.selectApp,event_name:this.filters[e]["eventName"]};this.getkeysOfEventInfo(n).then((function(n){t.currentOptions=t.getAllKeys(n,"event_value_key"),t.currentOptions.length>0?(t.$set(t.filters[e],"fieldName",""),t.$set(t.filters[e],"editStatus",!0),t.$set(t.filters[e],"editField","fieldName")):(t.$Message.error("该事件无相关参数"),delete t.filters[e]["editField"])}))},delSearch:function(e,t){1===t?(this.currentFilters.splice(e,1),e+1===this.filters.length?this.filters=this.currentFilters:this.currentFilters.length>0&&delete this.currentFilters[0]["condition"]):(this.filters.splice(e,1),this.filters.length>0&&delete this.filters[0]["condition"])}}),mounted:function(){var e=this.$route.query;e&&e.id?(this.currentAppId=e.id,this.saveStatus=!0,this.getdetailOfData(e)):this.currentAppId="",localStorage.removeItem("pathObj"),this.daterangeoption=Object(s["c"])(),this.getAllAppsAndGeneralInfo(),this.getcountryAndMeida(),history.pushState(null,null,document.URL),window.addEventListener("popstate",(function(){history.pushState(null,null,document.URL)})),this._expandable();var t=this;window.onresize=function(){t._expandable()},d["a"].$emit("setOperateState",!1)},created:function(){this.form.rangeDates=Object(s["f"])("1 week")}},I=N,F=Object(v["a"])(I,a,i,!1,null,null,null);t["default"]=F.exports},"9c6c0":function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"g",(function(){return l})),n.d(t,"f",(function(){return s})),n.d(t,"h",(function(){return o})),n.d(t,"i",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"j",(function(){return d})),n.d(t,"c",(function(){return f})),n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return h})),n.d(t,"k",(function(){return m}));var a=n("6612"),i=n.n(a),r=[{id:"today",value:"今天"},{id:"yesterday",value:"昨天"},{id:"day7",value:"最近7天"},{id:"day14",value:"最近14天"},{id:"day30",value:"最近30天"}],l=function(e){var t=[{title:"异常问题",key:"crash_name",render:function(t,n){var a="#"+n.row.crash_num+" "+n.row.crash_name;return t("a",{on:{click:function(){e.clickCrashName(n)}}},a)}},{title:"崩溃设备数",key:"users",width:180},{title:"崩溃次数",key:"crash_count",width:180}];return t},s=function(e){var t=[{title:"Top",key:"top",width:80,render:function(e,t){return e("span",t.index+1)}},{title:"异常问题",key:"crash_name",render:function(t,n){var a="#"+n.row.crash_num+" "+n.row.crash_name;return t("a",{on:{click:function(){e.clickCrashName(n)}}},a)}},{title:"崩溃设备数",key:"crash_users",width:180},{title:"崩溃次数",key:"online_users",width:180},{title:"首次上报时间",key:"first_time",width:180}];return t},o=function(e){var t=[{title:"异常问题",key:"crash_name",render:function(t,n){return t("div",[t("p",[t("a",{on:{click:function(){e.clickCrashName(n)}}},n.row.issue_title)]),t("p",[t("a",{on:{click:function(){e.clickCrashName(n)}}},n.row.issue_subtitle)])])}},{title:"崩溃设备数",key:"users",width:180},{title:"崩溃次数",key:"counts",width:180}];return t},c=function(e){var t=[{title:"Top",key:"top",width:80,render:function(e,t){return e("span",t.index+1)}},{title:"异常问题",key:"crash_name",render:function(t,n){return t("div",[t("p",[t("a",{on:{click:function(){e.clickCrashName(n)}}},n.row.issue_title)]),t("p",[t("a",{on:{click:function(){e.clickCrashName(n)}}},n.row.issue_subtitle)])])}},{title:"崩溃设备数",key:"crash_users",width:180},{title:"崩溃次数",key:"crash_count",width:180},{title:"首次上报时间",key:"first_time",width:180}];return t},u=[{title:"应用版本",key:"appversion",width:120},{title:"首次上报时间",key:"first_time"},{title:"最近上报时间",key:"last_time"},{title:"累计发生次数",key:"total",render:function(e,t){return e("span",i()(t.row.total).format("0,0"))}},{title:"次数占比",key:"rate",render:function(e,t){return e("span",i()(t.row.rate).format("0,0%"))}},{title:"累计影响设备数",key:"devices",render:function(e,t){return e("span",i()(t.row.devices).format("0,0"))}}],d=[{title:"应用版本",key:"app_version",width:120},{title:"首次上报时间",key:"first_time"},{title:"最近上报时间",key:"last_time"},{title:"累计发生次数",key:"total",render:function(e,t){return e("span",i()(t.row.crash_count).format("0,0"))}},{title:"次数占比",key:"rate",render:function(e,t){return e("span",i()(t.row.crash_count_rate).format("0,0%"))}},{title:"累计影响设备数",key:"devices",render:function(e,t){return e("span",i()(t.row.crash_users).format("0,0"))}}],f=["performed an event","did not performed an event","meet a general condition"],p=["is","is not","contains","does not contain"],h=["app version","country","device brand","device model","media source","投放类型","os version"],m=["g_level_id","task_id","item_id","itemid","gemleft","gem_left","af_price","timeline_id","PetRank","Playerlevel","PetLevel","player_level","roomrecipeid"]},a93b:function(e,t,n){"use strict";n("c5cd")},c5cd:function(e,t,n){}}]);