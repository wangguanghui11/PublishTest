(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a3fdcb28"],{"386d":function(e,t,a){"use strict";var r=a("cb7c"),n=a("83a1"),l=a("5f1b");a("214f")("search",1,(function(e,t,a,o){return[function(a){var r=e(this),n=void 0==a?void 0:a[t];return void 0!==n?n.call(a,r):new RegExp(a)[t](String(r))},function(e){var t=o(a,e,this);if(t.done)return t.value;var i=r(e),p=String(this),c=i.lastIndex;n(c,0)||(i.lastIndex=0);var s=l(i,p);return n(i.lastIndex,c)||(i.lastIndex=c),null===s?-1:s.index}]}))},"5c91":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Card",[a("fruit-console-tables",{ref:"tables",attrs:{topadd:"",batchDelete:!1,stripe:"",editable:"",searchable:"","search-place":"top",columns:e.columns,selectData:[{key:"project",value:e.canSelectProject},{key:"app_name",value:e.canSelectApp}],loading:e.loading},on:{"on-add":e.handleAdd,"on-delete":e.handleDelete,"on-batch-delete":e.handleBatchDelete,"on-selection-change":e.handleSelectionChange,"on-search-select-change":e.handleSearchSelectChange},model:{value:e.tableData,callback:function(t){e.tableData=t},expression:"tableData"}}),a("Modal",{attrs:{"footer-hide":!0,width:450},model:{value:e.showWindowBDrawer,callback:function(t){e.showWindowBDrawer=t},expression:"showWindowBDrawer"}},[a("div",{attrs:{slot:"header"},slot:"header"},[a("Icon",{attrs:{type:e.formHeadIcon,size:18}}),a("b",[e._v(" "+e._s(e.formHeaderName))])],1),a("div",{staticStyle:{"margin-right":"30px"}},[a("Form",{ref:"formValidate",attrs:{model:e.formValidate,rules:e.ruleValidate,"label-width":110}},[a("FormItem",{attrs:{label:"项目组",prop:"project"}},[a("Select",{attrs:{placeholder:"Select project",filterable:""},model:{value:e.formValidate.project,callback:function(t){e.$set(e.formValidate,"project",t)},expression:"formValidate.project"}},e._l(e.allProject,(function(t){return a("Option",{key:t,attrs:{value:t}},[e._v(e._s(t))])})),1)],1),a("FormItem",{attrs:{label:"Package Name",prop:"package_name"}},[a("Input",{attrs:{placeholder:"Enter package name"},model:{value:e.formValidate.package_name,callback:function(t){e.$set(e.formValidate,"package_name",t)},expression:"formValidate.package_name"}})],1),a("FormItem",{attrs:{label:"Platform",prop:"platform"}},[a("Select",{attrs:{placeholder:"Select platform"},model:{value:e.formValidate.platform,callback:function(t){e.$set(e.formValidate,"platform",t)},expression:"formValidate.platform"}},e._l(e.allPlatform,(function(t){return a("Option",{key:t,attrs:{value:t}},[e._v(e._s(t))])})),1)],1),a("FormItem",{attrs:{label:"App Name",prop:"app_name"}},[a("Input",{attrs:{placeholder:"Enter app name"},model:{value:e.formValidate.app_name,callback:function(t){e.$set(e.formValidate,"app_name",t)},expression:"formValidate.app_name"}})],1),a("FormItem",{attrs:{label:"App 分类",prop:"app_type"}},[a("Select",{attrs:{placeholder:"Select app type"},model:{value:e.formValidate.app_type,callback:function(t){e.$set(e.formValidate,"app_type",t)},expression:"formValidate.app_type"}},e._l(e.allAppType,(function(t,r){return a("Option",{key:r,attrs:{value:t.id}},[e._v(e._s(t.name))])})),1)],1),a("FormItem",{directives:[{name:"show",rawName:"v-show",value:"ios"===e.formValidate.platform,expression:"formValidate.platform==='ios'"}],attrs:{label:"Bundle ID",prop:"bundle_id"}},[a("Input",{attrs:{placeholder:"示例:id1234567"},model:{value:e.formValidate.bundle_id,callback:function(t){e.$set(e.formValidate,"bundle_id",t)},expression:"formValidate.bundle_id"}})],1),a("FormItem",{staticStyle:{"margin-bottom":"5px"}},[a("Button",{staticStyle:{float:"right","margin-left":"8px"},attrs:{type:"primary"},on:{click:function(t){return e.handleSubmit("formValidate")}}},[e._v("Submit")]),a("Button",{staticStyle:{float:"right"},on:{click:function(t){return e.handleReset("formValidate")}}},[e._v("Reset")])],1)],1)],1)])],1)],1)},n=[],l=(a("8e6e"),a("456d"),a("ac6a"),a("5df3"),a("20d6"),a("386d"),a("7f7f"),a("ade3")),o=a("cd9b"),i=a("7d75"),p=a("7217"),c=a("2f62");function s(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function d(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?s(Object(a),!0).forEach((function(t){Object(l["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var u={name:"app-setting",components:{FruitConsoleTables:o["a"],DragDrawer:i["a"]},data:function(){return{columns:[{title:"序号",key:"id",width:60,render:function(e,t){var a=t?t.index+1:"-";return e("div",a)}},{title:"项目组",key:"project",searchable:!0,isSelect:!0},{title:"App-Name",key:"app_name",searchable:!0,isSelect:!0},{title:"Package-Name",key:"package_name",searchable:!0},{title:"Platform",key:"platform",searchable:!0},{title:"Bundle-ID",key:"bundle_id",searchable:!0},{title:"App-分类",key:"app_type_name",searchable:!0},{title:"Last-updated-date",key:"last_updated_date",width:155},{title:"Operator",key:"operator"}],allProject:[],allPlatform:[],allAppType:[],tableData:[],canSelectProject:[],canSelectApp:[],showWindowBDrawer:!1,showBDrawer3:!1,width1:300,width2:200,placement:!1,draggable:!0,formHeadIcon:"ios-add",formHeaderName:"Add app version",submitAdd:!0,currFormIndex:-1,formValidate:{project:"",package_name:"",platform:"",app_name:"",app_type:"",bundle_id:""},ruleValidate:{project:[{required:!0,message:"Please select the project",trigger:"change"}],package_name:[{required:!0,validator:p["a"],trigger:"blur"}],platform:[{required:!0,message:"Please select the platform",trigger:"change"}],app_name:[{required:!0,message:"The app name cannot be empty",trigger:"blur"}],app_type:[{required:!0,message:"Please select the app type",trigger:"change"}]},selectedRows:[],loading:!0}},methods:d(d({},Object(c["b"])(["getAllPlatform","getAllProject","getAllAppType","getAllApp","postApp","putApp","deleteApp","batchDeleteApp"])),{},{handleAdd:function(){this.$refs["formValidate"].resetFields(),this.formValidate.state=!1,this.formHeadIcon="ios-add",this.formHeaderName="Add app",this.submitAdd=!0,this.showWindowBDrawer=!0},handleSubmit:function(e){var t=this;this.$refs[e].validate((function(e){if(e){if("ios"===t.formValidate.platform){if(-1===t.formValidate.app_name.search("IOS")&&-1===t.formValidate.app_name.search("ios"))return void t.$Modal.error({title:"Error",content:"app name 格式不对 要包含IOS或ios"});if(""===t.formValidate.bundle_id)return void t.$Modal.error({title:"Error",content:"IOS bundle id不能为空"});if(0!==t.formValidate.bundle_id.search("id"))return void t.$Modal.error({title:"Error",content:"Bundle ID 必须以id 开头，如id1234567"})}var a="";"ios"===t.formValidate.platform&&(a=t.formValidate.bundle_id);var r={project:t.formValidate.project,package_name:t.formValidate.package_name,platform:t.formValidate.platform,app_name:t.formValidate.app_name,app_type:t.formValidate.app_type,bundle_id:a};t.submitAdd&&t.postApp({app:r}).then((function(e){e.app_type_name=t.allAppType.filter((function(t){return t.id===e.app_type}))[0].name,t.tableData.push(e),t.showWindowBDrawer=!1,t.canSelectApp.push(e.app_name),t.canSelectProject.findIndex((function(t){return t===e.project}))<0&&t.canSelectProject.push(e.project),t.$Message.success("Add Success!")})).catch((function(e){t.$Modal.error({title:"Error",content:e.message})}))}}))},handleDelete:function(e){var t=this;this.deleteApp({app:e.row}).then((function(e){t.tableData=t.tableData.filter((function(t){return t.app_id!==e.app_id})),t.$Message.success("Delete Success!")})).catch((function(e){t.$Modal.error({title:"Error",content:e.message})}))},handleSelectionChange:function(e){this.selectedRows=e},handleBatchDelete:function(){var e=this;if(this.selectedRows.length>0){var t=this;this.$Modal.confirm({title:"warning",content:"Are you sure to delete the selected?",onOk:function(){t.batchDeleteApp(e.selectedRows).then((function(e){e.map((function(e){t.tableData=t.tableData.filter((function(t){return t.app_id!==e.app_id}))})),t.$Message.success("Batch delete Success!")})).catch((function(e){t.$Modal.error({title:"Error",content:e})}))},onCancel:function(){}})}else this.$Modal.info({title:"Info",content:"You have not chosen"})},handleReset:function(e){this.$refs[e].resetFields(),this.formValidate.state=!1},handleSearchSelectChange:function(e,t){var a=this;if("project"===e)if(this.$refs.tables.clearSearch("app_name"),0===t.length)this.canSelectApp=this.tableData.map((function(e){return e.app_name}));else{this.canSelectApp=[];for(var r=function(e){t.findIndex((function(t){return t===a.tableData[e].project}))>=0&&a.canSelectApp.findIndex((function(t){return t===a.tableData[e].app_name}))<0&&a.canSelectApp.push(a.tableData[e].app_name)},n=0;n<this.tableData.length;++n)r(n)}}}),computed:{placementComputed:function(){return this.placement?"left":"right"}},mounted:function(){var e=this;Promise.all([this.getAllPlatform(),this.getAllProject(),this.getAllAppType(),this.getAllApp()]).then((function(t){e.allPlatform=t[0],e.allProject=t[1],e.allAppType=t[2],e.tableData=t[3],e.tableData.map((function(t){return t.app_type_name=e.allAppType.filter((function(e){return e.id===t.app_type}))[0].name,t})),e.canSelectApp=e.tableData.map((function(e){return e.app_name})),e.canSelectProject=e.allProject.filter((function(t){return e.tableData.findIndex((function(e){return e.project===t}))>=0})),e.loading=!1})),this.$store.state.user.access.indexOf("account_and_authority")>=0&&this.columns.push({title:"Handle",key:"handle",options:["delete"]})}},f=u,m=a("2877"),h=Object(m["a"])(f,r,n,!1,null,null,null);t["default"]=h.exports},7217:function(e,t,a){"use strict";function r(e,t,a){return t?!(t.indexOf(" ")>=0)||a(new Error("不能包含空格")):a(new Error("不能为空"))}a.d(t,"a",(function(){return r}))},"83a1":function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e===1/t:e!=e&&t!=t}}}]);