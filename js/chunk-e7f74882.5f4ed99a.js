(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e7f74882"],{"603e":function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Card",[a("fruit-console-tables",{ref:"tables",attrs:{topadd:"",stripe:"",editable:"",searchable:"",batchDelete:!1,"search-place":"top",columns:t.columns,selectData:[{key:"app_name",value:t.canSelectApp},{key:"network_name",value:t.canSelectNetwork},{key:"ad_type",value:t.canSelectAdType}],loading:t.loading},on:{"on-edit":t.handleEdit,"on-add":t.handleAdd,"on-delete":t.handleDelete,"on-batch-delete":t.handleBatchDelete,"on-selection-change":t.handleSelectionChange},model:{value:t.tableData,callback:function(e){t.tableData=e},expression:"tableData"}}),a("Modal",{attrs:{"footer-hide":!0,width:450},model:{value:t.showWindowBDrawer,callback:function(e){t.showWindowBDrawer=e},expression:"showWindowBDrawer"}},[a("div",{attrs:{slot:"header"},slot:"header"},[a("Icon",{attrs:{type:t.formHeadIcon,size:18}}),a("b",[t._v(" "+t._s(t.formHeaderName))])],1),a("div",{staticStyle:{"margin-right":"30px"}},[a("Form",{ref:"formValidate",attrs:{model:t.formValidate,rules:t.ruleValidate,"label-width":130}},[a("FormItem",{attrs:{label:"App name",prop:"app_id"}},[a("Select",{attrs:{placeholder:"Select app",filterable:"",disabled:!t.submitAdd},on:{"on-change":t.filterRemoteCountryGroup},model:{value:t.formValidate.app_id,callback:function(e){t.$set(t.formValidate,"app_id",e)},expression:"formValidate.app_id"}},t._l(t.allApp,(function(e){return a("Option",{key:e.app_id,attrs:{value:e.app_id}},[t._v(t._s(e.app_name))])})),1)],1),a("FormItem",{attrs:{label:"Network",prop:"network_name"}},[a("Select",{attrs:{placeholder:"Select network",filterable:""},model:{value:t.formValidate.network_name,callback:function(e){t.$set(t.formValidate,"network_name",e)},expression:"formValidate.network_name"}},t._l(t.allNetwork,(function(e){return a("Option",{key:e,attrs:{value:e}},[t._v(t._s(e))])})),1)],1),a("FormItem",{attrs:{label:"Ad Type",prop:"ad_type"}},[a("Select",{attrs:{placeholder:"Select ad type",filterable:"",disabled:!t.submitAdd},model:{value:t.formValidate.ad_type,callback:function(e){t.$set(t.formValidate,"ad_type",e)},expression:"formValidate.ad_type"}},t._l(t.allAdType,(function(e){return a("Option",{key:e,attrs:{value:e}},[t._v(t._s(e))])})),1)],1),a("FormItem",{attrs:{label:"Network Ad ID",prop:"custom_ad_id"}},[a("Input",{attrs:{placeholder:"Enter network ad id"},model:{value:t.formValidate.custom_ad_id,callback:function(e){t.$set(t.formValidate,"custom_ad_id",e)},expression:"formValidate.custom_ad_id"}})],1),a("FormItem",{attrs:{label:"Custom Ad Name",prop:"custom_ad_name"}},[a("Input",{attrs:{placeholder:"Enter custom ad name"},model:{value:t.formValidate.custom_ad_name,callback:function(e){t.$set(t.formValidate,"custom_ad_name",e)},expression:"formValidate.custom_ad_name"}})],1),a("FormItem",{attrs:{label:"Country Group List",prop:"country_group_id_list"}},[a("Select",{attrs:{placeholder:"Select country group",multiple:"",filterable:"",remote:""},model:{value:t.formValidate.country_group_id_list,callback:function(e){t.$set(t.formValidate,"country_group_id_list",e)},expression:"formValidate.country_group_id_list"}},t._l(t.remoteCountryGroup,(function(e){return a("Option",{key:e.country_group_id,attrs:{value:e.country_group_id}},[t._v(t._s(e.country_group_name))])})),1)],1),a("FormItem",{attrs:{label:"Ad Cooldown Time",prop:"ad_cooldown_time"}},[a("Input",{attrs:{placeholder:"Enter ad cooldown time",number:""},model:{value:t.formValidate.ad_cooldown_time,callback:function(e){t.$set(t.formValidate,"ad_cooldown_time",e)},expression:"formValidate.ad_cooldown_time"}})],1),a("FormItem",{attrs:{label:"Factor",prop:"factor"}},[a("Input",{attrs:{placeholder:"E.g. 0.0101",number:""},model:{value:t.formValidate.factor,callback:function(e){t.$set(t.formValidate,"factor",e)},expression:"formValidate.factor"}})],1),a("FormItem",{attrs:{label:"State"}},[a("i-switch",{attrs:{size:"large","true-color":"#13ce66","false-color":"#ff4949"},model:{value:t.formValidate.state,callback:function(e){t.$set(t.formValidate,"state",e)},expression:"formValidate.state"}},[a("span",{attrs:{slot:"open"},slot:"open"},[t._v("Yes")]),a("span",{attrs:{slot:"close"},slot:"close"},[t._v("No")])])],1),a("FormItem",{staticStyle:{"margin-bottom":"5px"}},[a("Button",{staticStyle:{float:"right","margin-left":"8px"},attrs:{type:"primary"},on:{click:function(e){return t.handleSubmit("formValidate")}}},[t._v("Submit")]),a("Button",{staticStyle:{float:"right"},on:{click:function(e){return t.handleReset("formValidate")}}},[t._v("Reset")])],1)],1)],1)])],1)],1)},r=[],l=(a("8e6e"),a("456d"),a("ac6a"),a("5df3"),a("7f7f"),a("2909")),i=a("ade3"),d=(a("c5f6"),a("7cdf"),a("cd9b")),n=a("7d75"),s=a("2f62");function c(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,o)}return a}function u(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?c(Object(a),!0).forEach((function(e){Object(i["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):c(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var p={name:"network-ad",components:{FruitConsoleTables:d["a"],DragDrawer:n["a"]},data:function(){var t=this,e=function(t,e,a){e?Number.isInteger(e)?e<=0?a(new Error("Must be over 0 seconds of cooldown time")):a():a(new Error("Please enter an integer")):a(new Error("Cooldown time cannot be empty"))},a=function(t,e,a){0===e?a(new Error("Must be over 0")):e&&!Number(e)?a(new Error("Please enter an number")):e<0?a(new Error("Must be over 0")):a()};return{columns:[{title:"序号",key:"id",width:60,fixed:"left",render:function(t,e){var a=e?e.index+1:"-";return t("div",a)}},{title:"App-Name",key:"app_name",searchable:!0,isSelect:!0,width:100,fixed:"left"},{title:"Network",key:"network_name",searchable:!0,isSelect:!0,fixed:"left",width:150},{title:"Ad-Type",key:"ad_type",searchable:!0,isSelect:!0,fixed:"left",width:150},{title:"Network-Ad-ID",key:"custom_ad_id",searchable:!0,width:130},{title:"Custom-Ad-Name",key:"custom_ad_name",searchable:!0,width:150},{title:"Country-Group-List",key:"country_grouplist",width:150,render:function(e,a){for(var o=a.row.country_grouplist,r=[],l=0;l<o.length;l++){for(var i="",d=0;d<t.allCountryGroup.length;d++)if(o[l]===t.allCountryGroup[d].country_group_id){i=t.allCountryGroup[d].country_group_name;break}r.push(e("Button",{props:{type:"success",ghost:!0,size:"small"}},[e("Icon",{props:{type:"md-flag",size:16,color:"#FF0000"}}),e("span",i)]))}return e("div",r)}},{title:"Ad_Cooldown_Time",key:"ad_cooldown_time",width:150},{title:"Factor",key:"factor",width:80},{title:"State",key:"state",width:150,render:function(t,e){return t("i-switch",{props:{disabled:!0,value:e.row.state,"true-color":"#13ce66","false-color":"#ff4949"}})}},{title:"Last-updated-date",key:"last_updated_date",width:150},{title:"Operator",key:"operator",width:100},{title:"Handle",key:"handle",options:["edit","delete"],width:100}],allApp:[],allNetwork:[],allAdType:[],allCountryGroup:[],remoteCountryGroup:[],tableData:[],canSelectApp:[],canSelectNetwork:[],canSelectAdType:[],showWindowBDrawer:!1,showBDrawer3:!1,width1:350,placement:!1,draggable:!0,formHeadIcon:"ios-add",formHeaderName:"Add network ad",submitAdd:!0,curr_network_ad_id:"",loadingCountryGroup:!1,formValidate:{app_id:"",app_name:"",network_name:"",ad_type:"",custom_ad_id:"",custom_ad_name:"",country_group_id_list:["all"],ad_cooldown_time:0,factor:null,state:!0},lastAddFormValidate:{is_init:!1},ruleValidate:{app_id:[{required:!0,message:"Please select the app",trigger:"change"}],network_name:[{required:!0,message:"Please select the network",trigger:"change"}],ad_type:[{required:!0,message:"Please select ad type",trigger:"change"}],custom_ad_id:[{required:!0,message:"The network ad id cannot be empty",trigger:"blur"}],custom_ad_name:[{required:!0,message:"The network ad name cannot be empty",trigger:"blur"}],country_group_id_list:[{required:!0,type:"array",message:"The country group list cannot be empty"}],ad_cooldown_time:[{required:!0,validator:e,trigger:"blur"}],factor:[{required:!1,validator:a,trigger:"blur"}]},selectedRows:[],loading:!0}},methods:u(u({},Object(s["b"])(["getAllNetworkAd","postNetworkAd","putNetworkAd","deleteNetworkAd","batchDeleteNetworkAd","getAllNetwork","getAllApp","getAllNetworkAdType","getAllCountryGroup"])),{},{handleAdd:function(){this.$refs["formValidate"].resetFields(),this.formValidate.country_group_id_list=["all"],this.formValidate.state=!0,this.formHeadIcon="ios-add",this.formHeaderName="Add network ad",this.submitAdd=!0,this.showWindowBDrawer=!0,this.lastAddFormValidate.is_init&&(this.formValidate.app_id=this.lastAddFormValidate.app_id,this.formValidate.app_name=this.lastAddFormValidate.app_name,this.formValidate.network_name=this.lastAddFormValidate.network_name,this.formValidate.ad_type=this.lastAddFormValidate.ad_type,this.formValidate.country_group_id_list=this.lastAddFormValidate.country_group_id_list,this.formValidate.ad_cooldown_time=this.lastAddFormValidate.ad_cooldown_time,this.formValidate.factor=parseFloat(this.lastAddFormValidate.factor),isNaN(this.formValidate.factor)&&(this.formValidate.factor=null),this.formValidate.state=this.lastAddFormValidate.state)},handleEdit:function(t){this.$refs["formValidate"].resetFields(),this.curr_network_ad_id=t.row.network_ad_id,this.formValidate.app_id=t.row.app_id,this.formValidate.app_name=t.row.app_name,this.formValidate.network_name=t.row.network_name,this.formValidate.ad_type=t.row.ad_type;var e=Object(l["a"])(t.row.country_grouplist);this.formValidate.country_group_id_list=e,this.formValidate.country_group_id_list.push({}),this.formValidate.country_group_id_list.pop(),this.formValidate.custom_ad_id=t.row.custom_ad_id,this.formValidate.custom_ad_name=t.row.custom_ad_name,this.formValidate.ad_cooldown_time=parseInt(t.row.ad_cooldown_time),this.formValidate.factor=parseFloat(t.row.factor),isNaN(this.formValidate.factor)&&(this.formValidate.factor=null),this.formValidate.state=t.row.state,this.formHeadIcon="ios-create",this.formHeaderName="Update network ad",this.submitAdd=!1,this.showWindowBDrawer=!0,this.remoteCountryGroup=this.allCountryGroup.filter((function(e){return"all"===e.country_group_id||e.app_id===t.row.app_id}))},handleSubmit:function(t){var e=this,a=this;this.$refs[t].validate((function(t){if(t){for(var o=e.formValidate.app_id,r="",l=0;l<e.allApp.length;l++)if(o===e.allApp[l].app_id){r=e.allApp[l].app_name;break}for(var i=[],d=e.formValidate.country_group_id_list,n=0;n<d.length;n++){if("all"===d[n]){i=["all"];break}i.push(d[n])}var s="";a.submitAdd||(s=e.curr_network_ad_id);var c={app_id:o,app_name:r,network_ad_id:s,network_name:e.formValidate.network_name,ad_type:e.formValidate.ad_type,custom_ad_id:e.formValidate.custom_ad_id,custom_ad_name:e.formValidate.custom_ad_name,country_grouplist:i,ad_cooldown_time:e.formValidate.ad_cooldown_time,factor:e.formValidate.factor,state:e.formValidate.state};console.log(c),console.log(e.formValidate.factor),a.submitAdd?e.postNetworkAd({networkAd:c}).then((function(t){e.showWindowBDrawer=!1,e.$Message.success("Add Success!"),e.lastAddFormValidate.app_id=e.formValidate.app_id,e.lastAddFormValidate.app_name=e.formValidate.app_name,e.lastAddFormValidate.network_name=e.formValidate.network_name,e.lastAddFormValidate.ad_type=e.formValidate.ad_type,e.lastAddFormValidate.country_group_id_list=e.formValidate.country_group_id_list,e.lastAddFormValidate.ad_cooldown_time=e.formValidate.ad_cooldown_time,e.lastAddFormValidate.factor=parseFloat(e.formValidate.factor),isNaN(e.formValidate.factor)&&(e.formValidate.factor=null),e.lastAddFormValidate.state=e.formValidate.state,e.lastAddFormValidate.is_init=!0})).catch((function(t){e.$Modal.error({title:"Error",content:t})})):e.putNetworkAd({networkAd:c}).then((function(t){e.tableData=e.tableData.map((function(e){return e.network_ad_id===t.network_ad_id?t:e})),e.tableData.push({}),e.tableData.pop(),e.showWindowBDrawer=!1,e.$Message.success("Update Success!")})).catch((function(t){e.$Modal.error({title:"Error",content:t})})),e.showWindowBDrawer=!1}}))},handleDelete:function(t){var e=this;this.deleteNetworkAd({networkAd:t.row}).then((function(t){e.$Message.success("Delete Success!"),e.tableData=e.tableData.filter((function(e){return e.network_ad_id!==t.network_ad_id}))})).catch((function(t){e.$Modal.error({title:"Error",content:t})}))},handleSelectionChange:function(t){this.selectedRows=t},handleBatchDelete:function(){var t=this;if(this.selectedRows.length>0){var e=this;this.$Modal.confirm({title:"warning",content:"Are you sure to delete the selected?",onOk:function(){e.batchDeleteNetworkAd(t.selectedRows).then((function(t){t.map((function(t){e.tableData=e.tableData.filter((function(e){return e.network_ad_id!==t.network_ad_id}))})),e.$Message.success("Batch delete Success!")})).catch((function(t){e.$Message.error(t)}))},onCancel:function(){}})}else this.$Modal.info({title:"Info",content:"You have not chosen"})},handleReset:function(t){this.$refs[t].resetFields(),this.formValidate.country_group_id_list=[],this.formValidate.state=!1},disableCountryGroup:function(t){return t.app_id!==this.formValidate.app_id},filterRemoteCountryGroup:function(t){this.formValidate.country_group_id_list=["all"],this.remoteCountryGroup=this.allCountryGroup.filter((function(e){return"all"===e.country_group_id||e.app_id===t}))},remoteSearch:function(t){var e=this;void 0===t||null==t||""===t?this.remoteCountryGroup=this.allCountryGroup:(this.loadingCountryGroup=!0,setTimeout((function(){e.loadingCountryGroup=!1,e.remoteCountryGroup=e.allCountryGroup.filter((function(a){return"all"===a.country_group_id||a.country_group_name.toLowerCase().indexOf(t.toLowerCase())>-1&&a.app_id===e.formValidate.app_id}))}),1))}}),computed:{placementComputed:function(){return this.placement?"left":"right"}},mounted:function(){var t=this;this.getAllApp().then((function(e){t.allApp=e,Promise.all([t.getAllNetwork(),t.getAllNetworkAdType(),t.getAllCountryGroup(t.allApp),t.getAllNetworkAd({apps:t.allApp})]).then((function(e){t.allNetwork=e[0].map((function(t){return t.name})),t.allAdType=e[1],t.allCountryGroup=e[2],t.tableData=e[3],t.remoteCountryGroup=t.allCountryGroup,t.canSelectApp=t.allApp.map((function(t){return t.app_name})),t.canSelectNetwork=t.allNetwork,t.canSelectAdType=t.allAdType,t.loading=!1}))}))}},m=p,_=a("2877"),f=Object(_["a"])(m,o,r,!1,null,null,null);e["default"]=f.exports},"7cdf":function(t,e,a){var o=a("5ca1");o(o.S,"Number",{isInteger:a("9c12")})},"9c12":function(t,e,a){var o=a("d3f4"),r=Math.floor;t.exports=function(t){return!o(t)&&isFinite(t)&&r(t)===t}}}]);