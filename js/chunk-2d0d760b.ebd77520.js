(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0d760b"],{"770e":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Card",[a("fruit-console-tables",{ref:"tables",attrs:{topadd:"",editable:"",searchable:"",batchDelete:!1,"search-place":"top",loading:e.loading,columns:e.columns,selectData:[{key:"app_name",value:e.canSelectApp},{key:"project",value:e.canSelectProject}]},on:{"on-add":e.handleAdd,"on-delete":e.handleDelete,"on-search-select-change":e.handleSearchSelectChange},model:{value:e.tableData,callback:function(t){e.tableData=t},expression:"tableData"}}),a("Modal",{attrs:{"footer-hide":!0,width:450},model:{value:e.showWindowBDrawer,callback:function(t){e.showWindowBDrawer=t},expression:"showWindowBDrawer"}},[a("div",{attrs:{slot:"header"},slot:"header"},[a("Icon",{attrs:{type:e.formHeadIcon,size:18}}),a("b",[e._v(" "+e._s(e.formHeaderName))])],1),a("div",{staticStyle:{"margin-right":"30px"}},[a("Form",{ref:"formValidate",attrs:{model:e.formValidate,rules:e.ruleValidate,"label-width":110}},[a("FormItem",{attrs:{label:"项目组",prop:"project"}},[a("Select",{attrs:{placeholder:"Select project",filterable:""},on:{"on-change":function(t){return e.handleSelectChange("project")}},model:{value:e.formValidate.project,callback:function(t){e.$set(e.formValidate,"project",t)},expression:"formValidate.project"}},e._l(e.allProject,(function(t){return a("Option",{key:t,attrs:{value:t}},[e._v(e._s(t))])})),1)],1),a("FormItem",{attrs:{label:"App",prop:"app_id"}},[a("Select",{attrs:{placeholder:"Select app",filterable:""},on:{"on-change":function(t){return e.handleSelectChange("app_name")}},model:{value:e.formValidate.app_id,callback:function(t){e.$set(e.formValidate,"app_id",t)},expression:"formValidate.app_id"}},e._l(e.canSelectAddApp,(function(t){return a("Option",{key:t.app_id,attrs:{value:t.app_id}},[e._v(e._s(t.app_name))])})),1)],1),a("FormItem",{attrs:{label:"Device-Name",prop:"device_name"}},[a("Input",{attrs:{placeholder:"Enter device name"},model:{value:e.formValidate.device_name,callback:function(t){e.$set(e.formValidate,"device_name",t)},expression:"formValidate.device_name"}})],1),a("FormItem",{attrs:{label:"Device-ID",prop:"device_id"}},[a("Input",{attrs:{placeholder:"Enter device id"},model:{value:e.formValidate.device_id,callback:function(t){e.$set(e.formValidate,"device_id",t)},expression:"formValidate.device_id"}})],1),a("FormItem",{staticStyle:{"margin-bottom":"5px"}},[a("Button",{staticStyle:{float:"right","margin-left":"8px"},attrs:{type:"primary"},on:{click:function(t){return e.handleSubmit("formValidate")}}},[e._v("Submit")]),a("Button",{staticStyle:{float:"right"},on:{click:function(t){return e.handleReset("formValidate")}}},[e._v("Reset")])],1)],1)],1)])],1)],1)},l=[],n=(a("8e6e"),a("456d"),a("ac6a"),a("5df3"),a("20d6"),a("7f7f"),a("ade3")),i=a("cd9b"),c=a("7d75"),o=a("2f62");function d(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function p(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?d(Object(a),!0).forEach((function(t){Object(n["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):d(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var s={name:"sdk-testing",components:{FruitConsoleTables:i["a"],DragDrawer:c["a"]},data:function(){return{columns:[{title:"序号",key:"id",width:60,render:function(e,t){var a=t?t.index+1:"-";return e("div",a)}},{title:"项目组",key:"project",searchable:!0,isSelect:!0},{title:"App-Name",key:"app_name",searchable:!0,isSelect:!0},{title:"Device-Name",key:"device_name",searchable:!0},{title:"Device-ID",key:"device_id",searchable:!0},{title:"Last-updated-date",key:"last_updated_date"},{title:"Operator",key:"operator"},{title:"Handle",key:"handle",options:["delete"]}],allProject:[],allApp:[],tableData:[],canSelectProject:[],canSelectApp:[],canSelectAddApp:[],showWindowBDrawer:!1,showBDrawer3:!1,width1:300,width2:200,placement:!1,draggable:!0,formHeadIcon:"ios-add",formHeaderName:"Add test device",submitAdd:!0,currFormIndex:-1,formValidate:{project:"",app_id:"",device_id:"",device_name:""},ruleValidate:{project:[{required:!0,message:"Please select the project",trigger:"change"}],app_id:[{required:!0,message:"Please select the app",trigger:"change"}],device_id:[{required:!0,message:"The device id cannot be empty",trigger:"blur"}],device_name:[{required:!0,message:"The device name cannot be empty",trigger:"blur"}]},selectedRows:[],loading:!0}},methods:p(p({},Object(o["b"])(["getAllProject","getAllApp","getAllSdkTesting","postSdkTesting","deleteSdkTesting"])),{},{handleAdd:function(){this.canSelectAddApp=this.allApp,this.$refs["formValidate"].resetFields(),this.formValidate.state=!1,this.formHeadIcon="ios-add",this.formHeaderName="Add test device",this.submitAdd=!0,this.showWindowBDrawer=!0},handleSubmit:function(e){var t=this;this.$refs[e].validate((function(e){if(e){for(var a=t.formValidate.app_id,r="",l=0;l<t.allApp.length;l++)if(a===t.allApp[l].app_id){r=t.allApp[l].app_name;break}var n={app_name:r,project:t.formValidate.project,app_id:t.formValidate.app_id,device_id:t.formValidate.device_id,device_name:t.formValidate.device_name};t.submitAdd&&t.postSdkTesting({sdkTesting:n}).then((function(e){t.tableData.push(e),t.showWindowBDrawer=!1,t.$Message.success("Add Success!")})).catch((function(e){t.$Modal.error({title:"Error",content:e.message})}))}}))},handleDelete:function(e){var t=this;this.deleteSdkTesting({sdkTesting:e.row}).then((function(e){t.$Message.success("Delete Success!"),t.tableData=t.tableData.filter((function(t){return t.sdk_test_id!==e.sdk_test_id}))})).catch((function(e){t.$Modal.error({title:"Error",content:e.message})}))},handleSearchSelectChange:function(e,t){var a=this;if("project"===e)if(this.$refs.tables.clearSearch("app_name"),0===t.length)this.canSelectApp=this.allApp.map((function(e){return e.app_name}));else{this.canSelectApp=[];for(var r=function(e){t.findIndex((function(t){return t===a.allApp[e].project}))>=0&&a.canSelectApp.findIndex((function(t){return t===a.allApp[e].app_name}))<0&&a.canSelectApp.push(a.allApp[e].app_name)},l=0;l<this.allApp.length;++l)r(l)}},handleReset:function(e){this.$refs[e].resetFields(),this.canSelectAddApp=this.allApp,this.formValidate.state=!1},handleSelectChange:function(e){var t=this;if("project"===e&&this.formValidate.project&&""!==this.formValidate.project)this.canSelectAddApp=this.allApp.filter((function(e){return e.project===t.formValidate.project})).map((function(e){return e})),this.formValidate.app_id="";else if("app_name"===e){var a=this.allApp.findIndex((function(e){return e.app_id===t.formValidate.app_id}));a>=0&&(this.formValidate.project=this.allApp[a].project)}}}),computed:{placementComputed:function(){return this.placement?"left":"right"}},mounted:function(){var e=this;Promise.all([this.getAllProject(),this.getAllApp()]).then((function(t){e.allProject=t[0],e.allApp=t[1],e.canSelectProject=e.allProject.filter((function(t){return e.allApp.findIndex((function(e){return e.project===t}))>=0})),e.canSelectApp=e.allApp.map((function(e){return e.app_name})),e.canSelectAddApp=e.allApp,e.getAllSdkTesting({apps:e.allApp}).then((function(t){e.tableData=t,e.loading=!1}))}))}},f=s,u=a("2877"),m=Object(u["a"])(f,r,l,!1,null,null,null);t["default"]=m.exports}}]);