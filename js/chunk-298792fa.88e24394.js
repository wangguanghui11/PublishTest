(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-298792fa"],{"0873":function(t,a,e){"use strict";e("9cbc")},1176:function(t,a,e){"use strict";e("c059")},"87d4":function(t,a,e){"use strict";e("e59e")},9510:function(t,a,e){"use strict";e.r(a);var r=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("Row",[e("div",[e("Card",{ref:"filter",staticClass:"filter-selection"},[e("div",{staticClass:"appSearch"},[e("a-select",{staticClass:"inline-width",staticStyle:{"font-size":"12px"},attrs:{disabled:t.loadingStatus,mode:"multiple","show-search":"",allowClear:"",filterable:"",showArrow:"",placeholder:"App-全部",optionFilterProp:"children","max-tag-count":this.maxTagArr[0],"max-tag-text-length":this.maxTagTextArr[0],autoClearSearchValue:!1},on:{focus:function(a){return t.focusFun(0)},blur:function(a){return t.blurFun()},mouseenter:function(a){return t.mouseenterFun(0)},mouseleave:function(a){return t.mouseleaveFun()}},scopedSlots:t._u([{key:"dropdownRender",fn:function(a){return e("div",{},[e("v-nodes",{attrs:{vnodes:a}}),e("a-divider",{staticClass:"select-all-divider"}),e("div",{staticClass:"select-all-div",on:{mousedown:function(t){return t.preventDefault()}}},[e("span",{staticClass:"select-all-span"},[t._v(t._s(t.apps.length)+"/"+t._s(t.allApp.length))]),e("Button",{attrs:{type:"primary"},on:{click:function(a){t.apps=t.allApp.map((function(t){return t.app_id}))}}},[t._v("全选")])],1)],1)}}]),model:{value:t.apps,callback:function(a){t.apps=a},expression:"apps"}},t._l(t.allApp,(function(a){return e("a-option",{key:a.app_id,attrs:{value:a.app_id}},[t._v(t._s(a.app_name)+"\n          ")])})),1),e("a-select",{staticClass:"inline-width",staticStyle:{"font-size":"12px"},attrs:{disabled:t.loadingStatus,mode:"multiple","show-search":"",allowClear:"",filterable:"",showArrow:"",placeholder:"国家-全部",optionFilterProp:"children","max-tag-count":this.maxTagArr[1],"max-tag-text-length":this.maxTagTextArr[1],autoClearSearchValue:!1},on:{focus:function(a){return t.focusFun(1)},blur:function(a){return t.blurFun()},mouseenter:function(a){return t.mouseenterFun(1)},mouseleave:function(a){return t.mouseleaveFun()}},scopedSlots:t._u([{key:"dropdownRender",fn:function(a){return e("div",{},[e("v-nodes",{attrs:{vnodes:a}}),e("a-divider",{staticClass:"select-all-divider"}),e("div",{staticClass:"select-all-div",on:{mousedown:function(t){return t.preventDefault()}}},[e("span",{staticClass:"select-all-span"},[t._v(t._s(t.countries.length)+"/"+t._s(t.allCountries.length))]),e("Button",{attrs:{type:"primary"},on:{click:function(a){t.countries=t.allCountries.map((function(t){return t.country_id}))}}},[t._v("全选")])],1)],1)}}]),model:{value:t.countries,callback:function(a){t.countries=a},expression:"countries"}},t._l(t.allCountries,(function(a){return e("a-option",{key:a.country_id,attrs:{value:a.country_id}},[t._v(t._s(a.country_name+"("+a.country_id+")")+"\n          ")])})),1),e("a-select",{staticClass:"inline-width",staticStyle:{"font-size":"12px"},attrs:{disabled:t.loadingStatus,mode:"multiple","show-search":"",allowClear:"",filterable:"",showArrow:"",placeholder:"MediaSource-全部",optionFilterProp:"children","max-tag-count":this.maxTagArr[2],"max-tag-text-length":this.maxTagTextArr[2],autoClearSearchValue:!1},on:{focus:function(a){return t.focusFun(2)},blur:function(a){return t.blurFun()},mouseenter:function(a){return t.mouseenterFun(2)},mouseleave:function(a){return t.mouseleaveFun()}},scopedSlots:t._u([{key:"dropdownRender",fn:function(a){return e("div",{},[e("v-nodes",{attrs:{vnodes:a}}),e("a-divider",{staticClass:"select-all-divider"}),e("div",{staticClass:"select-all-div",on:{mousedown:function(t){return t.preventDefault()}}},[e("span",{staticClass:"select-all-span"},[t._v(t._s(t.mediaSources.length)+"/"+t._s(t.allMediaSources.length))]),e("Button",{attrs:{type:"primary"},on:{click:function(a){t.mediaSources=t.allMediaSources.map((function(t){return t.id}))}}},[t._v("全选")])],1)],1)}}]),model:{value:t.mediaSources,callback:function(a){t.mediaSources=a},expression:"mediaSources"}},t._l(t.allMediaSources,(function(a){return e("a-option",{key:a.id,attrs:{value:a.id}},[t._v(t._s(a.name)+"\n          ")])})),1),e("a-select",{staticClass:"inline-width",staticStyle:{"font-size":"12px"},attrs:{disabled:t.loadingStatus,"show-search":"",filterable:"",showArrow:"",optionFilterProp:"children",autoClearSearchValue:!1},model:{value:t.period,callback:function(a){t.period=a},expression:"period"}},[e("a-option",{attrs:{value:0}},[t._v("Day0")]),e("a-option",{attrs:{value:1}},[t._v("Day1")]),e("a-option",{attrs:{value:2}},[t._v("Day2")]),e("a-option",{attrs:{value:3}},[t._v("Day3")]),e("a-option",{attrs:{value:7}},[t._v("Day7")]),e("a-option",{attrs:{value:14}},[t._v("Day14")]),e("a-option",{attrs:{value:30}},[t._v("Day30")]),e("a-option",{attrs:{value:60}},[t._v("Day60")]),e("a-option",{attrs:{value:90}},[t._v("Day90")]),e("a-option",{attrs:{value:180}},[t._v("Day180")])],1),e("a-select",{staticClass:"inline-width",staticStyle:{"font-size":"12px"},attrs:{disabled:t.loadingStatus,"show-search":"",filterable:"",showArrow:"",optionFilterProp:"children",autoClearSearchValue:!1},model:{value:t.cohortType,callback:function(a){t.cohortType=a},expression:"cohortType"}},[e("a-option",{attrs:{value:"on_the_day"}},[t._v("当日")]),e("a-option",{attrs:{value:"grand_total"}},[t._v("累计")])],1),e("DatePicker",{staticStyle:{width:"280px","margin-right":"16px"},attrs:{disabled:t.loadingStatus,type:"daterange",options:t.daterangeoption,clearable:!1,placement:"bottom-start",placeholder:"选择日期范围"},model:{value:t.rangeDates,callback:function(a){t.rangeDates=a},expression:"rangeDates"}}),e("Button",{staticStyle:{"margin-right":"12px"},attrs:{type:"primary",disabled:t.loadingStatus},on:{click:function(a){return t.refresh()}}},[t._v("Apply Filter")]),e("Checkbox",{staticStyle:{"font-size":"14px",float:"right","margin-top":"8px"},on:{"on-change":t.displayNodeData},model:{value:t.status,callback:function(a){t.status=a},expression:"status"}},[t._v("显示数字标签")])],1),e("div",{staticClass:"optionsContents",attrs:{id:"optionsContent"}},t._l(t.tmpOptions,(function(a){return e("li",{key:a},[t._v(t._s(a))])})),0)])],1),e("div",{staticStyle:{"margin-top":"18px",width:"100%"},attrs:{id:"contentItem"}},[e("div",t._l(t.allAppData,(function(a,r){return e("Row",{key:r,staticClass:"appItem"},[e("chart-group",{attrs:{"each-app-data":a,"field-formaters":t.field_formaters,"known-fields":t.cohort_overview,"select-country":t.countries,"select-mediasource":t.mediaSources,"select-period":t.period,"select-cohort-type":t.cohortType,"check-status":t.checkStatus}})],1)})),1),0===t.allAppData.length?e("Spin",{staticStyle:{height:"90vh",top:"100px"},attrs:{size:"large",fix:""}}):t._e()],1)])},i=[],n=(e("ac4d"),e("8a81"),e("1c4c"),e("6b54"),e("8e6e"),e("456d"),e("7f7f"),e("ac6a"),e("5df3"),e("f400"),e("20d6"),e("55dd"),e("ade3")),s=e("4b65"),o=e("90de"),l=(e("1ef0"),e("2f62")),p=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticStyle:{width:"100%",float:"left"}},[e("Row",[e("div",{staticClass:"appTitle"},[e("Icon",{staticClass:"platformItem",attrs:{type:t.getIconType()}}),e("span",[t._v(t._s(this.eachAppData.app_name))])],1)]),t.showChart()?e("div",t._l(t.eachAppData.charts,(function(a,r){return e("div",{key:r,staticStyle:{position:"relative"}},[e("line-chart",{staticStyle:{width:"33%",border:"1px solid rgb(232, 234, 236)",float:"left",margin:"12px 0.33% 0 0","padding-bottom":"12px"},attrs:{"chart-data":a,"app-id":t.eachAppData.app_id,"app-name":t.eachAppData.app_name,"chart-countries":t.selectCountry,"chart-media-source":t.selectMediasource,"chart-period":t.selectPeriod,"chart-cohort-type":t.selectCohortType,"chart-id":r,"field-formaters":t.fieldFormaters,"known-fields":t.knownFields,"check-status":t.checkStatus}})],1)})),0):t._e(),t.showChart()?t._e():e("div",{staticStyle:{"margin-top":"20px","margin-left":"30px"}},[t._v("暂无数据")])],1)},u=[],h=(e("c5f6"),function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("Row",[e("Col",{attrs:{span:"2"}},[null!=t.getHelp()?e("Poptip",{staticStyle:{"margin-right":"10px"},attrs:{placement:"top",transfer:!0,"word-wrap":"",trigger:"hover"}},[e("div",{staticStyle:{"word-break":"break-all"},attrs:{slot:"content"},slot:"content"},[t._v(t._s(t.getHelp()))]),e("Icon",{attrs:{type:"ios-help-circle-outline",size:18,color:"#2d8cf0"}})],1):t._e()],1),e("Col",{attrs:{span:"22"}},[e("div",{staticClass:"chartTitle"},[t.getTitle().length>0?e("div",[t._v(t._s(t.getTitle()[0]))]):t._e(),2===t.getTitle().length?e("div",[t._v(t._s(t.getTitle()[1]))]):t._e(),t.getTitle().length>2?e("div",[t._v(t._s(t.getTitle()[1])+" "+t._s(t.getTitle()[2]))]):t._e()])])],1),t.showChart()?e("div",{ref:"dom"}):t._e(),0===this.chartData.seriesData.length?e("div",{staticClass:"chartNoData"},[e("span",[t._v("暂无数据")])]):t._e()],1)}),c=[],d=e("313e"),y=e.n(d),f=e("6612"),m=e.n(f);function v(t,a){var e="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=_(t))||a&&t&&"number"===typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,s=!0,o=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return s=t.done,t},e:function(t){o=!0,n=t},f:function(){try{s||null==e.return||e.return()}finally{if(o)throw n}}}}function _(t,a){if(t){if("string"===typeof t)return b(t,a);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?b(t,a):void 0}}function b(t,a){(null==a||a>t.length)&&(a=t.length);for(var e=0,r=new Array(a);e<a;e++)r[e]=t[e];return r}var g={name:"line-chart",props:{chartData:{type:Object,default:function(){return{}}},checkStatus:{type:Boolean,default:function(){return!0}},appId:{type:String,default:""},appName:{type:String,default:""},chartCountries:{type:Array,default:function(){return[]}},chartMediaSource:{type:Array,default:function(){return[]}},chartPeriod:{type:Number,default:function(){return 0}},chartCohortType:{type:String,default:function(){return"on_the_day"}},fieldFormaters:{type:Object,default:function(){return{}}},knownFields:{type:Array,default:function(){return[]}}},data:function(){return{dom:null}},methods:{resize:function(){this.dom.resize()},showChart:function(){return null!=this.chartData.seriesData&&0!==this.chartData.seriesData.length},getHelp:function(){var t,a=this,e="",r=v(this.chartData.headers);try{var i=function(){var r=t.value,i=a.knownFields.filter((function(t){return t.val===r.key}))[0];null!=i.help&&(""!==e&&(e+="\n\n"),e+=i.label+":\n",e+=i.help)};for(r.s();!(t=r.n()).done;)i()}catch(n){r.e(n)}finally{r.f()}return""!==e?e:null},getTitle:function(){var t=this,a=[];return this.chartData&&this.chartData.headers.length>0&&this.chartData.headers.map((function(e,r){if(null==e.show||!0===e.show){var i=t.getTitleName(e.key)+":"+(null==e.value?"":Object(o["j"])(e.value)?"-":Object(o["i"])(e.value)?"":m()(e.value).format(t.fieldFormaters[e.key]));a.push(i)}})),a},getTitleName:function(t){var a=this.knownFields.filter((function(a){return a.val===t}))[0].label,e=["staytime_by_in","staytime_by_au","staytime_by_eu","avimpression_by_in","avimpression_by_au","avimpression_by_eu"];return e.indexOf(t)<0&&(a="日均"+a),a},wrapOption:function(){var t=this,a=this.chartCountries.length>0?"":"AllGEO";this.chartCountries.map((function(e,r){r<5&&(a=a+e+(r===t.chartCountries.length-1?"":"/"))})),a+=this.chartCountries.length>5?"...":"";var e=this.chartMediaSource.length>0?"":"AllMediaSource";this.chartMediaSource.map((function(a,r){r<5&&(e=e+a+(r===t.chartMediaSource.length-1?"":"/"))})),e+=this.chartMediaSource.length>5?"...":"";for(var r="Day"+this.chartPeriod,i="on_the_day"===this.chartCohortType?"当日":"累计",n=this,s=this.chartData.headers&&this.chartData.headers[0]?this.fieldFormaters[this.chartData.headers[0].key]:"",l=this.chartData.headers.length>1&&this.chartData.headers[1]?this.fieldFormaters[this.chartData.headers[1].key]:"",p=this.chartData&&this.chartData.xData?parseInt(this.chartData.xData.length/8):7,u=0;u<this.chartData.seriesData.length;++u){for(var h=0;h<this.chartData.seriesData[u].data.length;++h)this.chartData.seriesData[u].data[h]=Object(o["j"])(this.chartData.seriesData[u].data[h])?"-":Object(o["i"])(this.chartData.seriesData[u].data[h])?"":this.chartData.seriesData[u].data[h];this.chartData.seriesData[u].itemStyle={normal:{label:{show:this.checkStatus,formatter:function(t){return t.dataIndex%(p+1)!==0?"":m()(t.data).format("总收入"===t.seriesName||"总花费"===t.seriesName?l:s)}}}}}var c={animation:!1,tooltip:{trigger:"axis",color:"#ff0000",confine:!0,formatter:function(t){t.sort((function(t,a){return null==t.value?1:null==a.value||t.value>a.value?-1:1}));var o=(t?t[0].name+"<br>":"")+n.appName+"<br>"+a+"<br>"+e+"<br>"+r+"<br>"+i+"<br>";for(var p in t){var u="-"===t[p].value?"-":""===t[p].value?"":m()(t[p].value).format("总收入"===t[p].seriesName||"总花费"===t[p].seriesName?l:s);o+=t[p].marker+t[p].seriesName+": "+u+"<br>"}return o}},legend:{orient:"vertical",x:"center",y:"bottom",type:"scroll",padding:[0,50,0,0],top:"overview"===this.appId?this.chartData.legData.length<4?"85%":"79%":"85%",data:this.chartData&&this.chartData.legData},grid:{top:"5%",left:"3%",right:"30",bottom:"overview"===this.appId?"21%":"15%",containLabel:!0},xAxis:[{type:"category",boundaryGap:!1,axisLabel:{rotate:45,interval:p},data:this.chartData&&this.chartData.xData}],yAxis:[{type:"value",axisLabel:{formatter:function(t){return 0===t?t:m()(t).format(s)}}}],series:this.chartData.seriesData};return""!==l&&l!==s&&(c.yAxis=[{type:"value",axisLabel:{formatter:function(t){return 0===t?t:m()(t).format(l)}}}].concat(c.yAxis)),c},renderChart:function(){if(this.showChart()){var t=this.wrapOption();this.dom=y.a.init(this.$refs.dom),this.dom.setOption(t,!0);var a="overview"===this.appId?500:400;this.dom.resize({height:a}),Object(o["m"])(window,"resize",this.resize)}}},watch:{chartData:{deep:!0,handler:function(t,a){this.renderChart()}},checkStatus:function(t){var a=this;setTimeout((function(){a.renderChart()}),200)}},mounted:function(){this.renderChart()},beforeDestroy:function(){Object(o["l"])(window,"resize",this.resize)}},D=g,w=(e("0873"),e("2877")),A=Object(w["a"])(D,h,c,!1,null,"16f03192",null),C=A.exports;function T(t,a){var e="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=x(t))||a&&t&&"number"===typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,s=!0,o=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return s=t.done,t},e:function(t){o=!0,n=t},f:function(){try{s||null==e.return||e.return()}finally{if(o)throw n}}}}function x(t,a){if(t){if("string"===typeof t)return S(t,a);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?S(t,a):void 0}}function S(t,a){(null==a||a>t.length)&&(a=t.length);for(var e=0,r=new Array(a);e<a;e++)r[e]=t[e];return r}var k={name:"chart-group",components:{LineChart:C},props:{checkStatus:{type:Boolean,default:function(){return!0}},eachAppData:{type:Object,default:function(){return{}}},selectCountry:{type:Array,default:function(){return[]}},selectMediasource:{type:Array,default:function(){return[]}},selectPeriod:{type:Number,default:function(){return 0}},selectCohortType:{type:String,default:function(){return"on_the_day"}},fieldFormaters:{type:Object,default:function(){return{}}},knownFields:{type:Array,default:function(){return[]}}},computed:{},methods:{showChart:function(){var t,a=T(this.eachAppData.charts);try{for(a.s();!(t=a.n()).done;){var e=t.value;if(null!=e.seriesData&&e.seriesData.length>0)return!0}}catch(r){a.e(r)}finally{a.f()}return!1},getIconType:function(){return"android"===this.eachAppData.platform?"logo-android":"ios"===this.eachAppData.platform?"logo-apple":"md-apps"}}},P=k,O=(e("87d4"),Object(w["a"])(P,p,u,!1,null,"4633790d",null)),I=O.exports,j=e("1157"),F=e.n(j),L=e("9839"),M=e("4481");function G(t,a){var e="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=N(t))||a&&t&&"number"===typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,s=!0,o=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return s=t.done,t},e:function(t){o=!0,n=t},f:function(){try{s||null==e.return||e.return()}finally{if(o)throw n}}}}function N(t,a){if(t){if("string"===typeof t)return $(t,a);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?$(t,a):void 0}}function $(t,a){(null==a||a>t.length)&&(a=t.length);for(var e=0,r=new Array(a);e<a;e++)r[e]=t[e];return r}function z(t,a){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);a&&(r=r.filter((function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable}))),e.push.apply(e,r)}return e}function E(t){for(var a=1;a<arguments.length;a++){var e=null!=arguments[a]?arguments[a]:{};a%2?z(Object(e),!0).forEach((function(a){Object(n["a"])(t,a,e[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):z(Object(e)).forEach((function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(e,a))}))}return t}var R={name:"cohort-overview",components:{ChartGroup:I,ASelect:L["d"],AOption:L["d"].Option,VNodes:{functional:!0,render:function(t,a){return a.props.vnodes}}},data:function(){return{apps:[],allApp:[],countries:[],allCountries:[],mediaSources:[],allMediaSources:[],period:0,cohortType:"on_the_day",allAppData:[],checkStatus:!1,inFields:[["apps","app_id"],["countries","country"],["mediaSources","media_source"]],loadingStatus:!0,rangeDates:[],daterangeoption:{},status:!1,maxTagArr:[1,1,1,1],maxTagTextArr:[20,20,20,20],tmpOptions:[],tmpAllOptions:[],mark:0}},computed:E({},Object(l["d"])({field_formaters:function(t){return t.dashboard_field.field_formaters},cohort_overview:function(t){return t.dashboard_field.cohort_overview}})),methods:E(E({},Object(l["b"])(["getAllCountry","getAllOverviewApp","getCohortChartData","getAbroadCohortTableDatas","getAllMediaSource"])),{},{displayNodeData:function(t){this.checkStatus=t},getAllChartDatas:function(){this.period>this.getDayRange()?this.$Message.error("当前所选日期没有Day"+this.period+"的数据"):(this.loadingStatus=!0,this.allAppData=[],1===this.apps.length?this.orderGetAppDatas(0):this.getGeneralData())},orderGetAppDatas:function(t){0===this.apps.length&&t<this.allApp.length?"on_the_day"===this.cohortType?this.getAppOnTheDayData(this.allApp[t].app_id,t):this.getAppGrandTotalData(this.allApp[t].app_id,t):this.apps.length>0&&t<this.apps.length?"on_the_day"===this.cohortType?this.getAppOnTheDayData(this.apps[t],t):this.getAppGrandTotalData(this.apps[t],t):this.loadingStatus=!1},refresh:function(){if(this.apps.length>1){var t=this;this.apps.sort((function(a,e){var r=t.allApp.findIndex((function(t){return t.app_id===a})),i=t.allApp.findIndex((function(t){return t.app_id===e}));return r-i}))}this.getAllChartDatas(),F()("#content-wrapper")&&F()("#content-wrapper").scrollTop(10)},getDayRange:function(){var t=new Date(this.rangeDates[0].getFullYear(),this.rangeDates[0].getMonth(),this.rangeDates[0].getDate()),a=new Date,e=Math.ceil(parseInt((a-t)/864e5)-1);return e},wrapParams:function(t,a,e,r){var i={countries:this.countries,apps:e?this.apps.length>0?this.apps:this.allApp.map((function(t){return t.app_id})):[r],mediaSources:this.mediaSources,rangeDates:this.rangeDates},n={time_range:Object(s["r"])(i),filtering:Object(s["m"])(i,this.inFields),show_type:t,statistic_type:this.cohortType,period:this.period<=30?30:this.period<=60?60:this.period<=90?90:180};return a?n.query_type="summary":(n.group_by=e?JSON.stringify(["date","app_name"]):JSON.stringify(["date"]),n.page=JSON.stringify({count:1,size:1e4}),n.multi_sort=JSON.stringify([{field:"date",order:"ascending"}])),n},wrapGeneralLineData:function(t,a){var e,r=this,i=[],n=G(t.data);try{var s=function(){var t=e.value,a=t.app_name,n=t.date,s=t["day"+r.period],o=[],l=i.findIndex((function(t){return t.key===a}));l>=0?o=i[l].chartLine:i.push({key:a,chartLine:o}),o.push({label:n,val:s})};for(n.s();!(e=n.n()).done;)s()}catch(l){n.e(l)}finally{n.f()}var o=this;return i.sort((function(t,a){var e=o.allApp.findIndex((function(a){return a.app_name===t})),r=o.allApp.findIndex((function(t){return t.app_name===a}));return e-r})),this.getLineData(i,a)},wrapAppLineData:function(t,a,e){for(var r=this,i=[],n=function(e){var n=r.cohort_overview.filter((function(t){return t.val===a[e]}))[0].label,s=[];if(t[e].data.length>0){i.push({key:n,chartLine:s});var o,l=G(t[e].data);try{for(l.s();!(o=l.n()).done;){var p=o.value,u=p.date,h=p["day"+r.period];"cost"===a[e]&&(h=p["cost"]),s.push({label:u,val:h})}}catch(c){l.e(c)}finally{l.f()}}},s=0;s<a.length;++s)n(s);var o=this.getLineData(i,e);return o},getLineData:function(t,a){var e,r={legData:[],seriesData:[],xData:a},i=G(t);try{for(i.s();!(e=i.n()).done;){var n=e.value;r.legData.push(n.key);var s,l=new Map,p=G(n.chartLine);try{for(p.s();!(s=p.n()).done;){var u=s.value;l.set(u.label,u.val)}}catch(m){p.e(m)}finally{p.f()}var h,c=[],d=G(a);try{for(d.s();!(h=d.n()).done;){var y=h.value,f=l.get(y);null!=f?c.push(f):c.push(o["a"])}}catch(m){d.e(m)}finally{d.f()}r.seriesData.push({name:n.key,type:"line",data:c})}}catch(m){i.e(m)}finally{i.f()}return r},getGeneralData:function(){var t=this,a=[this.getAbroadCohortTableDatas(this.wrapParams("roi",!1,!0)),this.getAbroadCohortTableDatas(this.wrapParams("roi",!0,!0)),this.getAbroadCohortTableDatas(this.wrapParams("pay_rate_by_in",!1,!0)),this.getAbroadCohortTableDatas(this.wrapParams("pay_rate_by_in",!0,!0)),this.getAbroadCohortTableDatas(this.wrapParams("on_the_day"===this.cohortType?"staytime_by_au":"staytime_by_in",!1,!0)),this.getAbroadCohortTableDatas(this.wrapParams("on_the_day"===this.cohortType?"staytime_by_au":"staytime_by_in",!0,!0)),this.getAbroadCohortTableDatas(this.wrapParams("sum_arpu",!1,!0)),this.getAbroadCohortTableDatas(this.wrapParams("sum_arpu",!0,!0)),this.getAbroadCohortTableDatas(this.wrapParams("ads_arpu",!1,!0)),this.getAbroadCohortTableDatas(this.wrapParams("ads_arpu",!0,!0)),this.getAbroadCohortTableDatas(this.wrapParams("on_the_day"===this.cohortType?"iap_avg_revenue_by_au":"iap_avg_revenue_by_in",!1,!0)),this.getAbroadCohortTableDatas(this.wrapParams("on_the_day"===this.cohortType?"iap_avg_revenue_by_au":"iap_avg_revenue_by_in",!0,!0)),this.getAbroadCohortTableDatas(this.wrapParams("on_the_day"===this.cohortType?"avimpression_by_au":"avimpression_by_in",!1,!0)),this.getAbroadCohortTableDatas(this.wrapParams("on_the_day"===this.cohortType?"avimpression_by_au":"avimpression_by_in",!0,!0)),this.getAbroadCohortTableDatas(this.wrapParams("ecpm",!1,!0)),this.getAbroadCohortTableDatas(this.wrapParams("ecpm",!0,!0))];"on_the_day"===this.cohortType&&(a.push(this.getAbroadCohortTableDatas(this.wrapParams("retention",!1,!0))),a.push(this.getAbroadCohortTableDatas(this.wrapParams("retention",!0,!0)))),Promise.all(a).then((function(a){var e=[],r=new Date(t.rangeDates[0]),i=new Date(t.rangeDates[1]);new Date-i<864e5&&(i=new Date-864e5);for(var n=r;n<=i;n.setDate(n.getDate()+1))e.push(Object(s["c"])(n));var l=t.wrapGeneralLineData(a[0],e);l.headers=[{key:"roi",value:a[1].data[0]["day"+t.period]}];var p=t.wrapGeneralLineData(a[2],e);p.headers=[{key:"pay_rate_by_in",value:a[3].data[0]["day"+t.period]}];var u=t.wrapGeneralLineData(a[4],e);u.headers=[{key:"on_the_day"===t.cohortType?"staytime_by_au":"staytime_by_in",value:a[5].data[0]["day"+t.period]}];var h=t.wrapGeneralLineData(a[6],e);h.headers=[{key:"sum_arpu",value:a[7].data[0]["day"+t.period]}];var c=t.wrapGeneralLineData(a[8],e);c.headers=[{key:"ads_arpu",value:a[9].data[0]["day"+t.period]}];var d=t.wrapGeneralLineData(a[10],e);d.headers=[{key:"on_the_day"===t.cohortType?"iap_avg_revenue_by_au":"iap_avg_revenue_by_in",value:a[11].data[0]["day"+t.period]}];var y=t.wrapGeneralLineData(a[12],e);y.headers=[{key:"on_the_day"===t.cohortType?"avimpression_by_au":"avimpression_by_in",value:a[13].data[0]["day"+t.period]}];var f=t.wrapGeneralLineData(a[14],e);f.headers=[{key:"ecpm",value:a[15].data[0]["day"+t.period]}];var m={legData:[],seriesData:[],xData:e};m.headers=[{key:"retention",value:o["a"]}],"on_the_day"===t.cohortType&&(m=t.wrapGeneralLineData(a[16],e),m.headers=[{key:"retention",value:a[17].data[0]["day"+t.period]}]),t.allAppData.push({app_id:"overview",app_name:"概览",charts:[l,p,u,h,c,d,y,f,m]}),t.orderGetAppDatas(0)})).catch((function(a){t.loadingStatus=!1,t.$Modal.error({title:"Error",content:a})}))},getAppOnTheDayData:function(t,a){var e=this,r=[this.getAbroadCohortTableDatas(this.wrapParams("roi",!1,!1,t)),this.getAbroadCohortTableDatas(this.wrapParams("roi",!0,!1,t)),this.getAbroadCohortTableDatas(this.wrapParams("sum_revenue",!1,!1,t)),this.getAbroadCohortTableDatas(this.wrapParams("sum_revenue",!0,!1,t)),this.getAbroadCohortTableDatas(this.wrapParams("sum_arpu",!1,!1,t)),this.getAbroadCohortTableDatas(this.wrapParams("sum_arpu",!0,!1,t)),this.getAbroadCohortTableDatas(this.wrapParams("ads_arpu",!1,!1,t)),this.getAbroadCohortTableDatas(this.wrapParams("ads_arpu",!0,!1,t)),this.getAbroadCohortTableDatas(this.wrapParams("iap_avg_revenue_by_au",!1,!1,t)),this.getAbroadCohortTableDatas(this.wrapParams("iap_avg_revenue_by_au",!0,!1,t)),this.getAbroadCohortTableDatas(this.wrapParams("pay_rate_by_in",!1,!1,t)),this.getAbroadCohortTableDatas(this.wrapParams("pay_rate_by_in",!0,!1,t)),this.getAbroadCohortTableDatas(this.wrapParams("avimpression_by_au",!1,!1,t)),this.getAbroadCohortTableDatas(this.wrapParams("avimpression_by_au",!0,!1,t)),this.getAbroadCohortTableDatas(this.wrapParams("avimpression_by_eu",!1,!1,t)),this.getAbroadCohortTableDatas(this.wrapParams("avimpression_by_eu",!0,!1,t)),this.getAbroadCohortTableDatas(this.wrapParams("ecpm",!1,!1,t)),this.getAbroadCohortTableDatas(this.wrapParams("ecpm",!0,!1,t)),this.getAbroadCohortTableDatas(this.wrapParams("staytime_by_au",!1,!1,t)),this.getAbroadCohortTableDatas(this.wrapParams("staytime_by_au",!0,!1,t)),this.getAbroadCohortTableDatas(this.wrapParams("staytime_by_eu",!1,!1,t)),this.getAbroadCohortTableDatas(this.wrapParams("staytime_by_eu",!0,!1,t)),this.getAbroadCohortTableDatas(this.wrapParams("retention",!1,!1,t)),this.getAbroadCohortTableDatas(this.wrapParams("retention",!0,!1,t))];Promise.all(r).then((function(r){var i=[],n=new Date(e.rangeDates[0]),o=new Date(e.rangeDates[1]);new Date-o<864e5&&(o=new Date-864e5);for(var l=n;l<=o;l.setDate(l.getDate()+1))i.push(Object(s["c"])(l));var p=e.wrapAppLineData([r[0],r[2],r[2]],["roi","sum_revenue","cost"],i);r[0].data.length>0?(p.seriesData[0].yAxisIndex=1,null!=p.seriesData[1]&&(p.seriesData[1].yAxisIndex=0),null!=p.seriesData[2]&&(p.seriesData[2].yAxisIndex=0)):(null!=p.seriesData[0]&&(p.seriesData[0].yAxisIndex=0),null!=p.seriesData[1]&&(p.seriesData[1].yAxisIndex=0)),p.headers=[{key:"roi",value:r[1].data[0]["day"+e.period]},{show:!1,key:"sum_revenue",value:r[3].data[0]["day"+e.period]},{show:!1,key:"cost",value:r[3].data[0]["cost"]}];var u=e.wrapAppLineData([r[4],r[6],r[8]],["sum_arpu","ads_arpu","iap_avg_revenue_by_au"],i);u.headers=[{key:"sum_arpu",value:r[5].data[0]["day"+e.period]},{key:"ads_arpu",value:r[7].data[0]["day"+e.period]},{key:"iap_avg_revenue_by_au",value:r[9].data[0]["day"+e.period]}];var h=e.wrapAppLineData([r[10]],["pay_rate_by_in"],i);h.headers=[{key:"pay_rate_by_in",value:r[11].data[0]["day"+e.period]}];var c=e.wrapAppLineData([r[12],r[14]],["avimpression_by_au","avimpression_by_eu"],i);c.headers=[{key:"avimpression_by_au",value:r[13].data[0]["day"+e.period]},{key:"avimpression_by_eu",value:r[15].data[0]["day"+e.period]}];var d=e.wrapAppLineData([r[16]],["ecpm"],i);d.headers=[{key:"ecpm",value:r[17].data[0]["day"+e.period]}];var y=e.wrapAppLineData([r[18],r[20]],["staytime_by_au","staytime_by_eu"],i);y.headers=[{key:"staytime_by_au",value:r[19].data[0]["day"+e.period]},{key:"staytime_by_eu",value:r[21].data[0]["day"+e.period]}];var f=e.wrapAppLineData([r[22]],["retention"],i);f.headers=[{key:"retention",value:r[23].data[0]["day"+e.period]}],e.allAppData.push({app_id:t,app_name:e.allApp.filter((function(a){return a.app_id===t}))[0].app_name,charts:[p,u,h,c,d,y,f]}),e.orderGetAppDatas(a+1)})).catch((function(t){e.loadingStatus=!1,e.$Modal.error({title:"Error",content:t})}))},getAppGrandTotalData:function(t,a){var e=this,r=[this.getAbroadCohortTableDatas(this.wrapParams("roi",!1,!1,t)),this.getAbroadCohortTableDatas(this.wrapParams("roi",!0,!1,t)),this.getAbroadCohortTableDatas(this.wrapParams("sum_revenue",!1,!1,t)),this.getAbroadCohortTableDatas(this.wrapParams("sum_revenue",!0,!1,t)),this.getAbroadCohortTableDatas(this.wrapParams("sum_arpu",!1,!1,t)),this.getAbroadCohortTableDatas(this.wrapParams("sum_arpu",!0,!1,t)),this.getAbroadCohortTableDatas(this.wrapParams("ads_arpu",!1,!1,t)),this.getAbroadCohortTableDatas(this.wrapParams("ads_arpu",!0,!1,t)),this.getAbroadCohortTableDatas(this.wrapParams("iap_avg_revenue_by_in",!1,!1,t)),this.getAbroadCohortTableDatas(this.wrapParams("iap_avg_revenue_by_in",!0,!1,t)),this.getAbroadCohortTableDatas(this.wrapParams("pay_rate_by_in",!1,!1,t)),this.getAbroadCohortTableDatas(this.wrapParams("pay_rate_by_in",!0,!1,t)),this.getAbroadCohortTableDatas(this.wrapParams("avimpression_by_in",!1,!1,t)),this.getAbroadCohortTableDatas(this.wrapParams("avimpression_by_in",!0,!1,t)),this.getAbroadCohortTableDatas(this.wrapParams("ecpm",!1,!1,t)),this.getAbroadCohortTableDatas(this.wrapParams("ecpm",!0,!1,t)),this.getAbroadCohortTableDatas(this.wrapParams("staytime_by_in",!1,!1,t)),this.getAbroadCohortTableDatas(this.wrapParams("staytime_by_in",!0,!1,t))];Promise.all(r).then((function(r){var i=[],n=new Date(e.rangeDates[0]),l=new Date(e.rangeDates[1]);new Date-l<864e5&&(l=new Date-864e5);for(var p=n;p<=l;p.setDate(p.getDate()+1))i.push(Object(s["c"])(p));var u=e.wrapAppLineData([r[0],r[2],r[2]],["roi","sum_revenue","cost"],i);r[0].data.length>0?(u.seriesData[0].yAxisIndex=1,null!=u.seriesData[1]&&(u.seriesData[1].yAxisIndex=0),null!=u.seriesData[2]&&(u.seriesData[2].yAxisIndex=0)):(null!=u.seriesData[0]&&(u.seriesData[0].yAxisIndex=0),null!=u.seriesData[1]&&(u.seriesData[1].yAxisIndex=0)),u.headers=[{key:"roi",value:r[1].data[0]["day"+e.period]},{show:!1,key:"sum_revenue",value:r[3].data[0]["day"+e.period]},{show:!1,key:"cost",value:r[3].data[0]["cost"]}];var h=e.wrapAppLineData([r[4],r[6],r[8]],["sum_arpu","ads_arpu","iap_avg_revenue_by_in"],i);h.headers=[{key:"sum_arpu",value:r[5].data[0]["day"+e.period]},{key:"ads_arpu",value:r[7].data[0]["day"+e.period]},{key:"iap_avg_revenue_by_in",value:r[9].data[0]["day"+e.period]}];var c=e.wrapAppLineData([r[10]],["pay_rate_by_in"],i);c.headers=[{key:"pay_rate_by_in",value:r[11].data[0]["day"+e.period]}];var d=e.wrapAppLineData([r[12]],["avimpression_by_in"],i);d.headers=[{key:"avimpression_by_in",value:r[13].data[0]["day"+e.period]}];var y=e.wrapAppLineData([r[14]],["ecpm"],i);y.headers=[{key:"ecpm",value:r[15].data[0]["day"+e.period]}];var f=e.wrapAppLineData([r[16]],["staytime_by_in"],i);f.headers=[{key:"staytime_by_in",value:r[17].data[0]["day"+e.period]}];var m={legData:[],seriesData:[],xData:i};m.headers=[{key:"retention",value:o["a"]}],e.allAppData.push({app_id:t,app_name:e.allApp.filter((function(a){return a.app_id===t}))[0].app_name,charts:[u,h,c,d,y,f,m]}),e.orderGetAppDatas(a+1)})).catch((function(t){e.loadingStatus=!1,e.$Modal.error({title:"Error",content:t})}))},focusFun:function(t,a){this.mark=1,F()("#optionsContent").length&&F()("#optionsContent").css({display:"none"}),this.maxTagArr=[1,1,1],this.maxTagTextArr=[20,20,20];var e=this;setTimeout((function(){e.maxTagArr.splice(t,0,10),e.maxTagTextArr.splice(t,0,100)}),500)},blurFun:function(){this.mark=0,this.maxTagArr.findIndex((function(t){return 10===t}))>=0&&(this.maxTagArr=[1,1,1],this.maxTagTextArr=[20,20,20]),this.setItemValues()},mouseenterFun:function(t){if(1!==this.mark){this.tmpOptions=this.tmpAllOptions[t];var a=Object(s["g"])(this.$refs["filter"].$el.clientWidth,t),e=document.getElementById("optionsContent");F()("#optionsContent").length&&this.tmpOptions&&this.tmpOptions.length>0&&e&&(F()("#optionsContent").css({display:"block",left:a.left+"px"}),e.style.setProperty("top",a.top+"px","important"))}},mouseleaveFun:function(){this.hideContentItem(),this.setItemValues()},hideContentItem:function(){F()("#optionsContent").length&&F()("#optionsContent").css({display:"none"})},setItemValues:function(){var t=this,a=[];this.apps&&this.apps.map((function(e,r){t.allApp&&t.allApp.map((function(t,r){e===t.app_id&&a.push(t.app_name)}))})),this.tmpAllOptions[0]=a;var e=[];this.countries&&this.countries.map((function(a,r){t.allCountries&&t.allCountries.map((function(t,r){a===t.country_id&&e.push(t.country_name+"("+a+")")}))})),this.tmpAllOptions[1]=e;var r=[];this.mediaSources&&this.mediaSources.map((function(a,e){t.allMediaSources&&t.allMediaSources.map((function(t,e){a===t.id&&r.push(t.name)}))})),this.tmpAllOptions[2]=r},onSelectPageInfo:function(t){var a=JSON.parse(t);this.apps=a.filter.apps,this.countries=a.filter.countries,this.mediaSources=a.filter.mediaSources,this.period=a.filter.period,this.cohortType=a.filter.cohortType,this.rangeDates=a.filter.rangeDates,a.filter.time_type&&(this.rangeDates=Object(o["f"])(a.filter.time_type)),this.status=a.status,this.refresh()},onGetPageInfo:function(t){var a={apps:this.apps,countries:this.countries,mediaSources:this.mediaSources,period:this.period,cohortType:this.cohortType,rangeDates:[Object(s["c"])(this.rangeDates[0]),Object(s["c"])(this.rangeDates[1])],time_type:Object(s["i"])(this.rangeDates)},e=JSON.stringify({filter:a,status:this.status});M["a"].$emit("setPageInfo",t,e)}}),mounted:function(){var t=this;this.daterangeoption=Object(o["b"])(),Promise.all([this.getAllOverviewApp(),this.getAllCountry(),this.getAllMediaSource()]).then((function(a){t.allApp=a[0],t.allCountries=a[1],t.allMediaSources=a[2],t.getAllChartDatas()}));var a=this;M["a"].$on("selectPageInfo",(function(t){a.onSelectPageInfo(t)})),M["a"].$on("getPageInfo",(function(t){a.onGetPageInfo(t)}))},beforeDestroy:function(){M["a"].$off("selectPageInfo"),M["a"].$off("getPageInfo")},watch:{eachAppData:function(t){}},created:function(){this.rangeDates=Object(o["f"])("1 week"),this.rangeDates[0].setTime(this.rangeDates[0].getTime()-864e5),this.rangeDates[1].setTime(this.rangeDates[1].getTime()-864e5)}},V=R,J=(e("1176"),Object(w["a"])(V,r,i,!1,null,"791f8770",null));a["default"]=J.exports},"9cbc":function(t,a,e){},c059:function(t,a,e){},e59e:function(t,a,e){}}]);