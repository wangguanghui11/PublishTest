(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-06d2b8dd"],{"295b":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Row",[a("page-filter",{ref:"pageFilter",attrs:{loading:e.tableLoading},on:{"on-filter-apply":e.onFilterApply}})],1),a("Row",[a("Card",[a("Button",{attrs:{disabled:e.tableLoading,type:"primary"},on:{click:function(t){return e.handleDownload()}}},[e._v("下载")]),a("Button",{staticStyle:{"margin-left":"10px"},attrs:{disabled:e.tableLoading,type:"primary"},on:{click:function(t){return e.handleOpenUpload()}}},[e._v("上传")])],1),a("Card",[a("setting-table",{attrs:{"table-data":e.tableData,"table-loading":e.tableLoading,"page-size-opts":e.pageSizeOpts,"default-page-size":50,"total-num":e.pageData.total_num,"fields-name":"event_setting",haveEdit:!0,haveDelete:this.$store.state.user.access.indexOf("account_and_authority")>=0},on:{"on-delete":e.handleDelete,"on-edit":e.handleEdit,"on-change":e.pageChange,"on-page-size-change":e.pageSizeChange}})],1)],1),a("Modal",{staticClass:"event-setting-download",attrs:{"footer-hide":!0,width:450,title:"下载"},model:{value:e.showDownloadModal,callback:function(t){e.showDownloadModal=t},expression:"showDownloadModal"}},[a("Row",[a("Col",{attrs:{span:"6"}},[a("span",{staticClass:"span"},[e._v("Package-Name")])]),a("Col",[a("a-select",{staticClass:"select",attrs:{placeholder:"Select Package Name",showSearch:"",allowClear:""},on:{change:e.handleDownloadPackageNameChange},model:{value:e.downloadPackageName,callback:function(t){e.downloadPackageName=t},expression:"downloadPackageName"}},e._l(e.allPackageName,(function(t){return a("Option",{key:t,attrs:{value:t}},[e._v(e._s(t))])})),1)],1)],1),a("Row",[a("Col",{attrs:{span:"6"}},[a("span",{staticClass:"span"},[e._v("Platform")])]),a("Col",[a("a-select",{staticClass:"select",attrs:{placeholder:"Select Platform",showSearch:"",allowClear:"",notFoundContent:"请选择Package Name"},on:{change:e.handleDownloadPlatformChange},model:{value:e.downloadPlatform,callback:function(t){e.downloadPlatform=t},expression:"downloadPlatform"}},e._l(e.getPlatforms(),(function(t){return a("Option",{key:t,attrs:{value:t}},[e._v(e._s(t))])})),1)],1)],1),a("Row",[a("Col",{attrs:{span:"6"}},[a("span",{staticClass:"span"},[e._v("EventName")])]),a("Col",[a("a-select",{staticClass:"select",attrs:{placeholder:"Select EventName",mode:"multiple",allowClear:"",showArrow:"","max-tag-count":1,"max-tag-text-length":25,loading:e.DownloadEventNameLoading,notFoundContent:e.DownloadEventNameLoading?"加载中请稍后...":"请选择PackageName和Platform",filterable:""},scopedSlots:e._u([{key:"dropdownRender",fn:function(t){return a("div",{},[a("v-nodes",{attrs:{vnodes:t}}),a("a-divider",{staticClass:"select-all-divider"}),a("div",{staticClass:"select-all-div",on:{mousedown:function(e){return e.preventDefault()}}},[a("span",{staticClass:"select-all-span"},[e._v(e._s(e.downloadEventName.length)+"/"+e._s(e.allDowunloadEventName.length))]),a("Button",{attrs:{type:"primary"},on:{click:function(t){e.downloadEventName=e.allDowunloadEventName}}},[e._v("全选")])],1)],1)}}]),model:{value:e.downloadEventName,callback:function(t){e.downloadEventName=t},expression:"downloadEventName"}},e._l(e.allDowunloadEventName,(function(t){return a("Option",{key:t,attrs:{value:t}},[e._v(e._s(t))])})),1)],1)],1),a("Divider",{staticStyle:{margin:"10px 0"}}),a("div",{staticStyle:{height:"30px"}},[a("Button",{staticStyle:{float:"right"},attrs:{type:"primary"},on:{click:function(t){return e.download()}}},[e._v("下载")])],1)],1),a("Modal",{attrs:{"footer-hide":!0,width:500,title:"上传"},model:{value:e.showUploadModal,callback:function(t){e.showUploadModal=t},expression:"showUploadModal"}},[a("span",[a("div",[e._v("上传数据要求：")]),a("div",[e._v("1. 上传表头需与本页面下载excel格式相同")]),a("div",[e._v("2. 根据AppName确定的某个EventName仅可有唯一含义")]),a("div",[e._v("3. 根据AppName+EventName确定的某个Key仅可有唯一含义")]),a("div",[e._v("4. 根据AppName+EventName+Key确定的某个Value仅可有唯一含义")])]),a("Divider",{staticStyle:{margin:"10px 0"}}),a("div",{staticStyle:{height:"30px"}},[a("Upload",{staticStyle:{float:"right","margin-left":"8px"},attrs:{accept:".xls, .xlsx",action:"","before-upload":e.handleUpload}},[a("Button",{attrs:{type:"primary"}},[e._v("上传")])],1),a("Button",{staticStyle:{float:"right"},on:{click:function(t){return e.handleCloaseUpload()}}},[e._v("取消")])],1)],1),a("Modal",{staticClass:"event-model",attrs:{"footer-hide":!0,width:450},model:{value:e.showWindowBDrawer,callback:function(t){e.showWindowBDrawer=t},expression:"showWindowBDrawer"}},[a("div",{attrs:{slot:"header"},slot:"header"},[a("Icon",{attrs:{type:"ios-create",size:18}}),a("b",[e._v(" Edit Event语义")])],1),a("div",{staticStyle:{"margin-right":"30px"}},[a("Form",{ref:"formValidate",attrs:{model:e.formValidate,"label-width":130}},[a("FormItem",{attrs:{label:"Package-Name",prop:"package_name"}},[a("Span",{staticClass:"span"},[e._v(e._s(e.formValidate.package_name))])],1),a("FormItem",{attrs:{label:"Platform",prop:"platform"}},[a("Span",{staticClass:"span"},[e._v(e._s(e.formValidate.platform))])],1),a("FormItem",{attrs:{label:"App-Name",prop:"app_name"}},[a("Span",{staticClass:"span"},[e._v(e._s(e.formValidate.app_name))])],1),a("FormItem",{attrs:{label:"Event-Name",prop:"event_name"}},[a("Span",{staticClass:"span"},[e._v(e._s(e.formValidate.event_name))])],1),a("FormItem",{attrs:{label:"Event-Name含义",prop:"event_name_mean"}},[a("Input",{attrs:{disabled:""===e.formValidate.event_name,maxlength:"100"},model:{value:e.formValidate.event_name_mean,callback:function(t){e.$set(e.formValidate,"event_name_mean",t)},expression:"formValidate.event_name_mean"}})],1),a("FormItem",{attrs:{label:"Key",prop:"event_key"}},[a("Span",{staticClass:"span"},[e._v(e._s(e.formValidate.event_key))])],1),a("FormItem",{attrs:{label:"Key含义",prop:"event_key_mean"}},[a("Input",{attrs:{disabled:""===e.formValidate.event_key,maxlength:"100"},model:{value:e.formValidate.event_key_mean,callback:function(t){e.$set(e.formValidate,"event_key_mean",t)},expression:"formValidate.event_key_mean"}})],1),a("FormItem",{attrs:{label:"Value",prop:"event_val"}},[a("Span",{staticClass:"span"},[e._v(e._s(e.formValidate.event_val))])],1),a("FormItem",{attrs:{label:"value含义",prop:"event_val_mean"}},[a("Input",{attrs:{disabled:""===e.formValidate.event_val,maxlength:"100"},model:{value:e.formValidate.event_val_mean,callback:function(t){e.$set(e.formValidate,"event_val_mean",t)},expression:"formValidate.event_val_mean"}})],1),a("FormItem",{staticStyle:{"margin-bottom":"5px"}},[a("Button",{staticStyle:{float:"right","margin-left":"8px"},attrs:{type:"primary"},on:{click:function(t){return e.handleEditSubmit()}}},[e._v("Submit")]),a("Button",{staticStyle:{float:"right"},on:{click:function(t){return e.handleReset()}}},[e._v("Reset")])],1)],1)],1)])],1)},l=[],o=(a("8e6e"),a("456d"),a("ac6a"),a("4f7f"),a("5df3"),a("1c4c"),a("ade3")),i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Card",{ref:"filter",staticClass:"filter-selection"},[a("div",[a("a-select",{staticClass:"inline-width",staticStyle:{"font-size":"12px"},attrs:{mode:"multiple",allowClear:"",filterable:"",showArrow:"",autoClearSearchValue:!1,"max-tag-count":this.maxTagArr[0],"max-tag-text-length":this.maxTagTextArr[0],placeholder:"Select 项目组",optionFilterProp:"children"},on:{focus:function(t){return e.focusFun(0)},blur:function(t){return e.blurFun()},mouseenter:function(t){return e.mouseenterFun(0)},mouseleave:function(t){return e.mouseleaveFun()},change:e.projectsChange},scopedSlots:e._u([{key:"dropdownRender",fn:function(t){return a("div",{},[a("v-nodes",{attrs:{vnodes:t}}),a("a-divider",{staticClass:"select-all-divider"}),a("div",{staticClass:"select-all-div",on:{mousedown:function(e){return e.preventDefault()}}},[a("span",{staticClass:"select-all-span"},[e._v(e._s(e.projects.length)+"/"+e._s(e.allProjects.length))]),a("Button",{attrs:{type:"primary"},on:{click:function(t){e.projects=e.allProjects}}},[e._v("全选")])],1)],1)}}]),model:{value:e.projects,callback:function(t){e.projects=t},expression:"projects"}},e._l(e.allProjects,(function(t){return a("Option",{key:t,attrs:{value:t}},[e._v(e._s(t)+"\n      ")])})),1),a("a-select",{staticClass:"inline-width",staticStyle:{"font-size":"12px"},attrs:{mode:"multiple",allowClear:"",filterable:"",showArrow:"",autoClearSearchValue:!1,"max-tag-count":this.maxTagArr[1],"max-tag-text-length":this.maxTagTextArr[1],placeholder:"Select Package-Name",optionFilterProp:"children"},on:{focus:function(t){return e.focusFun(1)},blur:function(t){return e.blurFun()},mouseenter:function(t){return e.mouseenterFun(1)},mouseleave:function(t){return e.mouseleaveFun()},change:e.packageNamesChange},scopedSlots:e._u([{key:"dropdownRender",fn:function(t){return a("div",{},[a("v-nodes",{attrs:{vnodes:t}}),a("a-divider",{staticClass:"select-all-divider"}),a("div",{staticClass:"select-all-div",on:{mousedown:function(e){return e.preventDefault()}}},[a("span",{staticClass:"select-all-span"},[e._v(e._s(e.packageNames.length)+"/"+e._s(e.canSelectAllPackageNames.length))]),a("Button",{attrs:{type:"primary"},on:{click:function(t){e.packageNames=e.canSelectAllPackageNames}}},[e._v("全选")])],1)],1)}}]),model:{value:e.packageNames,callback:function(t){e.packageNames=t},expression:"packageNames"}},e._l(e.canSelectAllPackageNames,(function(t){return a("Option",{key:t,attrs:{value:t}},[e._v(e._s(t)+"\n      ")])})),1),a("a-select",{staticClass:"inline-width",staticStyle:{"font-size":"12px"},attrs:{mode:"multiple",allowClear:"",filterable:"",showArrow:"",autoClearSearchValue:!1,"max-tag-count":this.maxTagArr[2],"max-tag-text-length":this.maxTagTextArr[2],placeholder:"Select Platform",optionFilterProp:"children"},on:{focus:function(t){return e.focusFun(2)},blur:function(t){return e.blurFun()},mouseenter:function(t){return e.mouseenterFun(2)},mouseleave:function(t){return e.mouseleaveFun()},change:e.platformsChange},scopedSlots:e._u([{key:"dropdownRender",fn:function(t){return a("div",{},[a("v-nodes",{attrs:{vnodes:t}}),a("a-divider",{staticClass:"select-all-divider"}),a("div",{staticClass:"select-all-div",on:{mousedown:function(e){return e.preventDefault()}}},[a("span",{staticClass:"select-all-span"},[e._v(e._s(e.platforms.length)+"/"+e._s(e.canSelectAllPlatforms.length))]),a("Button",{attrs:{type:"primary"},on:{click:function(t){e.platforms=e.canSelectAllPlatforms}}},[e._v("全选")])],1)],1)}}]),model:{value:e.platforms,callback:function(t){e.platforms=t},expression:"platforms"}},e._l(e.canSelectAllPlatforms,(function(t){return a("Option",{key:t,attrs:{value:t}},[e._v(e._s(t)+"\n      ")])})),1),a("a-select",{staticClass:"inline-width",staticStyle:{"font-size":"12px"},attrs:{mode:"multiple",allowClear:"",filterable:"",showArrow:"",autoClearSearchValue:!1,"max-tag-count":this.maxTagArr[3],"max-tag-text-length":this.maxTagTextArr[3],placeholder:"Select AppName",optionFilterProp:"children"},on:{focus:function(t){return e.focusFun(3)},blur:function(t){return e.blurFun()},mouseenter:function(t){return e.mouseenterFun(3)},mouseleave:function(t){return e.mouseleaveFun()},change:e.appsChange},scopedSlots:e._u([{key:"dropdownRender",fn:function(t){return a("div",{},[a("v-nodes",{attrs:{vnodes:t}}),a("a-divider",{staticClass:"select-all-divider"}),a("div",{staticClass:"select-all-div",on:{mousedown:function(e){return e.preventDefault()}}},[a("span",{staticClass:"select-all-span"},[e._v(e._s(e.apps.length)+"/"+e._s(e.canSelectAllApp.length))]),a("Button",{attrs:{type:"primary"},on:{click:function(t){e.apps=e.canSelectAllApp.map((function(e){return e.app_id}))}}},[e._v("全选")])],1)],1)}}]),model:{value:e.apps,callback:function(t){e.apps=t},expression:"apps"}},e._l(e.canSelectAllApp,(function(t){return a("Option",{key:t.app_id,attrs:{value:t.app_id}},[e._v(e._s(t.app_name)+"\n      ")])})),1),a("Input",{staticClass:"input-width",attrs:{clearable:"",placeholder:"Input EventName"},model:{value:e.eventName,callback:function(t){e.eventName=t},expression:"eventName"}}),a("Input",{staticClass:"input-width",attrs:{clearable:"",placeholder:"Input Key"},model:{value:e.eventKey,callback:function(t){e.eventKey=t},expression:"eventKey"}}),a("Input",{staticClass:"input-width",attrs:{clearable:"",placeholder:"Input Value"},model:{value:e.eventVal,callback:function(t){e.eventVal=t},expression:"eventVal"}}),a("Button",{staticStyle:{"margin-bottom":"5px"},attrs:{type:"primary",disabled:e.loading},on:{click:e.handleSubmit}},[e._v("搜索")])],1),a("div",{staticClass:"optionsContents",attrs:{id:"optionsContent"}},e._l(e.tmpOptions,(function(t){return a("li",{key:t},[e._v(e._s(t))])})),0)])},r=[],s=(a("55dd"),a("20d6"),a("2f62")),c=a("90de"),p=a("9839"),d=a("4b65"),u=a("1157"),m=a.n(u);function h(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function f(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?h(Object(a),!0).forEach((function(t){Object(o["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):h(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var v={name:"page-filter",components:{ASelect:p["d"],Option:p["d"].Option,VNodes:{functional:!0,render:function(e,t){return t.props.vnodes}}},data:function(){return{projects:[],packageNames:[],platforms:[],apps:[],eventName:"",eventKey:"",eventVal:"",allProjects:[],canSelectAllPackageNames:[],canSelectAllPlatforms:[],canSelectAllApp:[],allApp:[],maxTagArr:[1,1,1,1,1],maxTagTextArr:[20,20,20,20,20],tmpAllOptions:[],tmpOptions:[],mark:0}},props:{loading:{type:Boolean,default:function(){return!1}}},methods:f(f({},Object(s["b"])(["getAllProject","getAllEventApp"])),{},{projectsChange:function(e){var t=this;this.packageNames=[],this.platforms=[],this.apps=[],this.canSelectAllPackageNames=[],this.canSelectAllPlatforms=[],this.canSelectAllApp=[];var a=[].concat(this.projects);0===a.length&&(a=[].concat(this.allProjects)),this.allApp.map((function(e,n){a.findIndex((function(t){return t===e.project}))>=0&&(t.canSelectAllPackageNames.push(e.package_name),t.canSelectAllPlatforms.push(e.platform),t.canSelectAllApp.push(e))})),this.canSelectAllPackageNames=Array.from(new Set(this.canSelectAllPackageNames)),this.canSelectAllPlatforms=Array.from(new Set(this.canSelectAllPlatforms)),this.canSelectAllPackageNames.sort(),this.canSelectAllPlatforms.sort()},packageNamesChange:function(e){var t=this;this.platforms=[],this.apps=[],this.canSelectAllPlatforms=[],this.canSelectAllApp=[];var a=[].concat(this.packageNames);0===a.length&&(a=[].concat(this.canSelectAllPackageNames)),this.allApp.map((function(e,n){a.findIndex((function(t){return t===e.package_name}))>=0&&(t.canSelectAllPlatforms.push(e.platform),t.canSelectAllApp.push(e))})),this.canSelectAllPlatforms=Array.from(new Set(this.canSelectAllPlatforms)),this.canSelectAllPlatforms.sort()},platformsChange:function(e){var t=this;this.apps=[],this.canSelectAllApp=[];var a=[].concat(this.packageNames);0===a.length&&(a=[].concat(this.canSelectAllPackageNames));var n=[].concat(this.platforms);0===n.length&&(n=[].concat(this.canSelectAllPlatforms)),this.allApp.map((function(e,l){n.findIndex((function(t){return t===e.platform}))>=0&&a.findIndex((function(t){return t===e.package_name}))>=0&&t.canSelectAllApp.push(e)}))},appsChange:function(e){},handleSubmit:function(e){var t={project:this.projects,package_name:this.packageNames,platform:this.platforms,app_id:this.apps,event_name:this.eventName,event_key:this.eventKey,event_val:this.eventVal};this.$emit("on-filter-apply",t)},maxTagCountfun:function(e){return this.maxTagCountObj&&this.maxTagCountObj[e]?this.maxTagCountObj[e]:1},focusFun:function(e){this.mark=1,m()("#optionsContent").length&&m()("#optionsContent").css({display:"none"}),this.maxTagArr=[1,1,1,1,1],this.maxTagTextArr=[20,20,20,20,20];var t=this;setTimeout((function(){t.maxTagArr.splice(e,0,10),t.maxTagTextArr.splice(e,0,100)}),500)},blurFun:function(){this.mark=0,this.maxTagArr.findIndex((function(e){return 10===e}))>=0&&(this.maxTagArr=[1,1,1,1,1],this.maxTagTextArr=[20,20,20,20,20]),this.setItemValues()},mouseenterFun:function(e){if(1!==this.mark){this.tmpOptions=this.tmpAllOptions[e];var t=Object(d["g"])(this.$refs["filter"].$el.clientWidth,e),a=document.getElementById("optionsContent");m()("#optionsContent").length&&this.tmpOptions&&this.tmpOptions.length>0&&a&&(m()("#optionsContent").css({display:"block",left:t.left+"px"}),a.style.setProperty("top",t.top+"px","important"))}},mouseleaveFun:function(){this.hideContentItem(),this.setItemValues()},setItemValues:function(){var e=this;this.tmpAllOptions[0]=this.projects,this.tmpAllOptions[1]=this.packageNames,this.tmpAllOptions[2]=this.platforms;var t=[];this.apps&&this.apps.map((function(a,n){e.canSelectAllApp&&e.canSelectAllApp.map((function(e,n){a===e.app_id&&t.push(e.app_name)}))})),this.tmpAllOptions[3]=t},hideContentItem:function(){m()("#optionsContent").length&&m()("#optionsContent").css({display:"none"})}}),mounted:function(){var e=this;this.daterangeoption=Object(c["b"])(),Promise.all([this.getAllProject(),this.getAllEventApp()]).then((function(t){e.allApp=t[1],e.canSelectAllApp=[].concat(e.allApp),e.allProjects=t[0].filter((function(t){return e.allApp.findIndex((function(e){return e.project===t}))>=0})),e.allApp.map((function(t,a){e.canSelectAllPackageNames.push(t.package_name),e.canSelectAllPlatforms.push(t.platform)})),e.canSelectAllPackageNames=Array.from(new Set(e.canSelectAllPackageNames)),e.canSelectAllPackageNames.sort(),e.canSelectAllPlatforms=Array.from(new Set(e.canSelectAllPlatforms)),e.canSelectAllPlatforms.sort()}))},created:function(){this.rangeDates=Object(c["f"])("1 week")}},g=v,_=(a("72bc"),a("2877")),w=Object(_["a"])(g,i,r,!1,null,null,null),b=w.exports,y=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Row",{staticStyle:{"margin-bottom":"5px"}},[a("Table",{staticClass:"event-setting",attrs:{data:e.tableData,columns:e.tableColumns,loading:e.tableLoading,height:e.tableHeight,border:""},on:{"on-delete":e.handleDelete,"on-edit":e.handleEdit}})],1),a("Row",{staticStyle:{"text-align":"center"}},[a("Page",{ref:"tablePages",attrs:{"page-size":e.defaultPageSize,"page-size-opts":e.pageSizeOpts,total:e.totalNum,"show-sizer":"","show-total":"","show-elevator":""},on:{"on-change":e.pageChange,"on-page-size-change":e.pageSizeChange}})],1)],1)},k=[],S=(a("c5f6"),a("ac4d"),a("8a81"),a("7f7f"),a("6b54"),{event_setting:[{label:"Package-Name",val:"package_name",width:250},{label:"Platform",val:"platform",width:90},{label:"App-Name",val:"app_name",width:200},{label:"Event-Name",val:"event_name",width:200},{label:"Event-Name含义",val:"event_name_mean",width:200},{label:"Key",val:"event_key",width:150},{label:"Key含义",val:"event_key_mean",width:200},{label:"Value",val:"event_val",width:150},{label:"Value含义",val:"event_val_mean",width:200},{label:"Updater",val:"update_by",width:120},{label:"Last-updated-date",val:"update_time",width:170}]});function A(e,t){var a="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=P(e))||t&&e&&"number"===typeof e.length){a&&(e=a);var n=0,l=function(){};return{s:l,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:l}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,r=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return i=e.done,e},e:function(e){r=!0,o=e},f:function(){try{i||null==a.return||a.return()}finally{if(r)throw o}}}}function P(e,t){if(e){if("string"===typeof e)return N(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?N(e,t):void 0}}function N(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var x=function(e,t,a,n){var l=[],o=function(t,a){return t("Icon",{props:{type:"ios-create",size:26,color:"#FF9933"},on:{click:function(){e.handleEdit(a)}}})},i=function(t,a){return t("span",[t("Icon",{props:{type:"ios-create",size:26,color:"#FF9933"},on:{click:function(){e.handleEdit(a)}}}),t("Poptip",{props:{placement:"right",confirm:!0,transfer:!0,title:"你确定要删除吗?"},on:{"on-ok":function(){e.handleDelete(a)}}},[t("Icon",{props:{type:"md-trash",size:26,color:"#FF0000"}})])])};if(a){var r=o;n&&(r=i),l.push({title:"Operator",fixed:"left",key:"operator",width:100,align:"center",render:r})}l.push({title:"序号",fixed:"left",type:"index",width:70,align:"center"});var s,c=S[t],p=A(c);try{for(p.s();!(s=p.n()).done;){var d=s.value,u={resizable:!0,title:d["label"],key:d["val"],tooltip:!0,width:d["width"]};l.push(u)}}catch(m){p.e(m)}finally{p.f()}return l},C=(a("ca62"),{name:"SettingTable",props:{tableData:{type:Array,default:function(){return[]}},tableLoading:{type:Boolean,default:function(){return!1}},pageSizeOpts:{type:Array,default:function(){return[50,100,200]}},totalNum:{type:Number,default:function(){return 0}},defaultPageSize:{type:Number,default:function(){return 50}},fieldsName:{type:String,default:function(){return""}},haveEdit:{type:Boolean,default:function(){return!1}},haveDelete:{type:Boolean,default:function(){return!1}}},data:function(){return{tableHeight:"450",tableColumns:[]}},methods:{handleDelete:function(e){this.$emit("on-delete",e)},handleEdit:function(e){this.$emit("on-edit",e)},pageChange:function(e){this.$emit("on-change",e)},pageSizeChange:function(e){this.$emit("on-page-size-change",e)},_expandable:function(){var e=document.body.clientWidth;this.tableHeight=e>1450?"650":"450"}},mounted:function(){this.tableColumns=x(this,this.fieldsName,this.haveEdit,this.haveDelete),this._expandable();var e=this;window.onresize=function(){e._expandable()},history.pushState(null,null,document.URL),window.addEventListener("popstate",(function(){history.pushState(null,null,document.URL)}))}}),E=C,D=Object(_["a"])(E,y,k,!1,null,null,null),O=D.exports;a("60e9");function F(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function j(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?F(Object(a),!0).forEach((function(t){Object(o["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):F(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var V={name:"event-setting",components:{SettingTable:O,PageFilter:b,ASelect:p["d"],Option:p["d"].Option,VNodes:{functional:!0,render:function(e,t){return t.props.vnodes}}},data:function(){return{currFilterApply:{},tableLoading:!0,tableHeight:"450",inFields:["project","app_id","package_name","platform"],likeFields:["event_name","event_key","event_val"],tableColumns:[],currPageSize:50,currPageIndex:1,pageSizeOpts:[20,50],showWindowBDrawer:!1,showUploadModal:!1,uploadPercent:0,showDownloadModal:!1,downloadPackageName:void 0,downloadPlatform:void 0,downloadEventName:[],allDowunloadEventName:[],DownloadEventNameLoading:!1,formValidate:{package_name:"",platform:"",app_name:"",event_name:"",event_name_mean:"",event_key:"",event_key_mean:"",event_val:"",event_val_mean:""}}},computed:j({},Object(s["d"])({allApp:function(e){return e.event_setting.allEventApp},allPackageName:function(e){var t=[];return e.event_setting.allEventApp.map((function(e,a){t.push(e.package_name)})),Array.from(new Set(t))},tableData:function(e){return e.event_setting.allEventData.data},pageData:function(e){var t=e.event_setting.allEventData,a={page_size:t.page_size,has_next:t.has_next,has_prev:t.has_prev,total_num:t.total_num};return a}})),methods:j(j({},Object(s["b"])(["getEventSettingData","putEventSettingData","deleteEventSettingData","getEventSettingEventName","getEventSettingDownloadUrl","postEventFile"])),{},{getPlatforms:function(){var e=this,t=[];return null==this.downloadPackageName||this.allApp.map((function(a,n){a.package_name===e.downloadPackageName&&t.push(a.platform)})),t},handleDownloadPackageNameChange:function(){this.downloadPlatform=void 0,this.downloadEventName=[],this.allDowunloadEventName=[]},handleDownloadPlatformChange:function(){this.downloadEventName=[],this.allDowunloadEventName=[],null!=this.downloadPackageName&&null!=this.downloadPlatform&&this.getDownloadEvent()},getDownloadEvent:function(){var e=this;this.DownloadEventNameLoading=!0,this.getEventSettingEventName({package_name:this.downloadPackageName,platform:this.downloadPlatform}).then((function(t){e.DownloadEventNameLoading=!1,e.allDowunloadEventName=t})).catch((function(t){e.DownloadEventNameLoading=!1,e.showError("加载错误",t)}))},toFiltering:function(){for(var e=[],t=0;t<this.inFields.length;t++)this.currFilterApply[this.inFields[t]]&&this.currFilterApply[this.inFields[t]].length>0&&e.push({field:this.inFields[t],operator:"IN",value:this.currFilterApply[this.inFields[t]]});for(var a=0;a<this.likeFields.length;a++)this.currFilterApply[this.likeFields[a]]&&""!==this.currFilterApply[this.likeFields[a]]&&e.push({field:this.likeFields[a],operator:"LIKE",value:this.currFilterApply[this.likeFields[a]]});return e.length>0?JSON.stringify(e):void 0},onFilterApply:function(e){this.currFilterApply=JSON.parse(JSON.stringify(e)),this.updatePageData()},pageChange:function(e){this.currPageIndex=e,this.updatePageData()},pageSizeChange:function(e){this.currPageSize=e,this.updatePageData()},updatePageData:function(){var e=this;this.tableLoading=!0,this.getEventSettingData(this.wrapTableReqParams()).then((function(t){e.tableLoading=!1})).catch((function(t){e.tableLoading=!1,e.showError("加载错误",t)}))},wrapTableReqParams:function(){var e={page:JSON.stringify({count:this.currPageIndex,size:this.currPageSize}),filtering:this.toFiltering(this.currFilterApply,this.inFields)};return e},handleEdit:function(e){this.formValidate={app_id:e.row.app_id,package_name:e.row.package_name,platform:e.row.platform,app_name:e.row.app_name,event_name:e.row.event_name,event_name_mean:e.row.event_name_mean,event_key:e.row.event_key,event_key_mean:e.row.event_key_mean,event_val:e.row.event_val,event_val_mean:e.row.event_val_mean},this.showWindowBDrawer=!0},handleReset:function(){this.formValidate.event_name_mean="",this.formValidate.event_key_mean="",this.formValidate.event_val_mean=""},handleEditSubmit:function(){var e=this;if(null!=this.formValidate.event_name_mean&&this.formValidate.event_name_mean.length>100)this.showError("error","EventName含义不能超过100");else if(null!=this.formValidate.event_key_mean&&this.formValidate.event_key_mean.length>100)this.showError("error","Key含义不能超过100");else if(null!=this.formValidate.event_val_mean&&this.formValidate.event_val_mean.length>100)this.showError("error","Value含义不能超过100");else{var t={app_id:this.formValidate.app_id,package_name:this.formValidate.package_name,platform:this.formValidate.platform,app_name:this.formValidate.app_name,event_name:this.formValidate.event_name,event_name_mean:this.formValidate.event_name_mean,event_key:this.formValidate.event_key,event_key_mean:this.formValidate.event_key_mean,event_val:this.formValidate.event_val,event_val_mean:this.formValidate.event_val_mean};this.tableLoading=!0,this.showWindowBDrawer=!1,this.putEventSettingData(t).then((function(t){e.tableLoading=!1,e.updatePageData(),e.showSuccess("修改成功","Dashboard的数据将在一个小时后更新")})).catch((function(t){e.tableLoading=!1,e.showError("修改失败",t)}))}},handleDelete:function(e){var t=this;this.tableLoading=!0,this.deleteEventSettingData(e.row.id).then((function(e){t.tableLoading=!1,t.updatePageData(),t.showSuccess("删除成功","Dashboard的数据将在一个小时后更新")})).catch((function(e){t.tableLoading=!1,t.showError("删除失败",e)}))},handleDownload:function(){this.showDownloadModal=!0,this.downloadPackageName=void 0,this.downloadPlatform=void 0,this.downloadEventName=[],this.allDowunloadEventName=[]},download:function(){var e=this;if(null==this.downloadPackageName||null==this.downloadPlatform||0===this.downloadEventName.length){var t="";return t=null==this.downloadPackageName?"请选择PackageName":null==this.downloadPlatform?"请选择Platform":"请选择EventName",void this.$Notice.warning({desc:t})}this.showDownloadModal=!1,this.tableLoading=!0;var a={package_name:this.downloadPackageName,platform:this.downloadPlatform,event_name:this.downloadEventName};this.getEventSettingDownloadUrl(a).then((function(t){e.tableLoading=!1;var a=document.createElement("a");a.href=t.url,a.click()})).catch((function(t){e.tableLoading=!1,e.showError("下载失败",t)}))},handleOpenUpload:function(){this.uploadPercent=0,this.showUploadModal=!0},handleCloaseUpload:function(){this.showUploadModal=!1},handleUpload:function(e){var t=this;this.uploadPercent=0,this.showUploadModal=!1,this.tableLoading=!0;var a=new FormData;return a.append("excelFile",e),this.postEventFile({file:a,progressFun:this.handleProgress}).then((function(e){if(t.tableLoading=!1,e.success&&!0===e.success){var a=0;null!=e.number&&(a=e.number),t.showSuccess("上传成功","成功上传"+a+"条记录，Dashboard的数据将在一个小时后更新"),t.updatePageData()}else t.showError("上传失败",e.msg)})).catch((function(e){t.showError("上传失败",e),t.tableLoading=!1})),!1},handleProgress:function(e){this.uploadPercent=parseInt(e.loaded/e.total*100)},showError:function(e,t){this.$Modal.error({title:e,content:'<div style="word-wrap:break-word">'+t+"</div>"})},showSuccess:function(e,t){this.$Modal.success({title:e,content:t})}}),mounted:function(){this.updatePageData()}},I=V,T=Object(_["a"])(I,n,l,!1,null,"d292e8d8",null);t["default"]=T.exports},"3d09":function(e,t,a){},"60e9":function(e,t,a){},"72bc":function(e,t,a){"use strict";a("3d09")}}]);