(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4926f792"],{"055a":function(t,e,n){"use strict";n("e083")},"0d3a":function(t,e,n){"use strict";n("aaa1")},"32cf":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{directives:[{name:"show",rawName:"v-show",value:!1===t.showMain,expression:"showMain===false"}]},[n("event-funnel-activity-dashboard",{ref:"event_funnel_activity_dashboard",on:{"on-back":t.handleBack}})],1),n("div",{directives:[{name:"show",rawName:"v-show",value:!0===t.showMain,expression:"showMain===true"}]},[n("Card",[n("Button",{attrs:{type:"primary"},on:{click:t.handleCreateFunnel}},[t._v("Create Funnel")])],1),n("Row",{staticStyle:{"margin-top":"5px"}},[n("page-filter",{ref:"pageFilter",attrs:{loading:t.mainTableLoading},on:{"on-filter-apply":t.mainOnFilterApply}})],1),n("Row",{staticStyle:{"margin-top":"5px"}},[n("Card",{attrs:{shadow:""}},[n("table-data",{ref:"table",staticClass:"event_table",attrs:{data:t.mainTableData,"table-loading":t.mainTableLoading,"page-reset":t.mainPageReset,"page-data":t.mainPageData,"field-formaters":t.field_formaters,"known-fields":t.event_funnel_activity,dimensions:t.mainKnownDimensions,metrics:t.mainKnownMetrics,"default-dimensions":t.mainKnownDimensions,"all-dimensions":t.mainAllDimensions,"all-metrics":t.mainAllMetrics,"have-index":!0,"have-dimension":!1,"have-total":!1,"page-rooter":"eventFunnelActivity"},on:{"on-delete":t.handleDelete,"on-sort-change":t.mainHandleSortChange,"on-page-change":t.mainPageChange,"on-page-size-change":t.mainPageSizeChange,"on-page-reset-true":t.mainPageResetFalse,"on-click-cell":t.onClickCell}})],1)],1)],1)])},i=[],r=(n("8e6e"),n("456d"),n("ac6a"),n("5df3"),n("ade3")),s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("Card",{ref:"filter",staticClass:"filter-selection"},[n("div",[n("a-select",{staticClass:"inline-width",staticStyle:{"font-size":"12px"},attrs:{mode:"multiple",allowClear:"",filterable:"",showArrow:"",autoClearSearchValue:!1,"max-tag-count":this.maxTagArr[0],"max-tag-text-length":this.maxTagTextArr[0],placeholder:"项目组-全部",optionFilterProp:"children"},on:{focus:function(e){return t.focusFun(0)},blur:function(e){return t.blurFun()},change:t.projectChange,mouseenter:function(e){return t.mouseenterFun(0)},mouseleave:function(e){return t.mouseleaveFun()}},scopedSlots:t._u([{key:"dropdownRender",fn:function(e){return n("div",{},[n("v-nodes",{attrs:{vnodes:e}}),n("a-divider",{staticClass:"select-all-divider"}),n("div",{staticClass:"select-all-div",on:{mousedown:function(t){return t.preventDefault()}}},[n("span",{staticClass:"select-all-span"},[t._v(t._s(t.projects.length)+"/"+t._s(t.allProjects.length))]),n("Button",{attrs:{type:"primary"},on:{click:function(e){t.projects=t.allProjects}}},[t._v("全选")])],1)],1)}}]),model:{value:t.projects,callback:function(e){t.projects=e},expression:"projects"}},t._l(t.allProjects,(function(e){return n("Option",{key:e,attrs:{value:e}},[t._v(t._s(e))])})),1),n("a-select",{staticClass:"inline-width",staticStyle:{"font-size":"12px"},attrs:{mode:"multiple",allowClear:"",filterable:"",showArrow:"",autoClearSearchValue:!1,"max-tag-count":this.maxTagArr[1],"max-tag-text-length":this.maxTagTextArr[1],placeholder:"App-全部",optionFilterProp:"children"},on:{focus:function(e){return t.focusFun(1)},blur:function(e){return t.blurFun()},mouseenter:function(e){return t.mouseenterFun(1)},mouseleave:function(e){return t.mouseleaveFun()}},scopedSlots:t._u([{key:"dropdownRender",fn:function(e){return n("div",{},[n("v-nodes",{attrs:{vnodes:e}}),n("a-divider",{staticClass:"select-all-divider"}),n("div",{staticClass:"select-all-div",on:{mousedown:function(t){return t.preventDefault()}}},[n("span",{staticClass:"select-all-span"},[t._v(t._s(t.apps.length)+"/"+t._s(t.canSelectAllApp.length))]),n("Button",{attrs:{type:"primary"},on:{click:function(e){t.apps=t.canSelectAllApp.map((function(t){return t.app_id}))}}},[t._v("全选")])],1)],1)}}]),model:{value:t.apps,callback:function(e){t.apps=e},expression:"apps"}},t._l(t.canSelectAllApp,(function(e){return n("Option",{key:e.app_id,attrs:{value:e.app_id}},[t._v(t._s(e.app_name)+"\n      ")])})),1),n("Input",{staticStyle:{width:"280px","margin-right":"2px","margin-bottom":"3px"},attrs:{placeholder:"input funnel name",clearable:""},model:{value:t.funnel_name,callback:function(e){t.funnel_name=e},expression:"funnel_name"}}),n("Input",{staticStyle:{width:"280px","margin-right":"2px","margin-bottom":"3px"},attrs:{placeholder:"input creator",clearable:""},model:{value:t.creator,callback:function(e){t.creator=e},expression:"creator"}}),n("Button",{staticStyle:{"margin-bottom":"3px"},attrs:{type:"primary",disabled:t.loading},on:{click:t.handleSubmit}},[t._v("Apply Filter")])],1),n("div",{staticClass:"optionsContents",attrs:{id:"optionsContent"}},t._l(t.tmpOptions,(function(e){return n("li",{key:e},[t._v(t._s(e))])})),0)])},l=[],o=(n("20d6"),n("2f62")),c=n("9839"),u=(n("1ef0"),n("4b65")),p=n("1157"),h=n.n(p);function d(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function f(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?d(Object(n),!0).forEach((function(e){Object(r["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var v={name:"page-filter",components:{ASelect:c["d"],Option:c["d"].Option,VNodes:{functional:!0,render:function(t,e){return e.props.vnodes}}},data:function(){return{projects:[],apps:[],allProjects:[],allApp:[],canSelectAllApp:[],funnel_name:"",creator:"",maxTagArr:[1,1,1,1],maxTagTextArr:[20,20,20,20],tmpAllOptions:[],tmpOptions:[],mark:0}},props:{loading:{type:Boolean,default:function(){return!1}}},methods:f(f({},Object(o["b"])(["getAllProject","getAllAppForEventFunnel"])),{},{projectChange:function(t){var e=this;if(t.length>0){this.canSelectAllAppType=[],this.canSelectAllApp=[],this.appTypes=[],this.apps=[];for(var n=0;n<t.length;++n)for(var a=function(a){e.allApp[a].project===t[n]&&e.canSelectAllApp.findIndex((function(t){return t.app_id===e.allApp[a].app_id}))<0&&e.canSelectAllApp.push(e.allApp[a])},i=0;i<this.allApp.length;++i)a(i)}else this.apps=[],this.initAllSelect()},initAllSelect:function(){this.projects.length>0?this.projectChange(this.projects):this.canSelectAllApp=this.allApp.filter((function(t){return null!=t}))},handleSubmit:function(t){var e={projects:this.projects,apps:this.apps,funnel_name:this.funnel_name,creator:this.creator,like:"LIKE"};this.$emit("on-filter-apply",e)},maxTagCountfun:function(t){return this.maxTagCountObj&&this.maxTagCountObj[t]?this.maxTagCountObj[t]:1},focusFun:function(t){this.mark=1,h()("#optionsContent").length&&h()("#optionsContent").css({display:"none"}),this.maxTagArr=[1,1,1,1],this.maxTagTextArr=[20,20,20,20];var e=this;setTimeout((function(){e.maxTagArr.splice(t,0,10),e.maxTagTextArr.splice(t,0,100)}),500)},blurFun:function(){this.mark=0,this.maxTagArr.findIndex((function(t){return 10===t}))>=0&&(this.maxTagArr=[1,1,1,1],this.maxTagTextArr=[20,20,20,20]),this.setItemValues()},mouseenterFun:function(t){if(1!==this.mark){this.tmpOptions=this.tmpAllOptions[t];var e=Object(u["g"])(this.$refs["filter"].$el.clientWidth,t),n=document.getElementById("optionsContent");h()("#optionsContent").length&&this.tmpOptions&&this.tmpOptions.length>0&&n&&(h()("#optionsContent").css({display:"block",left:e.left+"px"}),n.style.setProperty("top",e.top+"px","important"))}},mouseleaveFun:function(){this.hideContentItem(),this.setItemValues()},setItemValues:function(){var t=this;this.tmpAllOptions[0]=this.projects;var e=[];this.apps&&this.apps.map((function(n,a){t.canSelectAllApp&&t.canSelectAllApp.map((function(t,a){n===t.app_id&&e.push(t.app_name)}))})),this.tmpAllOptions[1]=e},getFilter:function(){return{projects:this.projects,apps:this.apps,funnel_name:this.funnel_name,creator:this.creator,like:"LIKE"}},setFilter:function(t){this.projects=t.projects,this.apps=t.apps,this.funnel_name=t.funnel_name,this.creator=t.creator},hideContentItem:function(){var t=document.getElementById("optionsContent");t&&(t.style.display="none")}}),mounted:function(){var t=this,e="eventFunnelActivity";Promise.all([this.getAllProject(),this.getAllAppForEventFunnel(e)]).then((function(e){t.allApp=e[1].filter((function(t){return e[0].findIndex((function(e){return e===t.project}))>=0})),t.allProjects=e[0].filter((function(e){return t.allApp.findIndex((function(t){return t.project===e}))>=0})),t.initAllSelect()}))}},m=v,g=(n("3b9f"),n("2877")),y=Object(g["a"])(m,s,l,!1,null,"492b43a8",null),_=y.exports,b=n("f0e6"),w=n("bdcb"),x=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"event_wapper"},[n("div",{staticStyle:{"margin-bottom":"12px",display:"inline-block","border-width":"5px"}},[n("Button",{attrs:{type:"primary"},on:{click:t.handleBack}},[t._v("返回")])],1),n("Card",{staticClass:"filter-selection"},[n("div",{staticClass:"top-div"},[n("span",{staticClass:"left-span"},[t._v("Select App:")]),n("Select",{staticStyle:{width:"200px","margin-right":"10px","margin-left":"10px"},attrs:{filterable:!0,clearable:""},on:{"on-change":t.handleSelectApp,"on-open-change":t.onOpenChangeApps},model:{value:t.selectApp,callback:function(e){t.selectApp=e},expression:"selectApp"}},t._l(t.allApps,(function(e,a){return n("Option",{key:a,attrs:{value:e.app_id}},[t._v(t._s(e.app_name))])})),1)],1),n("div",{staticClass:"top-div"},[n("span",{staticClass:"left-span"},[t._v("Select Event:")]),n("div",{staticStyle:{"margin-left":"150px","margin-top":"-20px"}},[t._l(t.selectedEvents,(function(e,a){return n("span",{key:a},[n("span",{directives:[{name:"show",rawName:"v-show",value:a!==t.editSelectedEventIndex,expression:"i!==editSelectedEventIndex"}]},[n("span",[t._v(t._s(a+1)+" ")]),n("a",{on:{click:function(n){return t.handleEditEvent(a,e)}}},[t._v(t._s(e))]),n("Poptip",{attrs:{trigger:"hover",placement:"bottom",width:"400"},on:{"on-popper-show":function(n){return t.onPopperShow(a,e)}}},[n("a",{staticStyle:{"padding-bottom":"7px","padding-top":"0px","margin-left":"8px",color:"rgba(0,0,0,.65)"},on:{click:function(n){return t.handleEventParams(a,e)}}},[t._v("选择参数"+t._s(t.getParamsLength(e+"_"+a)>0?"("+t.getParamsLength(e+"_"+a)+")":""))]),n("div",{staticClass:"poptip_wapper",staticStyle:{"white-space":"break-spaces",overflow:"hidden","text-overflow":"clip",height:"auto","min-height":"80px","max-height":"35vh","overflow-y":"auto"},attrs:{slot:"content",id:"poptip_wapper"},slot:"content"},[t.currentEventValue.length<1?n("div",[t._v("\n                       请选择参数\n                    ")]):n("div",t._l(t.currentEventValue,(function(e,a){return n("div",{key:a,staticClass:"data_wapper"},[e.field?n("li",[t._v("第"+t._s(a+1)+"组参数:")]):t._e(),e.field?n("li",[t._v("参数名:"+t._s(e.field))]):t._e(),e.field?n("li",[t._v("参数值:"+t._s(e.value?e.value.join(","):""))]):t._e()])})),0)])]),n("Button",{staticStyle:{"padding-bottom":"7px","padding-top":"0px"},attrs:{type:"text",size:"small"},on:{click:function(n){return t.handleCloseEvent(a,e)}}},[t._v("x")])],1),n("Select",{directives:[{name:"show",rawName:"v-show",value:a===t.editSelectedEventIndex,expression:"i===editSelectedEventIndex"}],staticStyle:{width:"200px","margin-right":"10px","margin-left":"10px"},attrs:{filterable:!0},on:{"on-select":t.handleEditSelectEvent,"on-change":function(e){return t.handleModuleChange(a)},"on-open-change":t.onOpenChangeEvent},model:{value:t.selectedEvents[a],callback:function(e){t.$set(t.selectedEvents,a,e)},expression:"selectedEvents[i]"}},t._l(t.allEvents,(function(e,a){return n("Option",{key:a,attrs:{value:e}},[t._v(t._s(e))])})),1)],1)})),t.showSelectEvent?n("Select",{staticStyle:{width:"200px","margin-right":"10px","margin-left":"10px"},attrs:{filterable:!0},on:{"on-select":t.handleSelectEvent,"on-open-change":t.onOpenChangeEvent},model:{value:t.selectEvent,callback:function(e){t.selectEvent=e},expression:"selectEvent"}},t._l(t.allEvents,(function(e,a){return n("Option",{key:a,attrs:{value:e}},[t._v(t._s(e))])})),1):t._e(),!1===t.showSelectEvent&&this.selectedEvents.length<32?n("Button",{staticStyle:{"padding-bottom":"7px","padding-top":"0px"},attrs:{type:"text",size:"large"},on:{click:t.handleAddEvent}},[t._v("+")]):t._e()],2)]),n("div",{staticClass:"top-div"},[n("span",{staticClass:"left-span"},[t._v("Select Data:")]),n("RadioGroup",{on:{"on-change":t.handleDataSelectChange},model:{value:t.dataSelect,callback:function(e){t.dataSelect=e},expression:"dataSelect"}},[n("Radio",{attrs:{label:"unique_users"}},[t._v("unique users")]),n("Radio",{attrs:{label:"total_counts"}},[t._v("total counts")]),n("Radio",{attrs:{label:"average_counts_per_user"}},[t._v("average counts per user")])],1)],1),n("div",{staticClass:"top-div"},[n("span",{staticClass:"left-span"},[t._v("Completed Within:")]),n("Select",{staticStyle:{width:"200px","margin-right":"10px","margin-left":"10px"},model:{value:t.completedWithin,callback:function(e){t.completedWithin=e},expression:"completedWithin"}},[n("Option",{attrs:{value:"anytime"}},[t._v("Anytime")]),n("Option",{attrs:{value:"oneday"}},[t._v("1Day")])],1)],1),n("div",{staticClass:"top-div"},[n("span",{staticClass:"left-span"},[t._v("Filter By:")]),n("a-select",{staticStyle:{width:"200px","margin-right":"10px","margin-left":"10px"},attrs:{mode:"multiple",allowClear:"",filterable:"",showArrow:"",autoClearSearchValue:!1,"max-tag-count":this.maxTagArr[0],"max-tag-text-length":20,placeholder:"MediaSource-全部",optionFilterProp:"children"},on:{focus:function(e){return t.focusFun(0)},blur:function(e){return t.blurFun()}},scopedSlots:t._u([{key:"dropdownRender",fn:function(e){return n("div",{},[n("v-nodes",{attrs:{vnodes:e}}),n("a-divider",{staticClass:"select-all-divider"}),n("div",{staticClass:"select-all-div",on:{mousedown:function(t){return t.preventDefault()}}},[n("span",{staticClass:"select-all-span"},[t._v(t._s(t.mediaSources.length)+"/"+t._s(t.allMediaSources.length))]),n("Button",{attrs:{type:"primary"},on:{click:function(e){t.mediaSources=t.allMediaSources.map((function(t){return t.id}))}}},[t._v("全选")])],1)],1)}}]),model:{value:t.mediaSources,callback:function(e){t.mediaSources=e},expression:"mediaSources"}},t._l(t.allMediaSources,(function(e){return n("a-option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.name)+"\n          ")])})),1),n("a-select",{staticStyle:{width:"270px","margin-right":"10px","margin-left":"10px"},attrs:{mode:"multiple",allowClear:"",filterable:"",showArrow:"",autoClearSearchValue:!1,"max-tag-count":this.maxTagArr[1],"max-tag-text-length":20,placeholder:"国家-全部",optionFilterProp:"children"},on:{focus:function(e){return t.focusFun(1)},blur:function(e){return t.blurFun()}},scopedSlots:t._u([{key:"dropdownRender",fn:function(e){return n("div",{},[n("v-nodes",{attrs:{vnodes:e}}),n("a-divider",{staticClass:"select-all-divider"}),n("div",{staticClass:"select-all-div",on:{mousedown:function(t){return t.preventDefault()}}},[n("span",{staticClass:"select-all-span"},[t._v(t._s(t.countries.length)+"/"+t._s(t.allCountries.length))]),n("Button",{attrs:{type:"primary"},on:{click:function(e){t.countries=t.allCountries.map((function(t){return t.country_id}))}}},[t._v("全选")])],1)],1)}}]),model:{value:t.countries,callback:function(e){t.countries=e},expression:"countries"}},t._l(t.allCountries,(function(e){return n("a-option",{key:e.country_id,attrs:{value:e.country_id}},[t._v(t._s(e.country_name+"("+e.country_id+")")+"\n          ")])})),1),n("a-select",{staticStyle:{width:"270px","margin-right":"10px","margin-left":"10px"},attrs:{mode:"multiple",allowClear:"",filterable:"",showArrow:"",autoClearSearchValue:!1,"max-tag-count":this.maxTagArr[2],"max-tag-text-length":20,placeholder:"AppVersion-全部",optionFilterProp:"children"},on:{focus:function(e){return t.focusFun(2)},blur:function(e){return t.blurFun()}},scopedSlots:t._u([{key:"dropdownRender",fn:function(e){return n("div",{},[n("v-nodes",{attrs:{vnodes:e}}),n("a-divider",{staticClass:"select-all-divider"}),n("div",{staticClass:"select-all-div",on:{mousedown:function(t){return t.preventDefault()}}},[n("span",{staticClass:"select-all-span"},[t._v(t._s(t.appVersions.length)+"/"+t._s(t.allAppversions.length))]),n("Button",{attrs:{type:"primary"},on:{click:function(e){t.appVersions=t.allAppversions}}},[t._v("全选")])],1)],1)}}]),model:{value:t.appVersions,callback:function(e){t.appVersions=e},expression:"appVersions"}},t._l(t.allAppversions,(function(e){return n("a-option",{key:e,attrs:{value:e}},[t._v(t._s(e)+"\n          ")])})),1)],1),n("div",{staticClass:"top-div"},[n("span",{staticClass:"left-span"},[t._v("Select Date:")]),n("DatePicker",{staticStyle:{width:"200px","margin-right":"10px","margin-left":"10px"},attrs:{type:"daterange",options:t.daterangeoption,clearable:!1,placement:"bottom-start",placeholder:"选择日期范围"},on:{"on-change":t.handleDateChange},model:{value:t.rangeDates,callback:function(e){t.rangeDates=e},expression:"rangeDates"}}),n("span",{directives:[{name:"show",rawName:"v-show",value:t.dateInvalid,expression:"dateInvalid"}],staticStyle:{color:"red"}},[t._v("最多只能查询31天的数据")])],1),n("div",{staticClass:"top-div"},[n("label",{staticClass:"left-span"},[t._v("Funnel Name:")]),n("Input",{staticStyle:{display:"inline-block",width:"200px","margin-right":"10px","margin-left":"10px"},model:{value:t.funnelName,callback:function(e){t.funnelName=e},expression:"funnelName"}})],1),n("Button",{staticStyle:{"margin-right":"10px"},attrs:{type:"primary"},on:{click:t.handleExplain}},[t._v("开始分析")]),n("Button",{staticStyle:{"margin-right":"10px"},attrs:{type:"primary"},on:{click:function(e){return t.handleSave(!1)}}},[t._v("保存")]),n("Button",{directives:[{name:"show",rawName:"v-show",value:t.funnel_id,expression:"funnel_id"}],staticStyle:{"margin-right":"10px"},attrs:{type:"primary"},on:{click:function(e){return t.handleSave(!0)}}},[t._v("另存为")])],1),n("Modal",{attrs:{width:"880px",closable:!1,"mask-closable":!1,title:t.title,"footer-hide":""},model:{value:t.paramsVisible,callback:function(e){t.paramsVisible=e},expression:"paramsVisible"}},[n("div",{attrs:{slot:"header"},slot:"header"},[n("font",{attrs:{size:"4"}},[n("b",[t._v("Event Name: "+t._s(t.title))])])],1),n("div",[n("Form",{ref:"formDynamic",attrs:{model:t.formDynamic,"label-width":80}},[t._l(t.formDynamic.items,(function(e,a){return[n("Row",{key:a},[n("Col",{attrs:{span:"8"}},[n("FormItem",{key:a,attrs:{label:"参数名",prop:"items."+a+".name",rules:{required:!0,message:"参数名不能为空",trigger:"change"}}},[n("Row",[n("Col",{attrs:{span:"24"}},[n("a-select",{staticStyle:{width:"200px","margin-right":"10px","margin-left":"10px"},attrs:{allowClear:"","show-search":"",showArrow:"",autoClearSearchValue:!1,placeholder:"请选择参数",dropdownClassName:"inline-width-special inline-width-event-info",optionFilterProp:"children"},on:{change:function(e){return t.changeParamsName(a)}},model:{value:e.name,callback:function(n){t.$set(e,"name",n)},expression:"item.name"}},t._l(t.allParams,(function(e){return n("a-option",{key:e,attrs:{value:e}},[t._v(t._s(e)+"\n                        ")])})),1)],1)],1)],1)],1),n("Col",{attrs:{span:"16"}},[n("FormItem",{key:a,staticClass:"form_item",attrs:{label:"value",prop:"items."+a+".value"}},[n("Row",[n("Col",{attrs:{span:"18"}},[n("a-select",{staticStyle:{width:"85%","margin-right":"10px","margin-left":"10px"},attrs:{mode:"multiple",allowClear:"","show-search":"",showArrow:"",autoClearSearchValue:!1,dropdownClassName:"inline-width-special inline-width-event-info",placeholder:"请选择value值",optionFilterProp:"children","max-tag-count":t.maxTagCountfun(a),"max-tag-text-length":t.maxTagTextfun(a)},on:{focus:function(e){return t.paramsFocusFun(a)},blur:function(e){return t.paramsBlurFun()}},model:{value:e.value,callback:function(n){t.$set(e,"value",n)},expression:"item.value"}},t._l(t.getAllParamsValue(e.name),(function(e){return n("a-option",{key:e,attrs:{value:e}},[t._v(t._s(e)+"\n                        ")])})),1)],1),n("Col",{attrs:{span:"2",offset:"1"}},[t.formDynamic.items.length>1?n("a",{staticClass:"ad_btn",on:{click:function(e){return t.handleRemove(a)}}},[n("Icon",{attrs:{type:"md-close"}})],1):t._e()]),n("Col",{attrs:{span:"2",offset:"1"}},[(1===t.formDynamic.items||a===t.formDynamic.items.length-1)&&t.formDynamic.items.length<10?n("a",{staticClass:"ad_btn",on:{click:t.handleAdd}},[n("Icon",{attrs:{type:"md-add"}})],1):t._e()])],1)],1)],1)],1)]}))],2)],1),n("Row",[n("Button",{staticStyle:{float:"right","margin-left":"10px"},attrs:{type:"primary"},on:{click:t.handleAddDimesion}},[t._v("确定")]),n("Button",{staticStyle:{"margin-left":"8px",float:"right"},on:{click:function(e){return t.handleCancel(1)}}},[t._v("取消")])],1)],1),n("div",{directives:[{name:"show",rawName:"v-show",value:t.showDataCard,expression:"showDataCard"}],staticStyle:{"margin-top":"5px"},attrs:{shadow:""}},[n("div",{directives:[{name:"show",rawName:"v-show",value:!t.haveData,expression:"!haveData"}],staticStyle:{"text-align":"center"}},[n("span",{staticStyle:{"font-size":"15px","margin-top":"50px"}},[t._v("暂无数据")])]),n("div",{directives:[{name:"show",rawName:"v-show",value:t.haveData,expression:"haveData"}]},[n("Card",{staticStyle:{"padding-bottom":"0px"},attrs:{shadow:""}},[n("span",[t._v("总体概览:")]),n("div",[n("span",{staticStyle:{"margin-left":"12%"}},[t._v("所有用户(新+老)")]),n("span",{staticStyle:{"margin-left":"30%"}},[t._v("新用户")]),n("span",{staticStyle:{"margin-left":"30%"}},[t._v("老用户")])]),n("event-funnel-chart",{attrs:{"chart-data":t.funnelChartData}}),t.funnelLoading?n("Spin",{attrs:{size:"large",fix:""}}):t._e()],1),n("Card",{staticStyle:{"margin-top":"5px"}},[n("span",[t._v("明细数据")]),t.downloadLoading?n("Spin",{attrs:{size:"large",fix:""}}):t._e(),n("div",{},[n("div",{staticStyle:{"margin-bottom":"5px","margin-top":"10px"}},[n("span",[t._v("Group by")]),n("Select",{staticStyle:{width:"200px","margin-right":"10px","margin-left":"10px"},model:{value:t.groupBy,callback:function(e){t.groupBy=e},expression:"groupBy"}},[n("Option",{attrs:{value:"media_source"}},[t._v("Media Source")]),n("Option",{attrs:{value:"app_version"}},[t._v("App Version")]),n("Option",{attrs:{value:"country"}},[t._v("Country")]),n("Option",{attrs:{value:"date"}},[t._v("Date")])],1),n("Button",{attrs:{type:"primary"},on:{click:t.handleRefresh}},[t._v("刷新")]),n("Button",{staticStyle:{float:"right"},attrs:{type:"primary"},on:{click:t.handleDownload}},[t._v("导出数据")])],1)]),n("Tabs",{staticClass:"event-funnel-tabs",attrs:{"capture-focus":!0},on:{"on-click":t.handleUserTypeChange},model:{value:t.currUserType,callback:function(e){t.currUserType=e},expression:"currUserType"}},[n("TabPane",{attrs:{label:"所有用户(新+老)",name:"all_user"}}),n("TabPane",{attrs:{label:"新用户",name:"new_user"}}),n("TabPane",{attrs:{label:"老用户",name:"old_user"}})],1),n("div",{directives:[{name:"show",rawName:"v-show",value:(t.tableData&&t.tableData.length)>0||t.tableLoading,expression:"(tableData && tableData.length) > 0 || tableLoading"}],attrs:{id:"mainItem"}},[n("Row",{staticClass:"controlItem"},[n("Card",{staticStyle:{"padding-bottom":"16px"},attrs:{shadow:""}},[n("div",{staticStyle:{"margin-bottom":"25px"}},[n("div",{staticStyle:{"font-size":"14px",float:"right"}},[n("Checkbox",{staticStyle:{"font-size":"14px","margin-right":"40px"},on:{"on-change":t.changeCheckbox},model:{value:t.checkStatus,callback:function(e){t.checkStatus=e},expression:"checkStatus"}},[t._v("显示数字标签")]),t.visible?n("a",{on:{click:t.previewFun}},[t._v("点击预览")]):t._e(),n("Tooltip",{attrs:{content:"关闭预览"}},[n("Button",{attrs:{id:"closeBtn"},on:{click:t.closeFun}},[t._v("X")])],1)],1)]),n("group-line-chart",{ref:"child",attrs:{"field-formaters":t.field_formaters,"default-formater":"0.00%","x-axis-type":"","known-fields":t.event_funnel_activity,events:t.currFilterApply.event_name,"chart-data":t.lineChartData[0],status:t.checkStatus,previewStatus:t.previewStatus}})],1),t.tableLoading?n("Spin",{attrs:{size:"large",fix:""}}):t._e()],1)],1),n("local-table",{attrs:{data:t.tableData,"footer-data":t.totalData,"table-loading":t.tableLoading,"known-fields":t.event_funnel_activity,dimensions:t.currDimensions,"default-formater":t.tableFormater,events:t.currFilterApply.event_name}}),n("p",[t._v("计算说明：")]),n("p",[t._v("1、在统计用户数时，合计栏的用户数为去重之后的计算结果；")]),n("p",[t._v("2、当group by日期时，表格（除合计外）统计的是在当天完成转化的数据，合计值统计的是在所选时间范围内完成转化的数据。")])],1)],1)])],1)},D=[],A=(n("28a5"),n("7f7f"),n("55dd"),n("4f7f"),n("1c4c"),n("88e6")),S=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"dom",style:{width:"auto"}})},C=[],O=(n("6b54"),n("313e")),k=n.n(O),F=n("90de"),T=n("6612"),E=n.n(T),j={name:"event-funnel-chart",props:{chartData:{type:Object,default:function(){return{legendData:[],values:[],format:"0,0",name:[]}}}},data:function(){return{dom:null,client_width:1400,client_height:500}},methods:{resize:function(){this.dom.resize()},wrapOption:function(){var t=this,e=[];if(null!=this.chartData.values)for(var n=function(n){var a=1;null!=t.chartData.values[n]&&t.chartData.values[n].length>0&&(a=t.chartData.values[n][0]),0===a&&(a=1);var i=[],r=t.chartData.values[n].length;if(r=r>1?r-1:1,t.chartData.values[n])for(var s=0;s<t.chartData.values[n].length;s++)i.push({value:t.chartData.values[n][s],name:t.chartData.legendData[s]});var l=5*n+30*n+"%",o={name:t.chartData.names[n],type:"funnel",left:l,top:"5",bottom:"5",width:"30%",height:"70%",sort:"none",label:{show:!0,position:"inside",color:"black",formatter:function(t){var e=E()(t.value/a).format("0.00%");return e}},itemStyle:{normal:{color:function(t){var e=236,n=244,a=235/r,i=120/r,s="FF",l=parseInt(e-a*t.dataIndex).toString(16);1===l.length&&(l="0"+l);var o=parseInt(n-i*t.dataIndex).toString(16);1===o.length&&(o="0"+o);var c="#"+l+o+s;return c}}},data:i};e.push(o)},a=0;a<this.chartData.values.length;a++)n(a);var i=this.chartData.formate;return{animation:!1,legend:{formatter:function(t){return t?(t.length>32&&(t=t.slice(0,32)+"..."),t):""},x:"center",y:"bottom",selectedMode:!1,data:this.chartData.legendData},tooltip:{trigger:"item",formatter:function(t){var e=t.seriesName+"<br/>";return e=e+"事件:  "+t.name+"<br/>",e=e+"数值:  "+E()(t.value).format(i),e}},series:e}},renderChart:function(){var t=this,e=this.wrapOption();this.$nextTick((function(){t.dom=k.a.init(t.$refs.dom),t.dom.setOption(e,!0),t.dom.resize({height:350}),Object(F["m"])(window,"resize",t.resize)}))},callMethod:function(t){},_expandable:function(){this.client_width=document.body.clientWidth,this.client_height=document.body.clientHeight}},watch:{chartData:{deep:!0,handler:function(t,e){this.renderChart()}},status:function(t){this.renderChart()}},mounted:function(){this.renderChart(),this._expandable();var t=this;window.onresize=function(){t._expandable()}},beforeDestroy:function(){Object(F["l"])(window,"resize",this.resize)}},P=j,I=Object(g["a"])(P,S,C,!1,null,null,null),N=I.exports,$=n("ae3e"),L=n("9c6c0");function B(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function R(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?B(Object(n),!0).forEach((function(e){Object(r["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):B(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var z={name:"event-funnel-activity-dashboard",components:{ASelect:c["d"],AOption:c["d"].Option,LocalTable:$["a"],GroupLineChart:A["a"],EventFunnelChart:N,VNodes:{functional:!0,render:function(t,e){return e.props.vnodes}}},props:{},data:function(){return{maxTagArr:[1,1,1],inFields:[["mediaSources","media_source"],["countries","country"],["appVersions","app_version"]],funnel_id:"",selectApp:"",selectEvent:"",selectedEvents:[],editSelectedEventIndex:-1,showSelectEvent:!0,dataSelect:"unique_users",completedWithin:"anytime",mediaSources:[],countries:[],appVersions:[],dateInvalid:!1,rangeDates:[],funnelName:"",allApps:[],allEvents:[],allMediaSources:[],allCountries:[],allAppversions:[],daterangeoption:{},currUserType:"all_user",inited:!1,showDataCard:!1,knownDimensions:["media_source","app_version","country","date"],groupBy:"date",currDimensions:["date"],currFilterApply:{},tableFormater:"0,0",tableLoading:!0,downloadLoading:!1,lineChartData:[],checkStatus:!1,visible:!0,previewStatus:!1,funnelLoading:!0,funnelChartData:{},title:"Event Name",index:1,paramsVisible:!1,formDynamic:{items:[{value:[],name:"",index:0}]},allParams:[],allParamsValue:[123001,2],currentEventName:{},event_value:{},allParamsOfEvent:[],maxTagCountObj:{},maxTaglengthObj:{},currentEventValue:[]}},computed:R(R({},Object(o["d"])({field_formaters:function(t){return t.dashboard_field.field_formaters},event_funnel_activity:function(t){return t.dashboard_field.event_funnel_activity},tableData:function(t){if(!0===this.inited)return t.event_funnel_activity.eventFunnelActivityDashboardTableData.data},pageData:function(t){if(!0===this.inited){var e=t.event_funnel_activity.eventFunnelActivityDashboardTableData,n={page_size:20,total_num:e.data?e.data.length:0};return n}},totalData:function(t){var e;if(!0===this.inited&&(e="new_user"===this.currUserType?t.event_funnel_activity.eventFunnelActivityDashboardNewTotalData.data:"old_user"===this.currUserType?t.event_funnel_activity.eventFunnelActivityDashboardOldTotalData.data:t.event_funnel_activity.eventFunnelActivityDashboardAllTotalData.data,e&&e.length>0))return e[0]}})),{},{allDimensions:function(){return Object(u["j"])(this.event_funnel_activity,this.knownDimensions)},haveData:function(){if(!0===this.inited){if(this.tableData&&this.tableData.length>0||this.tableLoading)return!0;if(this.$store.state.event_funnel_activity.eventFunnelActivityDashboardNewTotalData.data&&this.$store.state.event_funnel_activity.eventFunnelActivityDashboardNewTotalData.data.length>0&&this.$store.state.event_funnel_activity.eventFunnelActivityDashboardNewTotalData.data[0].data_0>0)return!0;if(this.$store.state.event_funnel_activity.eventFunnelActivityDashboardOldTotalData.data&&this.$store.state.event_funnel_activity.eventFunnelActivityDashboardOldTotalData.data.length>0&&this.$store.state.event_funnel_activity.eventFunnelActivityDashboardOldTotalData.data[0].data_0>0)return!0;if(this.$store.state.event_funnel_activity.eventFunnelActivityDashboardAllTotalData.data&&this.$store.state.event_funnel_activity.eventFunnelActivityDashboardAllTotalData.data.length>0&&this.$store.state.event_funnel_activity.eventFunnelActivityDashboardAllTotalData.data[0].data_0>0)return!0}return!1}}),methods:R(R({},Object(o["b"])(["getAllAppsOfEvent","getAllEventNameOfApp","getAllVersionsOfApp","getTotalMediaSource","getAllCountry","postEventFunnelActivityTableData","putEventFunnelActivityTableData","getEventFunnelActivityDashboardTableData","getEventFunnelActivityDashboardTotalData","getEventFunnelActivityDashboardDownloadUrl","getEventNameValue"])),{},{handleDateChange:function(t){var e=Date.parse(t[0]),n=Date.parse(t[1]),a=parseInt((n-e)/864e5)+1;a>31?(this.dateInvalid=!0,this.$Message.error("最多只能查询31天的数据")):this.dateInvalid=!1},handleSelectApp:function(t){var e=this;if(this.event_value={},t){var n=this.allApps.filter((function(t){return t.app_id===e.selectApp}));n.length,this.selectEvent="",this.selectedEvents=[],this.editSelectedEventIndex=-1,this.showSelectEvent=!0,this.appVersions=[]}else this.selectedEvents=[],this.appVersions=[],this.allEvents=[],this.allAppversions=[]},onOpenChangeApps:function(t){this.getEventNameAndVersions()},onOpenChangeEvent:function(t){this.getEventNameAndVersions()},getEventNameAndVersions:function(){var t=this;if(this.selectApp){var e={app_id:this.selectApp};this.getAllEventNameOfApp(e).then((function(e){t.allEvents=e})).catch((function(e){t.$Message.error(e.message)})),this.getAllVersionsOfApp(e).then((function(e){t.allAppversions=e})).catch((function(e){t.$Message.error(e.message)}))}},handleSelectEvent:function(t){this.selectedEvents.push(t.value),this.selectEvent="",this.showSelectEvent=!1},handleEditSelectEvent:function(t){this.editSelectedEventIndex=-1},handleBack:function(){this.event_value={},this.$emit("on-back")},handleDataSelectChange:function(t){},handleCloseEvent:function(t,e){this.selectedEvents=this.selectedEvents.filter((function(e,n,a){return n!==t}));var n=e+"_"+t;delete this.event_value[n];var a={};for(var i in this.event_value)if(i){var r=i.lastIndexOf("_"),s=parseInt(i.substring(r+1,i.length));if(s>t){s-=1;var l=i.substring(0,r)+"_"+s;a[l]=this.event_value[i]}else a[i]=this.event_value[i]}this.event_value=a},handleModuleChange:function(t){for(var e in this.event_value){var n=e.lastIndexOf("_"),a=e.substring(n+1,e.length);t===parseInt(a)&&delete this.event_value[e]}},onPopperShow:function(t,e){var n=e+"_"+t,a=this.event_value[n];this.currentEventValue=a?JSON.parse(a):[],h()("#poptip_wapper")&&h()("#poptip_wapper").scrollTop(0)},handleEventParams:function(t,e){var n=this;this.editSelectedEventIndex=-1,this.showSelectEvent=!1;var a={app_id:this.selectApp,event_name:e},i=this;this.formDynamic.items=[],this.getEventNameValue(a).then((function(a){if(n.allParamsOfEvent=a,a.length>0){i.title=e,i.currentEventName={event_name:e,key:t},n.allParams=n.getAllKeys(a,e),n.allParams.length>0?i.paramsVisible=!0:i.$Message.error("".concat(e,"没有任何参数"));var r=e+"_"+t;if(i.getParamsLength(r)>0){i.formDynamic.items=[];var s=i.event_value[r]?JSON.parse(i.event_value[r]):[];s&&s.map((function(t,e){i.formDynamic.items.push({value:t.value,name:t.field,index:e})}))}else i.clearForm()}else i.$Message.error("".concat(e,"没有任何参数"))})).catch((function(t){n.showError(t)}))},getAllKeys:function(t,e){var n=[];t&&t.map((function(t,e){t.event_value_key&&"null"!==t.event_value_key&&n.push(t.event_value_key)}));var a=Array.from(new Set(n));return a=a.sort((function(t,e){return t.localeCompare(e,"zh-CN")})),a},getAllParamsValue:function(t){var e=this,n=this.allParamsOfEvent.filter((function(n){return n.app_id===e.selectApp&&n.event_name===e.currentEventName.event_name&&n.event_value_key===t})),a=[];n&&n.map((function(t,e){t.event_value_content&&a.push(t.event_value_content)}));var i=Array.from(new Set(a));return i=L["k"].indexOf(t)>-1?i.sort((function(t,e){return t-e})):i.sort((function(t,e){return t.localeCompare(e,"zh-CN")})),i},clearForm:function(){this.formDynamic.items=[],this.formDynamic.items.push({value:[],name:"",index:0})},handleAdd:function(){this.index++,this.formDynamic.items.push({value:[],name:"",index:this.formDynamic.items&&this.formDynamic.items.length})},handleRemove:function(t){this.formDynamic.items=this.formDynamic.items.filter((function(e){return e.index!==t})),this.formDynamic.items&&this.formDynamic.items.map((function(t,e){t.index=e}))},handleAddDimesion:function(){var t=this;this.$refs["formDynamic"].validate((function(e){if(e){var n=t.dealOperateData(t.formDynamic),a=t.currentEventName.event_name+"_"+t.currentEventName.key;t.event_value[a]=n;var i=t;t.setStyleNone(),setTimeout((function(){i.paramsVisible=!1,i.allParamsOfEvent=[]}),0)}}))},dealOperateData:function(t){var e=[];return t.items&&t.items.map((function(t,n){if(t.value&&t.value.length>0){var a={field:t.name,value:t.value,operator:"in"};e.push(a)}})),e?JSON.stringify(e):""},handleCancel:function(t){this.setStyleNone();var e=this;setTimeout((function(){e.paramsVisible=!1,e.allParamsOfEvent=[],e.clearForm()}),0)},setStyleNone:function(){var t=document.getElementsByClassName("ant-select-dropdown");if(t)for(var e=0;e<t.length;e++)t[e].style.display="none";var n=document.getElementsByClassName("ant-select-dropdown");if(n)for(var a=0;a<n.length;a++)n[a].style.display="none"},getParamsLength:function(t){var e=this.event_value[t]?JSON.parse(this.event_value[t]):[];return e.length>0?e.length:0},handleEditEvent:function(t){this.getEventNameAndVersions(),this.editSelectedEventIndex=t,this.showSelectEvent=!1},handleAddEvent:function(){this.editSelectedEventIndex=-1,this.showSelectEvent=!0},handleExplain:function(){if(""!==this.selectApp&&this.selectApp)if(0!==this.selectedEvents.length)if(this.dateInvalid)this.$Message.error("最多只能查询31天的数据");else{var t={rangeDates:this.rangeDates,mediaSources:this.mediaSources,countries:this.countries,appVersions:this.appVersions},e={time_range:Object(u["r"])(t),event_name:this.selectedEvents,event_value:this.event_value,data_select:this.dataSelect,app_id:this.selectApp,completed_within:this.completedWithin,filtering:Object(u["m"])(t,this.inFields)};this.currFilterApply=JSON.parse(JSON.stringify(e)),this.showDataCard=!0,this.updatePageData()}else this.$Message.error("请添加Event!");else this.$Message.error("请选择App!")},handleSave:function(t){var e=this;if(""!==this.selectApp&&this.selectApp)if(0!==this.selectedEvents.length)if(this.dateInvalid)this.$Message.error("最多只能查询31天的数据");else if(""!==this.funnelName){var n={rangeDates:this.rangeDates,mediaSources:this.mediaSources,countries:this.countries,appVersions:this.appVersions},a={funnel_name:this.funnelName,time_range:Object(u["r"])(n),event_name:this.selectedEvents.join(","),event_value:this.event_value,data_select:this.dataSelect,app_id:this.selectApp,completed_within:this.completedWithin,filtering:Object(u["m"])(n,this.inFields),time_type:Object(u["i"])(this.rangeDates)};this.funnel_id&&!t?(a.id=this.funnel_id,Promise.all([this.putEventFunnelActivityTableData(a)]).then((function(t){e.$Message.success("修改成功!")})).catch((function(t){e.$Modal.error({title:"Error",content:t})}))):Promise.all([this.postEventFunnelActivityTableData(a)]).then((function(t){e.funnel_id=t[0].id,e.$Message.success("添加成功!")})).catch((function(t){e.$Modal.error({title:"Error",content:t})}))}else this.$Message.error("请填写Funnel Name!");else this.$Message.error("请添加Event!");else this.$Message.error("请选择App!")},filteringToArray:function(t){if(null!=t)for(var e=JSON.parse(t),n=0;n<e.length;n++)"media_source"===e[n].field?this.mediaSources=e[n].value:"country"===e[n].field?this.countries=e[n].value:"app_version"===e[n].field&&(this.appVersions=e[n].value)},initData:function(t){if(this.funnel_id="",this.selectApp="",this.selectEvent="",this.selectedEvents=t?t.row.event_name.split(","):[],this.editSelectedEventIndex=-1,this.showSelectEvent=!0,this.dataSelect="unique_users",this.completedWithin="anytime",this.mediaSources=[],this.countries=[],this.appVersions=[],this.dateInvalid=!1,this.rangeDates=Object(F["f"])("1 week"),this.funnelName="",this.allEvents=[],this.allAppversions=[],this.showDataCard=!1,this.groupBy="date",this.currUserType="all_user",this.currDimensions=["date"],this.$store.state.event_funnel_activity.eventFunnelActivityDashboardTableData={},this.$store.state.event_funnel_activity.eventFunnelActivityDashboardNewTotalData={},this.$store.state.event_funnel_activity.eventFunnelActivityDashboardOldTotalData={},this.$store.state.event_funnel_activity.eventFunnelActivityDashboardAllTotalData={},t){this.funnel_id=t.row.id,this.selectApp=t.row.app_id,this.handleSelectApp(this.selectApp),this.selectedEvents=t.row.event_name.split(",");var e=[];for(var n in this.selectedEvents&&this.selectedEvents.map((function(t,n){e.push(t+"_"+n)})),this.event_value=t.row.event_value?JSON.parse(t.row.event_value):{},this.event_value)e.indexOf(n)<0&&delete this.event_value[n];this.funnelName=t.row.funnel_name,this.rangeDates=Object(u["k"])(t.row.time_range),this.dataSelect=t.row.data_select,this.completedWithin=t.row.completed_within,this.filteringToArray(t.row.filtering),t.row.time_type&&(this.rangeDates=Object(F["f"])(t.row.time_type)),this.showSelectEvent=!1}},updateTableData:function(){var t=this;this.tableLoading=!0;var e=this.wrapTableReqParams();this.getEventFunnelActivityDashboardTableData(e).then((function(e){t.getLineChartData(),t.tableLoading=!1})).catch((function(e){t.tableLoading=!1,t.showError(e)}))},updatePageData:function(){var t=this;this.currDimensions=[this.groupBy],this.tableLoading=!0,this.funnelLoading=!0,Promise.all([this.getEventFunnelActivityDashboardTableData(this.wrapTableReqParams()),this.getEventFunnelActivityDashboardTotalData(this.wrapTotalReqParams("new_user")),this.getEventFunnelActivityDashboardTotalData(this.wrapTotalReqParams("old_user")),this.getEventFunnelActivityDashboardTotalData(this.wrapTotalReqParams("all_user"))]).then((function(e){t.inited=!0,"average_counts_per_user"===t.currFilterApply.data_select?t.tableFormater="0,0.00":t.tableFormater="0,0",t.tableLoading=!1,t.funnelLoading=!1,t.getLineChartData(),t.getFunnelChartData()})).catch((function(e){t.tableLoading=!1,t.funnelLoading=!1,t.showError(e)}))},wrapTableReqParams:function(){var t={time_range:this.currFilterApply.time_range,filtering:this.currFilterApply.filtering,event_name:this.currFilterApply.event_name.join(","),event_value:this.event_value,data_select:this.currFilterApply.data_select,app_id:this.currFilterApply.app_id,completed_within:this.currFilterApply.completed_within,group_by:[this.groupBy],user_type:this.currUserType};return t},wrapTotalReqParams:function(t){var e={time_range:this.currFilterApply.time_range,filtering:this.currFilterApply.filtering,event_name:this.currFilterApply.event_name.join(","),event_value:this.event_value,data_select:this.currFilterApply.data_select,app_id:this.currFilterApply.app_id,group_by:[this.groupBy],completed_within:this.currFilterApply.completed_within,query_type:"summary",user_type:t};return e},wrapDownloadReqParams:function(){var t={time_range:this.currFilterApply.time_range,filtering:this.currFilterApply.filtering,event_name:this.currFilterApply.event_name.join(","),event_value:this.event_value,data_select:this.currFilterApply.data_select,app_id:this.currFilterApply.app_id,completed_within:this.currFilterApply.completed_within,group_by:[this.groupBy],user_type:this.currUserType};return t},handleRefresh:function(){this.currDimensions=[this.groupBy],this.updateTableData()},handleUserTypeChange:function(){this.currDimensions=[this.groupBy],this.updateTableData()},handleDownload:function(){var t=this;this.downloadLoading=!0;var e=this.wrapDownloadReqParams();this.getEventFunnelActivityDashboardDownloadUrl(e).then((function(e){t.downloadLoading=!1;var n=document.createElement("a");n.href=e.url,n.click()})).catch((function(e){t.downloadLoading=!1,t.showError(e)}))},getLineChartData:function(){var t=[];!0===this.inited&&(t=Object(u["t"])(this.$store.state.event_funnel_activity.eventFunnelActivityDashboardTableData.data,null,this.currDimensions,this.currFilterApply.event_name)),(!t||t.length<=0)&&(t=[],t.push({legendData:[],xAxisData:[],values:[]})),this.lineChartData=t},getFunnelChartData:function(){var t={},e="0,0";if(!0===this.inited){"average_counts_per_user"===this.currFilterApply.data_select&&(e="0,0.00");var n=Object(u["s"])(this.$store.state.event_funnel_activity.eventFunnelActivityDashboardAllTotalData.data,this.currFilterApply.event_name),a=Object(u["s"])(this.$store.state.event_funnel_activity.eventFunnelActivityDashboardOldTotalData.data,this.currFilterApply.event_name),i=Object(u["s"])(this.$store.state.event_funnel_activity.eventFunnelActivityDashboardNewTotalData.data,this.currFilterApply.event_name);t.formate=e,t.legendData=n.legendData,t.values=[],t.values.push(n.values),t.values.push(i.values),t.values.push(a.values),t.names=[],t.names.push("所有用户(新+老)"),t.names.push("新用户"),t.names.push("老用户")}t||(t={legendData:[],values:[],formate:e}),this.funnelChartData=t},changeCheckbox:function(t){this.checkStatus=t,this.lineChartData.status=t},previewFun:function(){this.visible=!1,this.previewStatus=!0;var t=document.getElementsByClassName("controlItem");if(h()("#mainItem").length&&h()("#closeBtn").length&&t){var e=document.body.clientWidth;h()("#mainItem").css({width:e+"px",height:"100vh",background:"rgba(0,0,0,.8)",position:"fixed",top:"0",left:"0",zIndex:"1000"}),h()("#closeBtn").css({position:"fixed",top:"7%",right:"0",zIndex:"1000",marginTop:"12px",marginRight:"12px",display:"block"}),t[0].style.top="8%"}},closeFun:function(){this.visible=!0,this.previewStatus=!1,h()("#mainItem").length&&h()("#closeBtn").length&&(h()("#mainItem").css({width:"auto",height:"auto",position:"static",background:"#ffffff"}),h()("#closeBtn").css({display:"none"}))},changeParamsName:function(t){this.formDynamic.items[t].value=[]},focusFun:function(t){2===t&&this.getEventNameAndVersions(),this.maxTagArr=[1,1,1,1];var e=this;setTimeout((function(){e.maxTagArr.splice(t,0,10)}),10)},blurFun:function(){this.maxTagArr.findIndex((function(t){return 10===t}))>=0&&(this.maxTagArr=[1,1,1,1])},paramsBlurFun:function(){for(var t in this.mark=0,this.maxTagCountObj={},this.maxTaglengthObj)this.maxTaglengthObj[t]=15},maxTagCountfun:function(t){return this.maxTagCountObj&&this.maxTagCountObj[t]?this.maxTagCountObj[t]:1},maxTagTextfun:function(t,e){return this.maxTaglengthObj&&this.maxTaglengthObj[t]?this.maxTaglengthObj[t]:15},paramsFocusFun:function(t){this.mark=1;var e=this;setTimeout((function(){e.maxTagCountObj={},e.maxTagCountObj[t]=100,e.maxTaglengthObj={},e.maxTaglengthObj[t]=100}),500)},showError:function(t){this.$Modal.error({title:"Error",content:t})}}),mounted:function(){var t=this;this.daterangeoption=Object(F["c"])(),Promise.all([this.getAllAppsOfEvent(),this.getTotalMediaSource(),this.getAllCountry()]).then((function(e){var n=e[0];n=n.sort((function(t,e){return t.app_name.localeCompare(e.app_name,"zh-CN")})),t.allApps=n,t.allMediaSources=e[1],t.allCountries=e[2],t.selectApp,t.inited=!0}))},created:function(){this.rangeDates=Object(F["f"])("1 week")}},V=z,M=(n("0d3a"),Object(g["a"])(V,x,D,!1,null,null,null)),U=M.exports,J=n("4481");n("ca62");function q(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function W(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?q(Object(n),!0).forEach((function(e){Object(r["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):q(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var H={name:"event-funnel-activity",components:{PageFilter:_,TabsList:b["a"],TableData:w["a"],EventFunnelActivityDashboard:U},data:function(){return{mainInited:!1,mainKnownDimensions:["project","app_name","funnel_name"],mainKnownMetrics:["event_name","creator","last_saved","saved_by","handle_delete"],mainInFields:[["projects","project"],["apps","app_id"]],mainLikeFields:[["funnel_name","like","funnel_name"],["creator","like","creator"]],mainCurrFilterApply:{},mainCurrSortField:{},mainCurrPageIndex:1,mainCurrPageSize:100,mainPageReset:!1,mainTableLoading:!0,showMain:!0}},computed:W(W({},Object(o["d"])({field_formaters:function(t){return t.dashboard_field.field_formaters},event_funnel_activity:function(t){return t.dashboard_field.event_funnel_activity},mainTableData:function(t){if(!0===this.mainInited)return t.event_funnel_activity.eventFunnelActivityTableData.data},mainPageData:function(t){if(!0===this.mainInited){var e=t.event_funnel_activity.eventFunnelActivityTableData,n={page_size:e.page_size,has_next:e.has_next,has_prev:e.has_prev,total_num:e.total_num};return n}}})),{},{mainAllDimensions:function(){return Object(u["j"])(this.event_funnel_activity,this.mainKnownDimensions)},mainAllMetrics:function(){return Object(u["j"])(this.event_funnel_activity,this.mainKnownMetrics)}}),methods:W(W({},Object(o["b"])(["getEventFunnelActivityTableData","deleteEventFunnelActivity"])),{},{mainOnFilterApply:function(t){this.mainCurrPageIndex=1,this.mainPageReset=!0,this.mainCurrFilterApply=JSON.parse(JSON.stringify(t)),this.mainCurrSortField={},this.mainKnownDimensions=JSON.parse(JSON.stringify(this.mainKnownDimensions)),this.mainUpdateTableData()},mainHandleSortChange:function(t,e,n){this.mainCurrPageIndex=1,this.mainCurrSortField={key:t.key,order:t.order},this.mainPageReset=!0,this.mainUpdateTableData(1)},mainPageChange:function(t){this.mainCurrPageIndex=t,this.mainUpdateTableData()},mainPageSizeChange:function(t){this.mainCurrPageSize=t,this.mainPageReset=!0,this.mainUpdateTableData(1)},mainUpdateTableData:function(t){var e=this;this.mainTableLoading=!0;var n=this.mainWrapTableReqParams(t);this.getEventFunnelActivityTableData(n).then((function(t){e.mainInited=!0,e.mainTableLoading=!1})).catch((function(t){e.mainTableLoading=!1,e.showError(t)}))},mainWrapTableReqParams:function(t){var e={page:JSON.stringify({count:t?1:this.mainCurrPageIndex,size:this.mainCurrPageSize}),filtering:Object(u["m"])(this.mainCurrFilterApply,this.mainInFields,this.mainLikeFields),sort:Object(u["p"])(this.mainCurrSortField)};return e},showError:function(t){this.$Modal.error({title:"Error",content:t})},mainPageResetFalse:function(){this.mainPageReset=!1},onClickCell:function(t){this.$refs.event_funnel_activity_dashboard.initData(t),this.showMain=!1,J["a"].$emit("setOperateState",!1)},handleCreateFunnel:function(){this.$refs.event_funnel_activity_dashboard.initData(),this.showMain=!1,J["a"].$emit("setOperateState",!1)},handleBack:function(){this.$refs.event_funnel_activity_dashboard.initData(),this.showMain=!0,this.mainUpdateTableData(),J["a"].$emit("setOperateState",!0)},handleDelete:function(t){var e=this,n='<div style="word-break: break-all"><strong>AppName: </strong>'+t.row.app_name+"<br/>";n+="<strong>Funnel Name: </strong>"+t.row.funnel_name+"<br/>",n+="<strong>Description: </strong>"+t.row.event_name+"<br/>",n+="<strong>Creator: </strong>"+t.row.creator+"</div>",this.$Modal.confirm({title:"确定删除如下记录吗？",content:n,onOk:function(){Promise.all([e.deleteEventFunnelActivity({id:t.row.id})]).then((function(t){e.$Message.success("删除成功!"),e.mainCurrPageIndex=1,e.mainPageReset=!0,e.mainUpdateTableData(1)})).catch((function(t){e.$Modal.error({title:"Error",content:t.message})}))}})},onSelectPageInfo:function(t){var e=JSON.parse(t);this.$refs.pageFilter.setFilter(e.filter),this.mainOnFilterApply(e.filter)},onGetPageInfo:function(t){var e=this.$refs.pageFilter.getFilter(),n=JSON.stringify({filter:e});J["a"].$emit("setPageInfo",t,n)}}),mounted:function(){this.mainUpdateTableData();var t=this;J["a"].$on("selectPageInfo",(function(e){t.onSelectPageInfo(e)})),J["a"].$on("getPageInfo",(function(e){t.onGetPageInfo(e)}))},beforeDestroy:function(){J["a"].$off("selectPageInfo"),J["a"].$off("getPageInfo")}},K=H,G=(n("055a"),Object(g["a"])(K,a,i,!1,null,"4e711fbb",null));e["default"]=G.exports},"3b9f":function(t,e,n){"use strict";n("796a")},"584d":function(t,e,n){},"64c1":function(t,e,n){"use strict";n("88d4")},"796a":function(t,e,n){},"88d4":function(t,e,n){},"88e6":function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"dom",style:{width:t.previewStatus?t.client_width:"auto"}})},i=[],r=(n("7f7f"),n("28a5"),n("20d6"),n("ac6a"),n("313e")),s=n.n(r),l=n("90de"),o=n("6612"),c=n.n(o),u=n("4b65"),p={name:"group-line-chart",props:{chartData:{type:Object,default:function(){return{legendData:[],xAxisData:[],values:[]}}},knownFields:{type:Array,default:function(){return[]}},fieldFormaters:{type:Object,default:function(){return{}}},defaultFormater:{type:String,default:function(){return""}},xAxisType:{type:String,default:function(){return"日期"}},status:{type:Boolean,default:function(){return!1}},previewStatus:{type:Boolean,default:function(){return!1}},moneyType:{type:String,default:function(){return null}},events:{type:Array,default:function(){return[]}},inverseStatus:{type:Boolean,default:function(){return!1}}},data:function(){return{dom:null,client_width:1400,client_height:500}},methods:{resize:function(){this.dom.resize()},wrapOption:function(t){var e=this,n=[],a=this.fieldFormaters[this.chartData.chartField];null==a&&(a=this.defaultFormater);var i="数值";null!=this.chartData.chartField&&(i=this.knownFields.filter((function(t){return t.val===e.chartData.chartField}))[0].label);for(var r=parseInt(this.chartData.xAxisData.length/15),s=0;s<this.chartData.values.length;s++)n.push({name:this.chartData.legendData[s],type:"line",showAllSymbol:!0,data:this.chartData.values[s],itemStyle:{normal:{label:{show:this.status,formatter:function(e){if(e.dataIndex%(r+1)!==0)return"";var n=c()(e.value).format(a);return t&&n&&n.indexOf("$")>-1&&(n="¥"+n.substring(n.indexOf("$")+1,n.length)),n}}}}});var l=0===this.chartData.legendData.length,o=[];this.chartData.groups&&(o=this.chartData.groups.findIndex((function(t){return"total"===t}))>=0?[{label:"Total",val:"total"}]:Object(u["j"])(this.knownFields,this.chartData.groups));var p=this.xAxisType,h=this.events,d=this.chartData.xAxisData,f=Object.hasOwnProperty.call(this.chartData,"grid")?this.chartData.grid.left:"1.2%";return{title:{show:l,text:"暂无数据",left:"center",top:"center",textStyle:{color:"#464c5b",fontSize:16,fontWeight:400}},animation:!1,tooltip:{trigger:"item",axisPointer:{type:"cross",label:{formatter:function(e){if("y"===e.axisDimension){var n=c()(e.value).format(a);return t&&n&&n.indexOf("$")>-1&&(n="¥"+n.substring(n.indexOf("$")+1,n.length)),n}var i=e.value;if(h.length>0){i="转化率 ";var r=d.findIndex((function(t){return t===e.value}));i+=r+1+": ",i+=h[r]+"  "+(r+2)+": ",i+=h[r+1]}return i},backgroundColor:"#6a7985"}},formatter:function(e){var n=e.seriesName.split("/"),r=c()(e.value).format(a);t&&r&&r.indexOf("$")>-1&&(r="¥"+r.substring(r.indexOf("$")+1,r.length));for(var s=p+(""!==p?": ":"")+e.name,l=0;l<o.length;l++)s+="<br/>",s+=o[l].label,s+=": ",s+=n[l];return s+="<br/>",s+=i,s+=": ",s+=r,s}},legend:{formatter:function(t){return t?(t.length>32&&(t=t.slice(0,32)+"..."),t):""},tooltip:{show:!0},orient:"vertical",type:"scroll",right:10,icon:"circle",data:this.chartData.legendData},grid:{top:"10%",left:f||"1.2%",right:"260px",bottom:"3%",height:"80%",width:"auto",containLabel:!0},xAxis:[{type:"category",boundaryGap:!1,axisLabel:{rotate:15,interval:r},axisLine:{onZero:!this.inverseStatus},data:this.chartData.xAxisData}],yAxis:[{inverse:!!this.inverseStatus,type:"value",axisLabel:{formatter:function(e){var n=c()(e).format(a);return t&&n&&n.indexOf("$")>-1&&(n="¥"+n.substring(n.indexOf("$")+1,n.length)),n}}}],series:n}},renderChart:function(){var t=this,e=this.wrapOption(this.moneyType);this.$nextTick((function(){t.dom=s.a.init(t.$refs.dom),t.dom.setOption(e,!0),t.autoHeight=t.previewStatus?500:350,t.dom.resize({height:t.autoHeight}),Object(l["m"])(window,"resize",t.resize)}))},reRenderChartSeries:function(){var t=this,e=this.wrapOption(this.moneyType),n=this.dom.getOption();null!=n&&(n.series=e.series),this.$nextTick((function(){t.dom=s.a.init(t.$refs.dom),t.dom.setOption(n,!0),t.autoHeight=t.previewStatus?500:350,t.dom.resize({height:t.autoHeight}),Object(l["m"])(window,"resize",t.resize)}))},callMethod:function(t){},_expandable:function(){this.client_width=document.body.clientWidth,this.client_height=document.body.clientHeight}},watch:{chartData:{deep:!0,handler:function(t,e){this.renderChart()}},status:function(t){this.reRenderChartSeries()},previewStatus:function(t){this.reRenderChartSeries()}},mounted:function(){this.renderChart(),this._expandable();var t=this;window.onresize=function(){t._expandable()}},beforeDestroy:function(){Object(l["l"])(window,"resize",this.resize)}},h=p,d=n("2877"),f=Object(d["a"])(h,a,i,!1,null,null,null);e["a"]=f.exports},"9c6c0":function(t,e,n){"use strict";n.d(e,"d",(function(){return r})),n.d(e,"g",(function(){return s})),n.d(e,"f",(function(){return l})),n.d(e,"h",(function(){return o})),n.d(e,"i",(function(){return c})),n.d(e,"e",(function(){return u})),n.d(e,"j",(function(){return p})),n.d(e,"c",(function(){return h})),n.d(e,"b",(function(){return d})),n.d(e,"a",(function(){return f})),n.d(e,"k",(function(){return v}));var a=n("6612"),i=n.n(a),r=[{id:"today",value:"今天"},{id:"yesterday",value:"昨天"},{id:"day7",value:"最近7天"},{id:"day14",value:"最近14天"},{id:"day30",value:"最近30天"}],s=function(t){var e=[{title:"异常问题",key:"crash_name",render:function(e,n){var a="#"+n.row.crash_num+" "+n.row.crash_name;return e("a",{on:{click:function(){t.clickCrashName(n)}}},a)}},{title:"崩溃设备数",key:"users",width:180},{title:"崩溃次数",key:"crash_count",width:180}];return e},l=function(t){var e=[{title:"Top",key:"top",width:80,render:function(t,e){return t("span",e.index+1)}},{title:"异常问题",key:"crash_name",render:function(e,n){var a="#"+n.row.crash_num+" "+n.row.crash_name;return e("a",{on:{click:function(){t.clickCrashName(n)}}},a)}},{title:"崩溃设备数",key:"crash_users",width:180},{title:"崩溃次数",key:"online_users",width:180},{title:"首次上报时间",key:"first_time",width:180}];return e},o=function(t){var e=[{title:"异常问题",key:"crash_name",render:function(e,n){return e("div",[e("p",[e("a",{on:{click:function(){t.clickCrashName(n)}}},n.row.issue_title)]),e("p",[e("a",{on:{click:function(){t.clickCrashName(n)}}},n.row.issue_subtitle)])])}},{title:"崩溃设备数",key:"users",width:180},{title:"崩溃次数",key:"counts",width:180}];return e},c=function(t){var e=[{title:"Top",key:"top",width:80,render:function(t,e){return t("span",e.index+1)}},{title:"异常问题",key:"crash_name",render:function(e,n){return e("div",[e("p",[e("a",{on:{click:function(){t.clickCrashName(n)}}},n.row.issue_title)]),e("p",[e("a",{on:{click:function(){t.clickCrashName(n)}}},n.row.issue_subtitle)])])}},{title:"崩溃设备数",key:"crash_users",width:180},{title:"崩溃次数",key:"crash_count",width:180},{title:"首次上报时间",key:"first_time",width:180}];return e},u=[{title:"应用版本",key:"appversion",width:120},{title:"首次上报时间",key:"first_time"},{title:"最近上报时间",key:"last_time"},{title:"累计发生次数",key:"total",render:function(t,e){return t("span",i()(e.row.total).format("0,0"))}},{title:"次数占比",key:"rate",render:function(t,e){return t("span",i()(e.row.rate).format("0,0%"))}},{title:"累计影响设备数",key:"devices",render:function(t,e){return t("span",i()(e.row.devices).format("0,0"))}}],p=[{title:"应用版本",key:"app_version",width:120},{title:"首次上报时间",key:"first_time"},{title:"最近上报时间",key:"last_time"},{title:"累计发生次数",key:"total",render:function(t,e){return t("span",i()(e.row.crash_count).format("0,0"))}},{title:"次数占比",key:"rate",render:function(t,e){return t("span",i()(e.row.crash_count_rate).format("0,0%"))}},{title:"累计影响设备数",key:"devices",render:function(t,e){return t("span",i()(e.row.crash_users).format("0,0"))}}],h=["performed an event","did not performed an event","meet a general condition"],d=["is","is not","contains","does not contain"],f=["app version","country","device brand","device model","media source","投放类型","os version"],v=["g_level_id","task_id","item_id","itemid","gemleft","gem_left","af_price","timeline_id","PetRank","Playerlevel","PetLevel","player_level","roomrecipeid"]},aaa1:function(t,e,n){},ae3e:function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{directives:[{name:"show",rawName:"v-show",value:t.tableData.length>0||t.tableLoading,expression:"tableData.length > 0 || tableLoading"}],staticClass:"localTableDiv"},[n("Row",[n("Table",{staticClass:"topTable",attrs:{data:t.tableData,columns:t.tableColumns,loading:t.tableLoading,border:"",height:t.height},on:{"on-sort-change":t.handleSortChange}}),t.noSummery?t._e():n("Table",{staticClass:"summeryTable",attrs:{data:t.tableDataFun(),columns:t.tableColumns,loading:t.tableLoading,border:"","show-header":!1,height:"58"},on:{"on-sort-change":t.handleSortChange}})],1),t.noPage?t._e():n("Row",{staticStyle:{"text-align":"center"}},[n("Page",{ref:"tablePages",attrs:{"page-size":50,total:t.data.length,current:1,"page-size-opts":t.pageSizeOpts,"show-sizer":"","show-total":"","show-elevator":""}})],1)],1),n("div",{directives:[{name:"show",rawName:"v-show",value:t.tableData.length<=0&&!t.tableLoading,expression:"tableData.length <= 0 && !tableLoading"}],staticStyle:{"text-align":"center"}},[n("span",{staticStyle:{"font-size":"15px"}},[t._v("暂无数据")])])])},i=[],r=(n("ac6a"),n("55dd"),n("c5f6"),n("4b65")),s=(n("8dc2"),n("1157")),l=n.n(s),o={name:"LocalTable",props:{data:{type:Array,default:function(){return[]}},footerData:{type:Object,default:function(){return{}}},pageData:{type:Object,default:function(){return{page_size:20,has_next:!1,has_prev:!1,total_num:20}}},knownFields:{type:Array,default:function(){return[]}},tableLoading:{type:Boolean,default:function(){return!1}},dimensions:{type:Array,default:function(){return[]}},metrics:{type:Array,default:function(){return[]}},haveIndex:{type:Boolean,default:function(){return!1}},defaultFormater:{type:String,default:function(){return"0,0"}},formater:{type:Object,default:function(){return{}}},events:{type:Array,default:function(){return[]}},noSummery:{type:Boolean,default:function(){return!1}},noPage:{type:Boolean,default:function(){return!1}},tableIndex:{type:Number,default:function(){return 0}},tableHeight:{type:Number,default:function(){return 550}},dynamicHeight:{type:Boolean,default:function(){return!1}}},data:function(){return{pageSizeOpts:[10,20,30,50]}},computed:{tableColumns:function(){return Object(r["b"])(this,this.knownFields,this.dimensions,this.metrics,this.formater,this.events,this.defaultFormater,this.haveIndex,this.onClickCell)},tableData:function(){var t=this.$refs["tablePages"];if(t){var e=this.$refs["tablePages"].currentPageSize,n=this.$refs["tablePages"].total,a=this.$refs["tablePages"].currentPage,i=(a-1)*e,r=i+e-1;r>n-1&&(r=n-1);var s=this.data.slice(i,r+1);return s.length>0&&s.push({test_id:"1"}),s}var l=this.data;return l.length>0&&l.push({test_id:"1"}),l},height:function(){return this.dynamicHeight?this.data.length<=1?120:this.data.length<=3?220:this.data.length<=5?315:this.data.length<=7?415:this.tableHeight:this.tableHeight}},methods:{handleSortChange:function(t,e,n){"asc"===t.order?this.data.sort((function(e,n){var a=e[t.key],i=n[t.key];return null!=a&&isNaN(a)||null!=i&&isNaN(i)?(null==a&&(a="0"),null==i&&(i="0"),a>i?1:-1):(null==a&&(a=-1e7),null==i&&(i=-1e7),a-i)})):this.data.sort((function(e,n){var a=e[t.key],i=n[t.key];return null!=a&&isNaN(a)||null!=i&&isNaN(i)?(null==a&&(a="0"),null==i&&(i="0"),i>a?1:-1):(null==a&&(a=-1e7),null==i&&(i=-1e7),i-a)}))},getData:function(){var t=JSON.parse(JSON.stringify(this.footerData)),e={};for(var n in this.tableColumns.forEach((function(n,a){var i=n.key;0===a?e[i]={key:i,value:"合计"}:isNaN(Number(t[i]))?e[i]={key:i,value:"-"}:e[i]={key:i,value:t[i]}})),t)null==e[n]&&(e[n]={key:n,value:t[n]});return e},tableDataFun:function(){var t=this.getData(),e=[],n={};for(var a in t){var i=t[a],r=i.key,s=i.value;n[r]=s}return e.push(n),e},onClickCell:function(t,e){this.$emit("on-click-cell",t,e)}},beforeMount:function(){this.tmpTag=this.searchTag},mounted:function(){var t=this;history.pushState(null,null,document.URL),window.addEventListener("popstate",(function(){history.pushState(null,null,document.URL)}));var e=0;document.getElementsByClassName("ivu-table-body")[2*this.tableIndex].addEventListener("scroll",(function(n){var a=n.target.scrollLeft;e=n.target.scrollTop,l()(".ivu-table-body")[2*t.tableIndex+1].scrollLeft=a})),document.getElementsByClassName("ivu-table-body")[2*this.tableIndex+1].addEventListener("scroll",(function(n){var a=n.target.scrollLeft;l()(".ivu-table-body")[2*t.tableIndex].scrollLeft=a,l()(".ivu-table-body")[2*t.tableIndex].scrollTop=e})),l()((function(){l()(".topTable").addClass("hiddenTopTable")}))},watch:{tableLoading:function(t){var e=this.$refs["tablePages"];e&&!1===t&&(this.$refs["tablePages"].currentPage=1)}}},c=o,u=(n("d236"),n("2877")),p=Object(u["a"])(c,a,i,!1,null,null,null);e["a"]=p.exports},d236:function(t,e,n){"use strict";n("584d")},e083:function(t,e,n){},f0e6:function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",["profitLoss"===t.pageRooter?n("RadioGroup",{staticClass:"radioWapper",model:{value:t.tabItem,callback:function(e){t.tabItem=e},expression:"tabItem"}},t._l(t.tabPaneData,(function(e,a){return n("Radio",{key:a,staticStyle:{"margin-top":"10px","margin-bottom":"10px"},attrs:{label:e.label}},[t._v(t._s(e.value))])})),1):t._e(),"profitLoss"===t.pageRooter?n("Divider"):t._e(),t._t("refresh"),n("Tabs",{class:["profitLoss"===t.pageRooter?"hideTabItem":"tabItems"],attrs:{animated:!1},model:{value:t.tabItem,callback:function(e){t.tabItem=e},expression:"tabItem"}},t._l(t.tabPaneData,(function(e,a){return n("TabPane",{key:a,attrs:{label:e.value,name:e.label}},[e.label===t.tabItem?n("group-line-chart",{ref:"child",refInFor:!0,attrs:{"field-formaters":t.fieldFormaters,"known-fields":t.knownFields,"chart-data":t.lineChartData[a],status:t.checkStatus,previewStatus:t.previewStatus,"money-type":t.moneyType}}):t._e()],1)})),1)],2)},i=[],r=n("88e6"),s={name:"tabs-list",components:{GroupLineChart:r["a"]},props:{tabValue:{type:String,default:function(){return"name1"}},pageRooter:{type:String,default:function(){return""}},fieldFormaters:{type:Object,default:function(){return{}}},knownFields:{type:Array,default:function(){return[]}},lineChartData:{type:Array,default:function(){return[]}},tabPaneData:{type:Array,default:function(){return[]}},checkStatus:{type:Boolean,default:function(){return!1}},previewStatus:{type:Boolean,default:function(){return!1}},moneyType:{type:String,default:function(){return null}}},data:function(){return{tabItem:"name1"}},methods:{}},l=s,o=(n("64c1"),n("2877")),c=Object(o["a"])(l,a,i,!1,null,null,null);e["a"]=c.exports}}]);